<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pairwise Marginal Likelihood Estimation for the Probit Rasch Model — rasch.pml3 • sirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Pairwise Marginal Likelihood Estimation for the Probit Rasch Model — rasch.pml3" />
<meta property="og:description" content="This function estimates unidimensional 1PL and 2PL models with
the probit link using pairwise marginal maximum likelihood
estimation (PMML; Renard, Molenberghs &amp;amp; Geys, 2004).
Item pairs within an itemcluster can be excluded from the
pairwise likelihood (argument itemcluster).
The other alternative is to model a residual
error structure with itemclusters (argument error.corr)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.13-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pairwise Marginal Likelihood Estimation for the Probit Rasch Model</h1>
    
    <div class="hidden name"><code>rasch.pml3.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates unidimensional 1PL and 2PL models with
the probit link using pairwise marginal maximum likelihood
estimation (PMML; Renard, Molenberghs &amp; Geys, 2004).
Item pairs within an itemcluster can be excluded from the
pairwise likelihood (argument <code>itemcluster</code>).
The other alternative is to model a residual
error structure with itemclusters (argument <code>error.corr</code>).</p>
    </div>

    <pre class="usage"><span class='fu'>rasch.pml3</span>(<span class='no'>dat</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)), <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)),
    <span class='kw'>est.sigma</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>itemcluster</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>weight</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>dat</span>)), <span class='kw'>numdiff.parm</span><span class='kw'>=</span><span class='fl'>0.001</span>,
    <span class='kw'>b.init</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>a.init</span><span class='kw'>=</span><span class='kw'>NULL</span>,  <span class='kw'>sigma.init</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='fl'>0</span>*<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>( <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>) ),
    <span class='kw'>err.constraintM</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>err.constraintV</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>glob.conv</span><span class='kw'>=</span><span class='fl'>10</span>^(-<span class='fl'>6</span>), <span class='kw'>conv1</span><span class='kw'>=</span><span class='fl'>10</span>^(-<span class='fl'>4</span>),
    <span class='kw'>pmliter</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>progress</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>use.maxincrement</span><span class='kw'>=</span><span class='fl'>TRUE</span> )

<span class='co'># S3 method for rasch.pml</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>,<span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>An \(N \times I\) data frame of dichotomous item responses</p></td>
    </tr>
    <tr>
      <th>est.b</th>
      <td><p>Vector of integers of length \(I\). Same integers mean that the
corresponding items do have the same item difficulty <code>b</code>.
Entries of <code>0</code> mean fixing item parameters to values
specified in <code>b.init</code>.</p></td>
    </tr>
    <tr>
      <th>est.a</th>
      <td><p>Vector of integers of length \(I\). Same integers mean that the
corresponding items do have the same item slope <code>a</code>.
Entries of <code>0</code> mean fixing item parameters to values
specified in <code>a.init</code>.</p></td>
    </tr>
    <tr>
      <th>est.sigma</th>
      <td><p>Should sigma (the trait standard deviation) be estimated?
The default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>itemcluster</th>
      <td><p>Optional vector of length \(I\) of integers which indicates itemclusters.
Same integers correspond to the same itemcluster. An entry of <code>0</code>
correspond to an item which is not included in any itemcluster.</p></td>
    </tr>
    <tr>
      <th>weight</th>
      <td><p>Optional vector of person weights</p></td>
    </tr>
    <tr>
      <th>numdiff.parm</th>
      <td><p>Step parameter for numerical differentiation</p></td>
    </tr>
    <tr>
      <th>b.init</th>
      <td><p>Initial or fixed item difficulty</p></td>
    </tr>
    <tr>
      <th>a.init</th>
      <td><p>Initial or fixed item slopes</p></td>
    </tr>
    <tr>
      <th>sigma.init</th>
      <td><p>Initial or fixed trait standard deviation</p></td>
    </tr>
    <tr>
      <th>error.corr</th>
      <td><p>An optional \(I \times I\) integer matrix
which defines the estimation of residual correlations.
Entries of zero indicate that the corresponding
residual correlation should not be estimated.
Integers which differ from zero indicate correlations to be estimated.
All entries with an equal integer are estimated by the same residual
correlation. The default of <code>error.corr</code> is a diagonal matrix
which means that no residual correlation is estimated. If <code>error.corr</code>
deviates from this default, then the argument <code>itemcluster</code> is set
to <code>NULL</code>.<br />
If some error correlations are estimated, then no itempairs in
<code>itemcluster</code> can be excluded from the pairwise modeling.</p></td>
    </tr>
    <tr>
      <th>err.constraintM</th>
      <td><p>An optional \(P \times L\) matrix where \(P\) denotes
the number of item pairs in pseudolikelihood estimation
and \(L\) is the number of linear constraints for residual
correlations (see Details).</p></td>
    </tr>
    <tr>
      <th>err.constraintV</th>
      <td><p>An optional \(L \times 1\) matrix with specified values
for linear constraints on residual correlations (see Details).</p></td>
    </tr>
    <tr>
      <th>glob.conv</th>
      <td><p>Global convergence criterion</p></td>
    </tr>
    <tr>
      <th>conv1</th>
      <td><p>Convergence criterion for model parameters</p></td>
    </tr>
    <tr>
      <th>pmliter</th>
      <td><p>Maximum number of iterations</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>Display progress?</p></td>
    </tr>
    <tr>
      <th>use.maxincrement</th>
      <td><p>Optional logical whether increments in
    slope parameters should be controlled in size in iterations.
    The default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Object of class <code>rasch.pml</code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The probit item response model can be estimated with this function:
$$P(X_{pi}=1|\theta_p )=\Phi( a_i  \theta_p - b_i ) \quad, \quad
    \theta_p \sim N ( 0, \sigma^2 )$$
where \(\Phi\) denotes the normal distribution function. This model can
also be expressed as a latent variable model which assumes
a latent response tendency \(X_{pi}^\ast\) which is equal to
1 if \(X_{pi}&gt; - b_i\) and otherwise zero. If \(\epsilon_{pi}\) is
standard normally distributed, then
$$X_{pi}^{\ast}=a_i \theta_p - b_i + \epsilon_{pi} $$
An arbitrary pattern of residual correlations between
\(\epsilon_{pi}\) and \(\epsilon_{pj}\) for item pairs \(i\)
and \(j\) can be imposed using the <code>error.corr</code> argument.</p>
<p>Linear constraints \(Me=v\) on residual correlations
\(e=Cov( \epsilon_{pi}, \epsilon_{pj})_{ij}\) (in a vectorized form) can be
specified using the arguments <code>err.constraintM</code> (matrix \(M\))
and <code>err.constraintV</code> (vector \(v\)). The estimation
is described in Neuhaus (1996).</p>
<p>For the pseudo likelihood information criterion (PLIC)
see Stanford and Raftery (2002).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with following entries:</p>
<dt>item</dt><dd><p>Data frame with estimated item parameters</p></dd>
<dt>iter</dt><dd><p>Number of iterations</p></dd>
<dt>deviance</dt><dd><p>Pseudolikelihood multiplied by minus 2</p></dd>
<dt>b</dt><dd><p>Estimated item difficulties</p></dd>
<dt>sigma</dt><dd><p>Estimated standard deviation</p></dd>
<dt>dat</dt><dd><p>Original dataset</p></dd>
<dt>ic</dt><dd><p>Data frame with information criteria (sample size,
number of estimated parameters, pseudolikelihood
information criterion <code>PLIC</code>)</p></dd>
<dt>link</dt><dd><p>Used link function (only probit is permitted)</p></dd>
<dt>itempairs</dt><dd><p>Estimated statistics of item pairs</p></dd>
<dt>error.corr</dt><dd><p>Estimated error correlation matrix</p></dd>
<dt>eps.corr</dt><dd><p>Vectorized error correlation matrix</p></dd>
<dt>omega.rel</dt><dd><p>Reliability of the sum score according to Green and Yang (2009).
    If some item pairs are excluded in the estimation, the residual
    correlation for these item pairs is assumed to be zero.</p></dd>

<dt>...</dt><dd><p></p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Green, S. B., &amp; Yang, Y. (2009). Reliability of summed item
scores using structural equation modeling: An alternative to
coefficient alpha. <em>Psychometrika, 74</em>, 155-167.</p>
<p>Neuhaus, W. (1996). Optimal estimation under
linear constraints. <em>Astin Bulletin, 26</em>, 233-245.</p>
<p>Renard, D., Molenberghs, G., &amp; Geys, H. (2004). A pairwise likelihood
approach to estimation in multilevel probit models. <em>Computational Statistics
&amp; Data Analysis, 44</em>, 649-667.</p>
<p>Stanford, D. C., &amp; Raftery, A. E. (2002).
Approximate Bayes factors for image segmentation:
The pseudolikelihood information criterion (PLIC).
<em>IEEE Transactions on Pattern Analysis and
Machine Intelligence, 24</em>, 1517-1520.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function needs the <span class="pkg">combinat</span> library.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Get a summary of <code>rasch.pml3</code> with <code>summary.rasch.pml</code>.</p>
<p>For simulation of locally dependent items see <code><a href='sim.rasch.dep.html'>sim.rasch.dep</a></code>.</p>
<p>For pairwise conditional likelihood estimation see <code><a href='rasch.pairwise.html'>rasch.pairwise</a></code>
or <code><a href='rasch.pairwise.itemcluster.html'>rasch.pairwise.itemcluster</a></code>.</p>
<p>For an assessment of global model fit see <code><a href='modelfit.sirt.html'>modelfit.sirt</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Reading data set</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.read</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.read</span>

<span class='co'>#******</span>
<span class='co'># Model 1: Rasch model with PML estimation</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#******</span>
<span class='co'># Model 2: Excluding item pairs with local dependence</span>
<span class='co'>#          from bivariate composite likelihood</span>
<span class='no'>itemcluster</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>4</span>)
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>itemcluster</span><span class='kw'>=</span><span class='no'>itemcluster</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#*****</span>
<span class='co'># Model 3: Modelling error correlations:</span>
<span class='co'>#          joint residual correlations for each itemcluster</span>
<span class='no'>error.corr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>))
<span class='kw'>for</span> ( <span class='no'>ii</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>3</span>){
    <span class='no'>ind.ii</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>itemcluster</span><span class='kw'>==</span><span class='no'>ii</span> )
    <span class='no'>error.corr</span>[ <span class='no'>ind.ii</span>, <span class='no'>ind.ii</span> ] <span class='kw'>&lt;-</span> <span class='no'>ii</span>
        }
<span class='co'># estimate the model with error correlations</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>error.corr</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'>#****</span>
<span class='co'># Model 4: model separate residual correlations</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>error.corr</span>)
<span class='no'>error.corr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>1</span>:(<span class='no'>I</span>*<span class='no'>I</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span> )
<span class='no'>error.corr</span> <span class='kw'>&lt;-</span> <span class='no'>error.corr1</span> * ( <span class='no'>error.corr</span> <span class='kw'>&gt;</span> <span class='fl'>0</span> )
<span class='co'># estimate the model with error correlations</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>error.corr</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)

<span class='co'>#****</span>
<span class='co'># Model 5:  assume equal item difficulties:</span>
<span class='co'># b_1=b_7 and b_2=b_12</span>
<span class='co'># fix item difficulty of the 6th item to .1</span>
<span class='no'>est.b</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='no'>I</span>
<span class='no'>est.b</span>[<span class='fl'>7</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>; <span class='no'>est.b</span>[<span class='fl'>12</span>] <span class='kw'>&lt;-</span> <span class='fl'>2</span> ; <span class='no'>est.b</span>[<span class='fl'>6</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>b.init</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fl'>0</span>, <span class='no'>I</span> ) ; <span class='no'>b.init</span>[<span class='fl'>6</span>] <span class='kw'>&lt;-</span> <span class='fl'>.1</span>
<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>est.b</span>, <span class='kw'>b.init</span><span class='kw'>=</span><span class='no'>b.init</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod5</span>)

<span class='co'>#****</span>
<span class='co'># Model 6: estimate three item slope groups</span>
<span class='no'>est.a</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>4</span> )
<span class='no'>mod6</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='no'>est.a</span>, <span class='kw'>est.sigma</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod6</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 2: PISA reading</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.pisaRead</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.pisaRead</span>$<span class='no'>data</span>

<span class='co'># select items</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>[, <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>),<span class='fl'>1</span>,<span class='fl'>1</span>)<span class='kw'>==</span><span class='st'>"R"</span> ]

<span class='co'>#******</span>
<span class='co'># Model 1: Rasch model with PML estimation</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>dat</span>) )
  <span class='co'>## Trait SD (Logit Link) : 1.419</span>

<span class='co'>#******</span>
<span class='co'># Model 2: Model correlations within testlets</span>
<span class='no'>error.corr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>))
<span class='no'>testlets</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>( <span class='no'>data.pisaRead</span>$<span class='no'>item</span>$<span class='no'>testlet</span> )
<span class='no'>itemcluster</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span>( <span class='no'>testlets</span>, <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>testlets</span> ) )
<span class='kw'>for</span> ( <span class='no'>ii</span> <span class='kw'>in</span> <span class='fl'>1</span>:(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>testlets</span>))) ){
    <span class='no'>ind.ii</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>itemcluster</span><span class='kw'>==</span><span class='no'>ii</span> )
    <span class='no'>error.corr</span>[ <span class='no'>ind.ii</span>, <span class='no'>ind.ii</span> ] <span class='kw'>&lt;-</span> <span class='no'>ii</span>
        }
<span class='co'># estimate the model with error correlations</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>error.corr</span> )
  <span class='co'>## Trait SD (Logit Link) : 1.384</span>

<span class='co'>#****</span>
<span class='co'># Model 3: model separate residual correlations</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>error.corr</span>)
<span class='no'>error.corr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>1</span>:(<span class='no'>I</span>*<span class='no'>I</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span> )
<span class='no'>error.corr</span> <span class='kw'>&lt;-</span> <span class='no'>error.corr1</span> * ( <span class='no'>error.corr</span> <span class='kw'>&gt;</span> <span class='fl'>0</span> )
<span class='co'># estimate the model with error correlations</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>error.corr</span> )
  <span class='co'>## Trait SD (Logit Link) : 1.384</span>

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 3: 10 locally independent items</span>
<span class='co'>#############################################################################</span>

<span class='co'>#**********</span>
<span class='co'># simulate some data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>554</span>)
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span>    <span class='co'># persons</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>        <span class='co'># items</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1.3</span> )    <span class='co'># trait SD of 1.3</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='kw'>length</span><span class='kw'>=</span><span class='no'>I</span>) <span class='co'># item difficulties</span>

<span class='co'># simulate data from the Rasch model</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw'>theta</span><span class='kw'>=</span><span class='no'>theta</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span> )

<span class='co'># estimation with rasch.pml and probit link</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'># estimation with rasch.mml2 function</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat</span> )

<span class='co'># estimate item parameters for groups with five item parameters each</span>
<span class='no'>est.b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fl'>1</span>:(<span class='no'>I</span>/<span class='fl'>2</span>), <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>2</span> )
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>est.b</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'># compare parameter estimates</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 4: 11 items and 2 item clusters with 2 and 3 items</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>5698</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>11</span>                             <span class='co'># number of items</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>5000</span>                           <span class='co'># number of persons</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>2</span>,<span class='fl'>2</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span>)               <span class='co'># item difficulties</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span> ) <span class='co'># person abilities</span>
<span class='co'># itemcluster</span>
<span class='no'>itemcluster</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='no'>I</span>)
<span class='no'>itemcluster</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>5</span>)] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>itemcluster</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>9</span>)] <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='co'># residual correlations</span>
<span class='no'>rho</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>.7</span>, <span class='fl'>.5</span> )

<span class='co'># simulate data (under the logit link)</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.rasch.dep.html'>sim.rasch.dep</a></span>( <span class='no'>theta</span>, <span class='no'>b</span>, <span class='no'>itemcluster</span>, <span class='no'>rho</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"I"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)), <span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>)

<span class='co'>#***</span>
<span class='co'># Model 1: estimation using the Rasch model (with probit link)</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span> )
<span class='co'>#***</span>
<span class='co'># Model 2: estimation when pairs of locally dependent items are eliminated</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>itemcluster</span><span class='kw'>=</span><span class='no'>itemcluster</span>)

<span class='co'>#***</span>
<span class='co'># Model 3: Positive correlations within testlets</span>
<span class='no'>est.corrs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>( <span class='fl'>1</span>, <span class='no'>I</span> )
<span class='no'>est.corrs</span>[ <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>5</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>5</span>) ] <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>est.corrs</span>[ <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>9</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>9</span>) ] <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>est.corrs</span> )

<span class='co'>#***</span>
<span class='co'># Model 4: Negative correlations between testlets</span>
<span class='no'>est.corrs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>( <span class='fl'>1</span>, <span class='no'>I</span> )
<span class='no'>est.corrs</span>[ <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>5</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>9</span>) ] <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>est.corrs</span>[ <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>9</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>5</span>) ] <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>est.corrs</span> )

<span class='co'>#***</span>
<span class='co'># Model 5: sum constraint of zero within and between testlets</span>
<span class='no'>est.corrs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>1</span>:(<span class='no'>I</span>*<span class='no'>I</span>),  <span class='no'>I</span>, <span class='no'>I</span> )
<span class='no'>cluster2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>9</span>)
<span class='no'>est.corrs</span>[ <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span>( <span class='fl'>1</span>:<span class='no'>I</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>cluster2</span>)),  ] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>est.corrs</span>[, <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span>( <span class='fl'>1</span>:<span class='no'>I</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>cluster2</span>))  ] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='co'># define an error constraint matrix</span>
<span class='no'>itempairs0</span> <span class='kw'>&lt;-</span> <span class='no'>mod4</span>$<span class='no'>itempairs</span>
<span class='no'>IP</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>itempairs0</span>)
<span class='no'>err.constraint</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='no'>IP</span>, <span class='fl'>1</span> )
<span class='no'>err.constraint</span>[ ( <span class='no'>itempairs0</span>$<span class='no'>item1</span> <span class='kw'>%in%</span> <span class='no'>cluster2</span> )
       <span class='kw'>&amp;</span> ( <span class='no'>itempairs0</span>$<span class='no'>item2</span> <span class='kw'>%in%</span> <span class='no'>cluster2</span> ), <span class='fl'>1</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='co'># set sum of error covariances to 1.2</span>
<span class='no'>err.constraintV</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>3</span>*<span class='fl'>.4</span>,<span class='fl'>1</span>,<span class='fl'>1</span>)

<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>est.corrs</span>,
         <span class='kw'>err.constraintM</span><span class='kw'>=</span><span class='no'>err.constraint</span>, <span class='kw'>err.constraintV</span><span class='kw'>=</span><span class='no'>err.constraintV</span>)

<span class='co'>#****</span>
<span class='co'># Model 6: Constraint on sum of all correlations</span>
<span class='no'>est.corrs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>1</span>:(<span class='no'>I</span>*<span class='no'>I</span>),  <span class='no'>I</span>, <span class='no'>I</span> )
<span class='co'># define an error constraint matrix</span>
<span class='no'>itempairs0</span> <span class='kw'>&lt;-</span> <span class='no'>mod4</span>$<span class='no'>itempairs</span>
<span class='no'>IP</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>itempairs0</span>)
<span class='co'># define two side conditions</span>
<span class='no'>err.constraint</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='no'>IP</span>, <span class='fl'>2</span> )
<span class='no'>err.constraintV</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>1</span>)
<span class='co'># sum of all correlations is zero</span>
<span class='no'>err.constraint</span>[, <span class='fl'>1</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>err.constraintV</span>[<span class='fl'>1</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='co'># sum of items cluster c(1,2,3) is 0</span>
<span class='no'>cluster2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>)
<span class='no'>err.constraint</span>[ ( <span class='no'>itempairs0</span>$<span class='no'>item1</span> <span class='kw'>%in%</span>  <span class='no'>cluster2</span> )
       <span class='kw'>&amp;</span> ( <span class='no'>itempairs0</span>$<span class='no'>item2</span> <span class='kw'>%in%</span> <span class='no'>cluster2</span> ), <span class='fl'>2</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>err.constraintV</span>[<span class='fl'>2</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>

<span class='no'>mod6</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>est.corrs</span>,
    <span class='kw'>err.constraintM</span><span class='kw'>=</span><span class='no'>err.constraint</span>,  <span class='kw'>err.constraintV</span><span class='kw'>=</span><span class='no'>err.constraintV</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod6</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 5: 10 Items: Cluster 1 -&gt; Items 1,2</span>
<span class='co'>#         Cluster 2 -&gt; Items 3,4,5;   Cluster 3 -&gt; Items 7,8,9</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>7650</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>                             <span class='co'># number of items</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>5000</span>                           <span class='co'># number of persons</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>2</span>,<span class='fl'>2</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span>)               <span class='co'># item difficulties</span>
<span class='no'>bsamp</span> <span class='kw'>&lt;-</span> <span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='no'>b</span>)             <span class='co'># sample item difficulties</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span> ) <span class='co'># person abilities</span>
<span class='co'># define itemcluster</span>
<span class='no'>itemcluster</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='no'>I</span>)
<span class='no'>itemcluster</span>[ <span class='fl'>1</span>:<span class='fl'>2</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>itemcluster</span>[ <span class='fl'>3</span>:<span class='fl'>5</span> ] <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>itemcluster</span>[ <span class='fl'>7</span>:<span class='fl'>9</span> ] <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='co'># define residual correlations</span>
<span class='no'>rho</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>.55</span>, <span class='fl'>.35</span>, <span class='fl'>.45</span>)

<span class='co'># simulate data</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.rasch.dep.html'>sim.rasch.dep</a></span>( <span class='no'>theta</span>, <span class='no'>b</span>, <span class='no'>itemcluster</span>, <span class='no'>rho</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"I"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)), <span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>)

<span class='co'>#***</span>
<span class='co'># Model 1: residual correlation (equal within item clusters)</span>
<span class='co'># define a matrix of integers for estimating error correlations</span>
<span class='no'>error.corr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>))
<span class='kw'>for</span> ( <span class='no'>ii</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>3</span>){
    <span class='no'>ind.ii</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>itemcluster</span><span class='kw'>==</span><span class='no'>ii</span> )
    <span class='no'>error.corr</span>[ <span class='no'>ind.ii</span>, <span class='no'>ind.ii</span> ] <span class='kw'>&lt;-</span> <span class='no'>ii</span>
        }
<span class='co'># estimate the model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>error.corr</span> )

<span class='co'>#***</span>
<span class='co'># Model 2: residual correlation (different within item clusters)</span>
<span class='co'># define again a matrix of integers for estimating error correlations</span>
<span class='no'>error.corr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>))
<span class='kw'>for</span> ( <span class='no'>ii</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>3</span>){
    <span class='no'>ind.ii</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>itemcluster</span><span class='kw'>==</span><span class='no'>ii</span> )
    <span class='no'>error.corr</span>[ <span class='no'>ind.ii</span>, <span class='no'>ind.ii</span> ] <span class='kw'>&lt;-</span> <span class='no'>ii</span>
        }
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>error.corr</span>)
<span class='no'>error.corr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>1</span>:(<span class='no'>I</span>*<span class='no'>I</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span> )
<span class='no'>error.corr</span> <span class='kw'>&lt;-</span> <span class='no'>error.corr1</span> * ( <span class='no'>error.corr</span> <span class='kw'>&gt;</span> <span class='fl'>0</span> )
<span class='co'># estimate the model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>error.corr</span><span class='kw'>=</span><span class='no'>error.corr</span> )

<span class='co'>#***</span>
<span class='co'># Model 3: eliminate item pairs within itemclusters for PML estimation</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span>, <span class='kw'>itemcluster</span><span class='kw'>=</span><span class='no'>itemcluster</span> )

<span class='co'>#***</span>
<span class='co'># Model 4: Rasch model ignoring dependency</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.pml3</span>( <span class='no'>dat</span> )

<span class='co'># compare different models</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


