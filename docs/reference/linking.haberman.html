<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function does the linking of several studies which are calibrated
using the 2PL or the generalized item response model according to
Haberman (2009). This method is a generalization of log-mean-mean
linking from one study to several studies. The default a_log=TRUE
logarithmizes item slopes for linking while otherwise an additive regression
model is assumed for the original item loadings (see Details; Battauz, 2017)"><title>Linking in the 2PL/Generalized Partial Credit Model — linking.haberman • sirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Linking in the 2PL/Generalized Partial Credit Model — linking.haberman"><meta property="og:description" content="This function does the linking of several studies which are calibrated
using the 2PL or the generalized item response model according to
Haberman (2009). This method is a generalization of log-mean-mean
linking from one study to several studies. The default a_log=TRUE
logarithmizes item slopes for linking while otherwise an additive regression
model is assumed for the original item loadings (see Details; Battauz, 2017)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.2</small

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexanderrobitzsch/sirt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Linking in the 2PL/Generalized Partial Credit Model</h1>
      
      <div class="d-none name"><code>linking.haberman.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function does the linking of several studies which are calibrated
using the 2PL or the generalized item response model according to
Haberman (2009). This method is a generalization of log-mean-mean
linking from one study to several studies. The default <code>a_log=TRUE</code>
logarithmizes item slopes for linking while otherwise an additive regression
model is assumed for the original item loadings (see Details; Battauz, 2017)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, <span class="va">personpars</span>, estimation<span class="op">=</span><span class="st">"OLS"</span>, a_trim<span class="op">=</span><span class="cn">Inf</span>, b_trim<span class="op">=</span><span class="cn">Inf</span>,</span>
<span>    lts_prop<span class="op">=</span><span class="fl">.5</span>, a_log<span class="op">=</span><span class="cn">TRUE</span>, conv<span class="op">=</span><span class="fl">1e-05</span>, maxiter<span class="op">=</span><span class="fl">1000</span>, progress<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    adjust_main_effects<span class="op">=</span><span class="cn">TRUE</span>, vcov<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for linking.haberman</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, digits<span class="op">=</span><span class="fl">3</span>, file<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">linking.haberman.lq</span><span class="op">(</span><span class="va">itempars</span>, pow<span class="op">=</span><span class="fl">2</span>, eps<span class="op">=</span><span class="fl">1e-3</span>, a_log<span class="op">=</span><span class="cn">TRUE</span>, use_nu<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>      est_pow<span class="op">=</span><span class="cn">FALSE</span>, lower_pow<span class="op">=</span><span class="fl">.1</span>, upper_pow<span class="op">=</span><span class="fl">3</span>, method<span class="op">=</span><span class="st">"joint"</span>,</span>
<span>      le<span class="op">=</span><span class="cn">FALSE</span>, vcov_list<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for linking.haberman.lq</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, digits<span class="op">=</span><span class="fl">3</span>, file<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## prepare 'itempars' argument for linking.haberman()</span></span>
<span><span class="fu">linking_haberman_itempars_prepare</span><span class="op">(</span><span class="va">b</span>, a<span class="op">=</span><span class="cn">NULL</span>, wgt<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## conversion of different parameterizations of item parameters</span></span>
<span><span class="fu">linking_haberman_itempars_convert</span><span class="op">(</span>itempars<span class="op">=</span><span class="cn">NULL</span>, lambda<span class="op">=</span><span class="cn">NULL</span>, nu<span class="op">=</span><span class="cn">NULL</span>, a<span class="op">=</span><span class="cn">NULL</span>, b<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## L0 polish precedure minimizing number of interactions in two-way table</span></span>
<span><span class="fu">L0_polish</span><span class="op">(</span><span class="va">x</span>, <span class="va">tol</span>, conv<span class="op">=</span><span class="fl">0.01</span>, maxiter<span class="op">=</span><span class="fl">30</span>, type<span class="op">=</span><span class="fl">1</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>itempars</dt>
<dd><p>A data frame with four or five columns. The first four columns contain
in the order: study name, item name, \(a\) parameter, \(b\) parameter.
The fifth column is an optional weight for every item and every study.</p></dd>

<dt>personpars</dt>
<dd><p>A list with vectors (e.g. EAPs or WLEs) or data frames
    (e.g. plausible values) containing person parameters which
    should be transformed.
If a data frame in each list entry has <code>se</code> or <code>SE</code>
(standard error) in a column name, then the corresponding
column is only multiplied by \(A_t\).
If a column is labeled as <code>pid</code> (person ID),
then it is left untransformed.</p></dd>

<dt>estimation</dt>
<dd><p>Estimation method. Can be <code>"OLS"</code> (ordinary least squares),
<code>"BSQ"</code> (bisquare weighted regression), <code>"HUB"</code> (regression using Huber
weights), <code>"MED"</code> (median regression), <code>"LTS"</code> (trimmed least squares),
<code>"L1"</code> (median polish), <code>"L0"</code> (minimizing number of interactions)</p></dd>

<dt>a_trim</dt>
<dd><p>Trimming parameter for item slopes \(a_{it}\) in
bisquare regression (see Details).</p></dd>

<dt>b_trim</dt>
<dd><p>Trimming parameter for item slopes \(b_{it}\) in
bisquare regression (see Details).</p></dd>

<dt>lts_prop</dt>
<dd><p>Proportion of retained observations in <code>"LTS"</code>
regression estimation</p></dd>

<dt>a_log</dt>
<dd><p>Logical indicating whether item slopes should be logarithmized
for linking.</p></dd>

<dt>conv</dt>
<dd><p>Convergence criterion.</p></dd>

  <dt>maxiter</dt>
<dd><p>Maximum number of iterations.</p></dd>

  <dt>progress</dt>
<dd><p>An optional logical indicating whether computational progress
should be displayed.</p></dd>

<dt>adjust_main_effects</dt>
<dd><p>Logical indicating whether all elements in the vector
of main effects should be simultaneously adjusted</p></dd>

<dt>vcov</dt>
<dd><p>Optional indicating whether covariance matrix for linking errors
should be computed</p></dd>

<dt>pow</dt>
<dd><p>Power \(q\)</p></dd>

<dt>eps</dt>
<dd><p>Epsilon value used in differentiable approximating function</p></dd>

<dt>use_nu</dt>
<dd><p>Logical indicating whether item intercepts instead of
item difficulties are used in linking</p></dd>

<dt>est_pow</dt>
<dd><p>Logical indicating whether power values should be estimated</p></dd>

<dt>lower_pow</dt>
<dd><p>Lower bound for estimated power</p></dd>

<dt>upper_pow</dt>
<dd><p>Upper bound for estimated power</p></dd>

<dt>method</dt>
<dd><p>Estimation method type: <code>"joint"</code> for joint estimation of
distribution and item parameters, while <code>"pw1"</code> and <code>"pw2"</code> indicate
pairwise estimation using no weights or weights for item frequencies</p></dd>

<dt>le</dt>
<dd><p>Logical indicating whether linking and standard errors should be
computed</p></dd>

<dt>vcov_list</dt>
<dd><p>List of variance matrices of item parameters</p></dd>

<dt>lambda</dt>
<dd><p>Matrix containing item loadings</p></dd>

<dt>nu</dt>
<dd><p>Matrix containing item intercepts</p></dd>

<dt>object</dt>
<dd><p>Object of class <code>linking.haberman</code>.</p></dd>

<dt>digits</dt>
<dd><p>Number of digits after decimals for rounding in <code>summary</code>.</p></dd>

<dt>file</dt>
<dd><p>Optional file name if <code>summary</code> should be sunk into a file.</p></dd>

<dt>...</dt>
<dd><p>Further arguments to be passed</p></dd>

<dt>b</dt>
<dd><p>Matrix of item intercepts (items \(times\) studies)</p></dd>

<dt>a</dt>
<dd><p>Matrix of item slopes</p></dd>

<dt>wgt</dt>
<dd><p>Matrix of weights</p></dd>

<dt>x</dt>
<dd><p>Matrix</p></dd>

<dt>tol</dt>
<dd><p>Tolerance value</p></dd>

<dt>type</dt>
<dd><p>Can be <code>1</code> (using Tukey's median polish) or
<code>2</code> (alternating median regression).</p></dd>

<dt>verbose</dt>
<dd><p>Logical indicating whether iteration progress should be displayed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For \(t=1,\ldots,T\) studies, item difficulties \(b_{it}\) and
item slopes \(a_{it}\) are available. For dichotomous responses, these
parameters are defined by the 2PL response equation
$$ logit P(X_{pi}=1| \theta_p )=a_i ( \theta_p - b_i ) $$
while for polytomous responses the generalized partial credit model holds
$$ log \frac{P(X_{pi}=k| \theta_p )}{P(X_{pi}=k-1| \theta_p )}
=a_i ( \theta_p - b_i + d_{ik} ) $$</p>
<p>The parameters \( \{ a_{it}, b_{it} \}\) of all items and studies are
linearly transformed using equations \(a_{it} \approx a_i / A_t\)
(if <code>a_log=TRUE</code>) or \(a_{it} \approx a_i + A_t\)
(if <code>a_log=FALSE</code>) and
\(b_{it} \cdot A_t \approx B_t + b_i\). For identification reasons,
we define \(A_1=1\) and \(B_1\)=0.</p>
<p>The optimization function (which is a least squares criterion;
see Haberman, 2009) seeks the transformation parameters \(A_t\) and
\(B_t\) with an alternating least squares
method (<code>estimation="OLS"</code>). Note that every item \(i\) and every study \(t\) can
be weighted (specified in the fifth column of <code>itempars</code>).
Alternatively, a robust regression method based on bisquare weighting (Fox, 2015)
can be employed for linking using the argument <code>estimation="BSQ"</code>.
For example, in the case of item loadings, bisquare weighting is applied to
residuals \(e_{it}=a_{it} - a_i - A_t \) (where logarithmized or non-logarithmized
item loadings are employed) forming weights
\(w_{it}=[ 1 - ( e_{it} / k )^2 ]^2\) for \(e_{it} &lt;k\) and 0 for \(e_{it} \ge k\)
where \(k\) is the trimming constant which can be estimated or fixed
during estimation using arguments <code>a_trim</code> or <code>b_trim</code>. Items in studies with
large residuals
(i.e., presence differential item functioning) are effectively set to zero in the
linking procedure. Alternatively, Huber weights (<code>estimation="HUB"</code>) downweight
large residuals by applying \(w_{it}=k / | e_{it} |\) for residuals
\(|e_{it}|&gt;k\).  The method <code>estimation="LTS"</code> employs trimmed least squares
where the proportion
of data retained is specified in <code>lts_prop</code> with default set to .50.</p>
<p>The method <code>estimation="MED"</code> estimates item parameters and linking constants
based on alternating median regression. A similar approach is the median polish
procedure of Tukey (Tukey, 1977, p. 362ff.; Maronna, Martin &amp; Yohai, 2006, p. 104;
see also <code><a href="https://rdrr.io/r/stats/medpolish.html" class="external-link">stats::medpolish</a></code>) implemented in
<code>estimation="L1"</code> which aims to minimize \(\sum_{i,t} | e_{it} |\).
For a pre-specified tolerance value \(t\) (in <code>a_trim</code> or <code>b_trim</code>),
the approach <code>estimation="L0"</code> minimizes the number of interactions
(i.e., DIF effects) in the \(e_{it}\) effects. In more detail, it minimizes
 \(\sum_{i,t} \# \{ | e_{it} | &gt; t \} \) which is computationally conducted
 by repeatedly applying the median polish procedure in which one cell is
omitted (Davies, 2012; Terbeck &amp; Davies, 1998).</p>
<p>Effect sizes of invariance are calculated as R-squared measures
of explained item slopes and intercepts after linking
in comparison to item parameters across groups
(Asparouhov &amp; Muthen, 2014).</p>
<p>The function \(linking.haberman.lq\) uses the loss function \(\rho(x)=|x|^q\).
The originally proposed Haberman linking can be obtained with <code>pow=2</code> (\(q=2\)).
The powers can also be estimated (argument <code>est_pow=TRUE</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with following entries</p>
<dl><dt>transf.pars</dt>
<dd><p>Data frame with transformation parameters
\(A_t\) and \(B_t\)</p></dd>

  <dt>transf.personpars</dt>
<dd><p>Data frame with linear transformation functions
  for person parameters</p></dd>

  <dt>joint.itempars</dt>
<dd><p>Estimated joint item parameters \(a_i\) and \(b_i\)</p></dd>

  <dt>a.trans</dt>
<dd><p>Transformed \(a_{it}\) parameters</p></dd>

  <dt>b.trans</dt>
<dd><p>Transformed \(b_{it}\) parameters</p></dd>

  <dt>a.orig</dt>
<dd><p>Original \(a_{it}\) parameters</p></dd>

  <dt>b.orig</dt>
<dd><p>Original \(b_{it}\) parameters</p></dd>

  <dt>a.resid</dt>
<dd><p>Residual \(a_{it}\) parameters (DIF parameters)</p></dd>

  <dt>b.resid</dt>
<dd><p>Residual \(b_{it}\) parameters (DIF parameters)</p></dd>

  <dt>personpars</dt>
<dd><p>Transformed person parameters</p></dd>

  <dt>es.invariance</dt>
<dd><p>Effect size measures of invariance,
        separately for item slopes and intercepts.
        In the rows, \(R^2\) and \(\sqrt{1-R^2}\) are reported.</p></dd>

  <dt>es.robust</dt>
<dd><p>Effect size measures of invariance based on
  robust estimation (if used).</p></dd>

  <dt>selitems</dt>
<dd><p>Indices of items which are present in more than one
  study.</p></dd>

  <dt>vcov</dt>
<dd><p>List containing standard, linking and total errors</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Asparouhov, T., &amp; Muthen, B. (2014). Multiple-group factor analysis alignment.
<em>Structural Equation Modeling, 21</em>(4), 1-14.
<a href="https://doi.org/10.1080/10705511.2014.919210" class="external-link">doi:10.1080/10705511.2014.919210</a></p>
<p>Battauz, M. (2017). Multiple equating of separate IRT calibrations.
<em>Psychometrika, 82</em>(3), 610-636.
<a href="https://doi.org/10.1007/s11336-016-9517-x" class="external-link">doi:10.1007/s11336-016-9517-x</a></p>
<p>Davies, P. L. (2012). Interactions in the analysis of variance.
<em>Journal of the American Statistical Association, 107</em>(500), 1502-1509.
<a href="https://doi.org/10.1080/01621459.2012.726895" class="external-link">doi:10.1080/01621459.2012.726895</a></p>
<p>Fox, J. (2015). <em>Applied regression analysis and generalized linear models</em>.
Thousand Oaks: Sage.</p>
<p>Haberman, S. J. (2009). <em>Linking parameter estimates derived
from an item response model through separate calibrations</em>.
ETS Research Report ETS RR-09-40. Princeton, ETS.
<a href="https://doi.org/10.1002/j.2333-8504.2009.tb02197.x" class="external-link">doi:10.1002/j.2333-8504.2009.tb02197.x</a></p>
<p>Kolen, M. J., &amp; Brennan, R. L. (2014). <em>Test equating, scaling, and linking:
Methods and practices</em>. New York: Springer.
<a href="https://doi.org/10.1007/978-1-4939-0317-7" class="external-link">doi:10.1007/978-1-4939-0317-7</a></p>
<p>Magis, D., &amp; De Boeck, P. (2012). A robust outlier approach to prevent type I error
inflation in differential item functioning.
<em>Educational and Psychological Measurement, 72</em>(2), 291-311.
<a href="https://doi.org/10.1177/0013164411416975" class="external-link">doi:10.1177/0013164411416975</a></p>
<p>Maronna, R. A., Martin, R. D., &amp; Yohai, V. J. (2006). <em>Robust statistics</em>.
West Sussex: Wiley. <a href="https://doi.org/10.1002/0470010940" class="external-link">doi:10.1002/0470010940</a></p>
<p>Terbeck, W., &amp; Davies, P. L. (1998). Interactions and outliers in the two-way
analysis of variance. <em>Annals of Statistics, 26</em>(4), 1279-1305.
doi: 10.1214/aos/1024691243</p>
<p>Tukey, J. W. (1977). <em>Exploratory data analysis</em>. Addison-Wesley.</p>
<p>Weeks, J. P. (2010). <span class="pkg">plink</span>: An <span style="R">R</span> package for linking mixed-format tests
using IRT-based methods. <code>Journal of Statistical Software, 35</code>(12), 1-33.
<a href="https://doi.org/10.18637/jss.v035.i12" class="external-link">doi:10.18637/jss.v035.i12</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See the <span class="pkg">plink</span> package (Weeks, 2010) for a diversity of linking methods.</p>
<p>Mean-mean linking, Stocking-Lord and Haebara linking (see Kolen &amp; Brennan, 2014,
for an overview) in the generalized logistic item response model can be conducted with
<code><a href="equating.rasch.html">equating.rasch</a></code>. See also <code><a href="https://rdrr.io/pkg/TAM/man/tam.linking.html" class="external-link">TAM::tam.linking</a></code>
in the <span class="pkg">TAM</span> package. Haebara linking and a robustified version of it can be
found in <code><a href="linking.haebara.html">linking.haebara</a></code>.</p>
<p>The invariance alignment method employs an optimization function based on
pairwise loss functions of item parameters (Asparouhov &amp; Muthen, 2014),
see <code><a href="invariance.alignment.html">invariance.alignment</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 1: Item parameters data.pars1.rasch and data.pars1.2pl</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="co"># Model 1: Linking three studies calibrated by the Rasch model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.pars1.rasch</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">data.pars1.rasch</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 1b: Linking these studies but weigh these studies by</span></span>
<span><span class="co">#     proportion weights 3 : 0.5 : 1 (see below).</span></span>
<span><span class="co">#     All weights are the same for each item but they could also</span></span>
<span><span class="co">#     be item specific.</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="va">data.pars1.rasch</span></span>
<span><span class="va">itempars</span><span class="op">$</span><span class="va">wgt</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">itempars</span><span class="op">[</span> <span class="va">itempars</span><span class="op">$</span><span class="va">study</span><span class="op">==</span><span class="st">"study1"</span>,<span class="st">"wgt"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">itempars</span><span class="op">[</span> <span class="va">itempars</span><span class="op">$</span><span class="va">study</span><span class="op">==</span><span class="st">"study2"</span>,<span class="st">"wgt"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span><span class="va">mod1b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1b</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 2: Linking three studies calibrated by the 2PL model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.pars1.2pl</span><span class="op">)</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">data.pars1.2pl</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># additive model instead of logarithmic model for item slopes</span></span>
<span><span class="va">mod2b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">data.pars1.2pl</span>, a_log<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2b</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 2: Linking longitudinal data</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.long</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#******</span></span>
<span><span class="co"># Model 1: Scaling with the 1PL model</span></span>
<span></span>
<span><span class="co"># scaling at T1</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">data.long</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"T1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data.long</span><span class="op">)</span> <span class="op">)</span> <span class="op">]</span></span>
<span><span class="va">resT1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat1</span> <span class="op">)</span></span>
<span><span class="va">itempartable1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study"</span><span class="op">=</span><span class="st">"T1"</span>, <span class="va">resT1</span><span class="op">$</span><span class="va">item</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"item"</span>, <span class="st">"a"</span>, <span class="st">"b"</span> <span class="op">)</span> <span class="op">]</span> <span class="op">)</span></span>
<span><span class="co"># scaling at T2</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">data.long</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"T2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data.long</span><span class="op">)</span> <span class="op">)</span> <span class="op">]</span></span>
<span><span class="va">resT2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat2</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">resT2</span><span class="op">)</span></span>
<span><span class="va">itempartable2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study"</span><span class="op">=</span><span class="st">"T2"</span>, <span class="va">resT2</span><span class="op">$</span><span class="va">item</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"item"</span>, <span class="st">"a"</span>, <span class="st">"b"</span> <span class="op">)</span> <span class="op">]</span> <span class="op">)</span></span>
<span><span class="va">itempartable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="va">itempartable1</span>, <span class="va">itempartable2</span> <span class="op">)</span></span>
<span><span class="va">itempartable</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span> <span class="va">itempartable</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">2</span> <span class="op">)</span></span>
<span><span class="co"># estimate linking parameters</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempartable</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#******</span></span>
<span><span class="co"># Model 2: Scaling with the 2PL model</span></span>
<span></span>
<span><span class="co"># scaling at T1</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">data.long</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"T1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data.long</span><span class="op">)</span> <span class="op">)</span> <span class="op">]</span></span>
<span><span class="va">resT1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat1</span>, est.a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">itempartable1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study"</span><span class="op">=</span><span class="st">"T1"</span>, <span class="va">resT1</span><span class="op">$</span><span class="va">item</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"item"</span>, <span class="st">"a"</span>, <span class="st">"b"</span> <span class="op">)</span> <span class="op">]</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># scaling at T2</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">data.long</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"T2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data.long</span><span class="op">)</span> <span class="op">)</span> <span class="op">]</span></span>
<span><span class="va">resT2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat2</span>, est.a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">resT2</span><span class="op">)</span></span>
<span><span class="va">itempartable2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study"</span><span class="op">=</span><span class="st">"T2"</span>, <span class="va">resT2</span><span class="op">$</span><span class="va">item</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"item"</span>, <span class="st">"a"</span>, <span class="st">"b"</span> <span class="op">)</span> <span class="op">]</span> <span class="op">)</span></span>
<span><span class="va">itempartable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="va">itempartable1</span>, <span class="va">itempartable2</span> <span class="op">)</span></span>
<span><span class="va">itempartable</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span> <span class="va">itempartable</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">2</span> <span class="op">)</span></span>
<span><span class="co"># estimate linking parameters</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempartable</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 3: 2 Studies - 1PL and 2PL linking</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">20</span>        <span class="co"># number of items</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">2000</span>       <span class="co"># number of persons</span></span>
<span><span class="co"># define item parameters</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, length<span class="op">=</span><span class="va">I</span> <span class="op">)</span></span>
<span><span class="co"># simulate data</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="sim.raschtype.html">sim.raschtype</a></span><span class="op">(</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="va">N</span>, mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span> <span class="op">)</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="sim.raschtype.html">sim.raschtype</a></span><span class="op">(</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="va">N</span>, mean<span class="op">=</span><span class="fl">0.5</span>,sd<span class="op">=</span><span class="fl">1.50</span> <span class="op">)</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 1: 1PL</span></span>
<span><span class="co"># 1PL Study 1</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat1</span>, est.a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">I</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co"># 1PL Study 2</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat2</span>, est.a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">I</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collect item parameters</span></span>
<span><span class="va">dfr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study1"</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">a</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="va">dfr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study2"</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">a</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"study"</span>, <span class="st">"item"</span>, <span class="st">"a"</span>, <span class="st">"b"</span> <span class="op">)</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="va">dfr1</span>, <span class="va">dfr2</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Haberman linking</span></span>
<span><span class="va">linkhab1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span>itempars<span class="op">=</span><span class="va">itempars</span><span class="op">)</span></span>
<span>  <span class="co">## Transformation parameters (Haberman linking)</span></span>
<span>  <span class="co">##    study    At     Bt</span></span>
<span>  <span class="co">## 1 study1 1.000  0.000</span></span>
<span>  <span class="co">## 2 study2 1.465 -0.512</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">## Linear transformation for item parameters a and b</span></span>
<span>  <span class="co">##    study   A_a   A_b    B_b</span></span>
<span>  <span class="co">## 1 study1 1.000 1.000  0.000</span></span>
<span>  <span class="co">## 2 study2 0.682 1.465 -0.512</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">## Linear transformation for person parameters theta</span></span>
<span>  <span class="co">##    study A_theta B_theta</span></span>
<span>  <span class="co">## 1 study1   1.000   0.000</span></span>
<span>  <span class="co">## 2 study2   1.465   0.512</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">## R-Squared Measures of Invariance</span></span>
<span>  <span class="co">##        slopes intercepts</span></span>
<span>  <span class="co">## R2          1     0.9979</span></span>
<span>  <span class="co">## sqrtU2      0     0.0456</span></span>
<span></span>
<span><span class="co">#*** Model 2: 2PL</span></span>
<span><span class="co"># 2PL Study 1</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat1</span>, est.a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">I</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co"># 2PL Study 2</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat2</span>, est.a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">I</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collect item parameters</span></span>
<span><span class="va">dfr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study1"</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">a</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="va">dfr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study2"</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">a</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"study"</span>, <span class="st">"item"</span>, <span class="st">"a"</span>, <span class="st">"b"</span> <span class="op">)</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="va">dfr1</span>, <span class="va">dfr2</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Haberman linking</span></span>
<span><span class="va">linkhab2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span>itempars<span class="op">=</span><span class="va">itempars</span><span class="op">)</span></span>
<span>  <span class="co">## Transformation parameters (Haberman linking)</span></span>
<span>  <span class="co">##    study    At     Bt</span></span>
<span>  <span class="co">## 1 study1 1.000  0.000</span></span>
<span>  <span class="co">## 2 study2 1.468 -0.515</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">## Linear transformation for item parameters a and b</span></span>
<span>  <span class="co">##    study   A_a   A_b    B_b</span></span>
<span>  <span class="co">## 1 study1 1.000 1.000  0.000</span></span>
<span>  <span class="co">## 2 study2 0.681 1.468 -0.515</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">## Linear transformation for person parameters theta</span></span>
<span>  <span class="co">##    study A_theta B_theta</span></span>
<span>  <span class="co">## 1 study1   1.000   0.000</span></span>
<span>  <span class="co">## 2 study2   1.468   0.515</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">## R-Squared Measures of Invariance</span></span>
<span>  <span class="co">##        slopes intercepts</span></span>
<span>  <span class="co">## R2     0.9984     0.9980</span></span>
<span>  <span class="co">## sqrtU2 0.0397     0.0443</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 4: 3 Studies - 1PL and 2PL linking</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">20</span>         <span class="co"># number of items</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1500</span>       <span class="co"># number of persons</span></span>
<span><span class="co"># define item parameters</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, length<span class="op">=</span><span class="va">I</span> <span class="op">)</span></span>
<span><span class="co"># simulate data</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="sim.raschtype.html">sim.raschtype</a></span><span class="op">(</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="va">N</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="sim.raschtype.html">sim.raschtype</a></span><span class="op">(</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="va">N</span>, mean<span class="op">=</span><span class="fl">0.5</span>, sd<span class="op">=</span><span class="fl">1.50</span><span class="op">)</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="va">dat3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="sim.raschtype.html">sim.raschtype</a></span><span class="op">(</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="va">N</span>, mean<span class="op">=</span><span class="op">-</span><span class="fl">0.2</span>, sd<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="co"># set some items to non-administered</span></span>
<span><span class="va">dat3</span> <span class="op">&lt;-</span> <span class="va">dat3</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">]</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">dat2</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">]</span></span>
<span></span>
<span><span class="co">#*** Model 1: 1PL in sirt</span></span>
<span><span class="co"># 1PL Study 1</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat1</span>, est.a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co"># 1PL Study 2</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat2</span>, est.a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co"># 1PL Study 3</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat3</span>, est.a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat3</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collect item parameters</span></span>
<span><span class="va">dfr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study1"</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">a</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="va">dfr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study2"</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">a</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="va">dfr3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study3"</span>, <span class="va">mod3</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod3</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">a</span>, <span class="va">mod3</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"study"</span>, <span class="st">"item"</span>, <span class="st">"a"</span>, <span class="st">"b"</span> <span class="op">)</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="va">dfr1</span>, <span class="va">dfr2</span>, <span class="va">dfr3</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># use person parameters</span></span>
<span><span class="va">personpars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">mod1</span><span class="op">$</span><span class="va">person</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAP"</span>,<span class="st">"SE.EAP"</span><span class="op">)</span> <span class="op">]</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">person</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAP"</span>,<span class="st">"SE.EAP"</span><span class="op">)</span> <span class="op">]</span>,</span>
<span>    <span class="va">mod3</span><span class="op">$</span><span class="va">person</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAP"</span>,<span class="st">"SE.EAP"</span><span class="op">)</span> <span class="op">]</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Haberman linking</span></span>
<span><span class="va">linkhab1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span>itempars<span class="op">=</span><span class="va">itempars</span>, personpars<span class="op">=</span><span class="va">personpars</span><span class="op">)</span></span>
<span><span class="co"># compare item parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">linkhab1</span><span class="op">$</span><span class="va">joint.itempars</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">linkhab1</span><span class="op">$</span><span class="va">b.trans</span> <span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span>, <span class="fl">3</span> <span class="op">)</span></span>
<span>  <span class="co">##            aj     bj study1 study2 study3</span></span>
<span>  <span class="co">##   I0001 0.998 -1.427 -1.427     NA     NA</span></span>
<span>  <span class="co">##   I0002 0.998 -1.290 -1.324     NA -1.256</span></span>
<span>  <span class="co">##   I0003 0.998 -1.140 -1.068     NA -1.212</span></span>
<span>  <span class="co">##   I0004 0.998 -0.986 -1.003 -0.969     NA</span></span>
<span>  <span class="co">##   I0005 0.998 -0.869 -0.809 -0.872 -0.926</span></span>
<span></span>
<span><span class="co"># summary of person parameters of second study</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.html" class="external-link">describe</a></span><span class="op">(</span> <span class="va">linkhab1</span><span class="op">$</span><span class="va">personpars</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span>, <span class="fl">2</span> <span class="op">)</span></span>
<span>  <span class="co">##   var    n mean   sd median trimmed  mad   min  max range  skew kurtosis</span></span>
<span>  <span class="co">## EAP      1 1500 0.45 1.36   0.41    0.47 1.52 -2.61 3.25  5.86 -0.08    -0.62</span></span>
<span>  <span class="co">## SE.EAP   2 1500 0.57 0.09   0.53    0.56 0.04  0.49 0.84  0.35  1.47     1.56</span></span>
<span>  <span class="co">##          se</span></span>
<span>  <span class="co">## EAP    0.04</span></span>
<span>  <span class="co">## SE.EAP 0.00</span></span>
<span></span>
<span><span class="co">#*** Model 2: 2PL in TAM</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.edmeasurementsurveys.com/TAM/Tutorials/" class="external-link">TAM</a></span><span class="op">)</span></span>
<span><span class="co"># 2PL Study 1</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">tam.mml.2pl</a></span><span class="op">(</span> resp<span class="op">=</span><span class="va">dat1</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span> <span class="op">)</span></span>
<span><span class="va">pvmod1</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.pv.html" class="external-link">tam.pv</a></span><span class="op">(</span><span class="va">mod1</span>, ntheta<span class="op">=</span><span class="fl">300</span>, normal.approx<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># draw plausible values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="co"># 2PL Study 2</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">tam.mml.2pl</a></span><span class="op">(</span> resp<span class="op">=</span><span class="va">dat2</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span> <span class="op">)</span></span>
<span><span class="va">pvmod2</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.pv.html" class="external-link">tam.pv</a></span><span class="op">(</span><span class="va">mod2</span>, ntheta<span class="op">=</span><span class="fl">300</span>, normal.approx<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co"># 2PL Study 3</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">tam.mml.2pl</a></span><span class="op">(</span> resp<span class="op">=</span><span class="va">dat3</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span> <span class="op">)</span></span>
<span><span class="va">pvmod3</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.pv.html" class="external-link">tam.pv</a></span><span class="op">(</span><span class="va">mod3</span>, ntheta<span class="op">=</span><span class="fl">300</span>, normal.approx<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collect item parameters</span></span>
<span><span class="co">#!!  Note that in TAM the parametrization is a*theta - b while linking.haberman</span></span>
<span><span class="co">#!!  needs the parametrization a*(theta-b)</span></span>
<span><span class="va">dfr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study1"</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">B</span><span class="op">[</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">mod1</span><span class="op">$</span><span class="va">xsi</span><span class="op">$</span><span class="va">xsi</span> <span class="op">/</span> <span class="va">mod1</span><span class="op">$</span><span class="va">B</span><span class="op">[</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span><span class="va">dfr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study2"</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">B</span><span class="op">[</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">mod2</span><span class="op">$</span><span class="va">xsi</span><span class="op">$</span><span class="va">xsi</span> <span class="op">/</span> <span class="va">mod2</span><span class="op">$</span><span class="va">B</span><span class="op">[</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span><span class="va">dfr3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study3"</span>, <span class="va">mod3</span><span class="op">$</span><span class="va">item</span><span class="op">$</span><span class="va">item</span>, <span class="va">mod3</span><span class="op">$</span><span class="va">B</span><span class="op">[</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">mod3</span><span class="op">$</span><span class="va">xsi</span><span class="op">$</span><span class="va">xsi</span> <span class="op">/</span> <span class="va">mod3</span><span class="op">$</span><span class="va">B</span><span class="op">[</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dfr1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"study"</span>, <span class="st">"item"</span>, <span class="st">"a"</span>, <span class="st">"b"</span> <span class="op">)</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="va">dfr1</span>, <span class="va">dfr2</span>, <span class="va">dfr3</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># define list containing person parameters</span></span>
<span><span class="va">personpars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>  <span class="va">pvmod1</span><span class="op">$</span><span class="va">pv</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pvmod2</span><span class="op">$</span><span class="va">pv</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">pvmod3</span><span class="op">$</span><span class="va">pv</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Haberman linking</span></span>
<span><span class="va">linkhab2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span>itempars<span class="op">=</span><span class="va">itempars</span>,personpars<span class="op">=</span><span class="va">personpars</span><span class="op">)</span></span>
<span>  <span class="co">##   Linear transformation for person parameters theta</span></span>
<span>  <span class="co">##      study A_theta B_theta</span></span>
<span>  <span class="co">##   1 study1   1.000   0.000</span></span>
<span>  <span class="co">##   2 study2   1.485   0.465</span></span>
<span>  <span class="co">##   3 study3   0.786  -0.192</span></span>
<span></span>
<span><span class="co"># extract transformed person parameters</span></span>
<span><span class="va">personpars.trans</span> <span class="op">&lt;-</span> <span class="va">linkhab2</span><span class="op">$</span><span class="va">personpars</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 5: Linking with simulated item parameters containing outliers</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="co"># simulate some parameters</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">38</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">18785</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span> <span class="va">I</span>, mean<span class="op">=</span><span class="fl">.3</span>, sd<span class="op">=</span><span class="fl">1.4</span> <span class="op">)</span></span>
<span><span class="co"># simulate DIF effects plus some outliers</span></span>
<span><span class="va">bdif</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">I</span>,mean<span class="op">=</span><span class="fl">.4</span>,sd<span class="op">=</span><span class="fl">.09</span><span class="op">)</span><span class="op">+</span><span class="op">(</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">I</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">.9</span> <span class="op">)</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.4</span>, each<span class="op">=</span><span class="va">I</span><span class="op">/</span><span class="fl">2</span> <span class="op">)</span></span>
<span><span class="co"># create item parameter table</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="st">"study"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"study"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each<span class="op">=</span><span class="va">I</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                <span class="st">"item"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span> <span class="st">"I"</span>, <span class="fl">100</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">I</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">)</span>, <span class="st">"a"</span><span class="op">=</span><span class="fl">1</span>,</span>
<span>                 <span class="st">"b"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">b</span>, <span class="va">b</span> <span class="op">+</span> <span class="va">bdif</span>  <span class="op">)</span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 1: Haberman linking with least squares regression</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 2: Haberman linking with robust bisquare regression with fixed trimming value</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span>, b_trim<span class="op">=</span><span class="fl">.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 2: Haberman linking with robust bisquare regression with estimated trimming value</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## see also Example 3 of ?sirt::robust.linking</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 6: Toy example of Magis and De Boeck (2012)</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="co"># define item parameters from Magis &amp; De Boeck (20212, p. 293)</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>study<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, item<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>, a<span class="op">=</span><span class="fl">1</span>, b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">b1</span>,<span class="va">b2</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#- Least squares regression</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"OLS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- Bisquare regression with estimated and fixed trimming factors</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span><span class="op">)</span></span>
<span><span class="va">mod2a</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span>, b_trim<span class="op">=</span><span class="fl">.4</span><span class="op">)</span></span>
<span><span class="va">mod2b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span>, b_trim<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2b</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- Least squares trimmed regression</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"LTS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- median regression</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span> itempars<span class="op">=</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"MED"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 7: Simulated example with directional DIF</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">98</span><span class="op">)</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span>, len<span class="op">=</span><span class="va">I</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sd_dif</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">mu</span>, <span class="st">"+"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">I</span><span class="op">*</span><span class="fl">3</span>, sd<span class="op">=</span><span class="va">sd_dif</span><span class="op">)</span></span>
<span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>; <span class="va">pars</span><span class="op">[</span><span class="va">ind</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="va">ind</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>; <span class="va">pars</span><span class="op">[</span><span class="va">ind</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="va">ind</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.6</span>,<span class="fl">.6</span><span class="op">)</span></span>
<span><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>; <span class="va">pars</span><span class="op">[</span><span class="va">ind</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="va">ind</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># median polish (=stats::medpolish())</span></span>
<span><span class="va">tmod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">:::</span><span class="fu">L1_polish</span><span class="op">(</span>x<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span>
<span><span class="co"># L0 polish with tolerance criterion of .3</span></span>
<span><span class="va">tmod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">L0_polish</span><span class="op">(</span>x<span class="op">=</span><span class="va">pars</span>, tol<span class="op">=</span><span class="fl">.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- prepare itempars input</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking_haberman_itempars_prepare</span><span class="op">(</span>b<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- compare different estimation functions for Haberman linking</span></span>
<span><span class="va">mod01</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"L1"</span><span class="op">)</span></span>
<span><span class="va">mod02</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"L0"</span>, b_trim<span class="op">=</span><span class="fl">.3</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"OLS"</span><span class="op">)</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span><span class="op">)</span></span>
<span><span class="va">mod2a</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span>, b_trim<span class="op">=</span><span class="fl">.4</span><span class="op">)</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"MED"</span><span class="op">)</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"LTS"</span><span class="op">)</span></span>
<span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"HUB"</span><span class="op">)</span></span>
<span><span class="va">mod01</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod02</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod1</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod2</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod2a</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod3</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod4</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod5</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 8: Many studies and directional DIF</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">98</span><span class="op">)</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># number of items</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">7</span>  <span class="co"># number of studies</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, len<span class="op">=</span><span class="va">S</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span>, len<span class="op">=</span><span class="va">I</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sd_dif</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span><span class="va">pars0</span> <span class="op">&lt;-</span> <span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">mu</span>, <span class="st">"+"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">I</span><span class="op">*</span><span class="va">S</span>, sd<span class="op">=</span><span class="va">sd_dif</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select n_dif items at random per group and set it to dif or -dif</span></span>
<span><span class="va">n_dif</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">dif</span> <span class="op">&lt;-</span> <span class="fl">.6</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ss</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">S</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="va">I</span>, <span class="va">n_dif</span> <span class="op">)</span></span>
<span>    <span class="va">pars</span><span class="op">[</span><span class="va">ind</span>,<span class="va">ss</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="va">ind</span>,<span class="va">ss</span><span class="op">]</span> <span class="op">+</span> <span class="va">dif</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">.5</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># check DIF</span></span>
<span><span class="va">pars</span> <span class="op">-</span> <span class="va">pars0</span></span>
<span></span>
<span><span class="co">#* estimate models</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking_haberman_itempars_prepare</span><span class="op">(</span>b<span class="op">=</span><span class="va">pars</span><span class="op">)</span></span>
<span><span class="va">mod0</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"L0"</span>, b_trim<span class="op">=</span><span class="fl">.2</span><span class="op">)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"OLS"</span><span class="op">)</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span><span class="op">)</span></span>
<span><span class="va">mod2a</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"BSQ"</span>, b_trim<span class="op">=</span><span class="fl">.4</span><span class="op">)</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"MED"</span><span class="op">)</span></span>
<span><span class="va">mod3a</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"L1"</span><span class="op">)</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"LTS"</span><span class="op">)</span></span>
<span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span><span class="va">itempars</span>, estimation<span class="op">=</span><span class="st">"HUB"</span><span class="op">)</span></span>
<span><span class="va">mod0</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod1</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod2</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod2a</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod3</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod3a</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod4</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span><span class="va">mod5</span><span class="op">$</span><span class="va">transf.pars</span></span>
<span></span>
<span><span class="co">#* compare results with Haebara linking</span></span>
<span><span class="va">mod11</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="linking.haebara.html">linking.haebara</a></span><span class="op">(</span><span class="va">itempars</span>, dist<span class="op">=</span><span class="st">"L2"</span><span class="op">)</span></span>
<span><span class="va">mod12</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="linking.haebara.html">linking.haebara</a></span><span class="op">(</span><span class="va">itempars</span>, dist<span class="op">=</span><span class="st">"L1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 9: Haberman linking for polytomous data</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="co">#* attach dataset involving two countries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.timssAusTwn.scored</span>, package<span class="op">=</span><span class="st">"TAM"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.timssAusTwn.scored</span></span>
<span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"M0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, value<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#* separate scaling with the generalized partial credit model (GPCM)</span></span>
<span><span class="va">mod2a</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">tam.mml.2pl</a></span><span class="op">(</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">IDCNTRY</span><span class="op">==</span><span class="fl">36</span>,<span class="va">items</span><span class="op">]</span>, irtmodel<span class="op">=</span><span class="st">"GPCM"</span><span class="op">)</span></span>
<span><span class="va">mod2b</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">tam.mml.2pl</a></span><span class="op">(</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">IDCNTRY</span><span class="op">==</span><span class="fl">158</span>,<span class="va">items</span><span class="op">]</span>, irtmodel<span class="op">=</span><span class="st">"GPCM"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#* function for extracting item parameters of the GPCM</span></span>
<span><span class="va">extract_gpcm_pars</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mod</span>, <span class="va">study</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>    <span class="co"># extract slope parameter</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">B</span><span class="op">[</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="co"># maximum score</span></span>
<span>    <span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span> <span class="va">mod</span><span class="op">$</span><span class="va">AXsi</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span></span>
<span>    <span class="co"># extract xsi</span></span>
<span>    <span class="va">xsi</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">xsi</span></span>
<span>    <span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="va">a</span>, <span class="va">K</span> <span class="op">)</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> study<span class="op">=</span><span class="va">study</span>, item<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">xsi</span><span class="op">)</span>, a<span class="op">=</span><span class="va">a1</span>, b<span class="op">=</span><span class="va">xsi</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">a1</span> <span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">itempars1</span> <span class="op">&lt;-</span> <span class="fu">extract_gpcm_pars</span><span class="op">(</span>mod<span class="op">=</span><span class="va">mod2a</span>, study<span class="op">=</span><span class="st">"CNT036"</span><span class="op">)</span></span>
<span><span class="va">itempars2</span> <span class="op">&lt;-</span> <span class="fu">extract_gpcm_pars</span><span class="op">(</span>mod<span class="op">=</span><span class="va">mod2b</span>, study<span class="op">=</span><span class="st">"CNT158"</span><span class="op">)</span></span>
<span><span class="va">itempars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">itempars1</span>, <span class="va">itempars2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#* apply Haberman linking</span></span>
<span><span class="va">lmod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">linking.haberman</span><span class="op">(</span>itempars<span class="op">=</span><span class="va">itempars</span><span class="op">)</span></span>
<span><span class="va">lmod1</span><span class="op">$</span><span class="va">transf.personpars</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

