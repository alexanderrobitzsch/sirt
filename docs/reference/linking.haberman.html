<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Linking in the 2PL/Generalized Partial Credit Model — linking.haberman • sirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Linking in the 2PL/Generalized Partial Credit Model — linking.haberman" />
<meta property="og:description" content="This function does the linking of several studies which are calibrated
using the 2PL or the generalized item response model according to
Haberman (2009). This method is a generalization of log-mean-mean
linking from one study to several studies. The default a_log=TRUE
logarithmizes item slopes for linking while otherwise an additive regression
model is assumed for the original item loadings (see Details; Battauz, 2017)" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.10-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Linking in the 2PL/Generalized Partial Credit Model</h1>
    
    <div class="hidden name"><code>linking.haberman.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function does the linking of several studies which are calibrated
using the 2PL or the generalized item response model according to
Haberman (2009). This method is a generalization of log-mean-mean
linking from one study to several studies. The default <code>a_log=TRUE</code>
logarithmizes item slopes for linking while otherwise an additive regression
model is assumed for the original item loadings (see Details; Battauz, 2017)</p>
    </div>

    <pre class="usage"><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='no'>personpars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"OLS"</span>, <span class='kw'>a_trim</span><span class='kw'>=</span><span class='fl'>Inf</span>, <span class='kw'>b_trim</span><span class='kw'>=</span><span class='fl'>Inf</span>,
    <span class='kw'>lts_prop</span><span class='kw'>=</span><span class='fl'>.5</span>, <span class='kw'>a_log</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>conv</span><span class='kw'>=</span><span class='fl'>1e-05</span>, <span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>progress</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>adjust_main_effects</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='co'># S3 method for linking.haberman</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>file</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>linking.haberman.lq</span>(<span class='no'>itempars</span>, <span class='kw'>pow</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-3</span>, <span class='kw'>a_log</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>use_nu</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
      <span class='kw'>est_pow</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>lower_pow</span><span class='kw'>=</span><span class='fl'>.1</span>, <span class='kw'>upper_pow</span><span class='kw'>=</span><span class='fl'>3</span>)

<span class='co'># S3 method for linking.haberman.lq</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>file</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'>## prepare 'itempars' argument for linking.haberman()</span>
<span class='fu'>linking_haberman_itempars_prepare</span>(<span class='no'>b</span>, <span class='kw'>a</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>wgt</span><span class='kw'>=</span><span class='kw'>NULL</span>)

<span class='co'>## conversion of different parameterizations of item parameters</span>
<span class='fu'>linking_haberman_itempars_convert</span>(<span class='kw'>itempars</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>lambda</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>nu</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>a</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='kw'>NULL</span>)

<span class='co'>## L0 polish precedure minimizing number of interactions in two-way table</span>
<span class='fu'>L0_polish</span>(<span class='no'>x</span>, <span class='no'>tol</span>, <span class='kw'>conv</span><span class='kw'>=</span><span class='fl'>0.01</span>, <span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>itempars</th>
      <td><p>A data frame with four or five columns. The first four columns contain
in the order: study name, item name, \(a\) parameter, \(b\) parameter.
The fifth column is an optional weight for every item and every study.</p></td>
    </tr>
    <tr>
      <th>personpars</th>
      <td><p>A list with vectors (e.g. EAPs or WLEs) or data frames
    (e.g. plausible values) containing person parameters which
    should be transformed.
If a data frame in each list entry has <code>se</code> or <code>SE</code>
(standard error) in a column name, then the corresponding
column is only multiplied by \(A_t\).
If a column is labeled as <code>pid</code> (person ID),
then it is left untransformed.</p></td>
    </tr>
    <tr>
      <th>estimation</th>
      <td><p>Estimation method. Can be <code>"OLS"</code> (ordinary least squares),
<code>"BSQ"</code> (bisquare weighted regression), <code>"HUB"</code> (regression using Huber
weights), <code>"MED"</code> (median regression), <code>"LTS"</code> (trimmed least squares),
<code>"L1"</code> (median polish), <code>"L0"</code> (minimizing number of interactions)</p></td>
    </tr>
    <tr>
      <th>a_trim</th>
      <td><p>Trimming parameter for item slopes \(a_{it}\) in
bisquare regression (see Details).</p></td>
    </tr>
    <tr>
      <th>b_trim</th>
      <td><p>Trimming parameter for item slopes \(b_{it}\) in
bisquare regression (see Details).</p></td>
    </tr>
    <tr>
      <th>lts_prop</th>
      <td><p>Proportion of retained observations in <code>"LTS"</code>
regression estimation</p></td>
    </tr>
    <tr>
      <th>a_log</th>
      <td><p>Logical indicating whether item slopes should be logarithmized
for linking.</p></td>
    </tr>
    <tr>
      <th>conv</th>
      <td><p>Convergence criterion.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>Maximum number of iterations.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>An optional logical indicating whether computational progress
should be displayed.</p></td>
    </tr>
    <tr>
      <th>adjust_main_effects</th>
      <td><p>Logical indicating whether all elements in the vector
of main effects should be simultaneously adjusted</p></td>
    </tr>
    <tr>
      <th>pow</th>
      <td><p>Power \(q\)</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>Epsilon value used in differentiable approximating function</p></td>
    </tr>
    <tr>
      <th>use_nu</th>
      <td><p>Logical indicating whether item intercepts instead of
item difficulties are used in linking</p></td>
    </tr>
    <tr>
      <th>est_pow</th>
      <td><p>Logical indicating whether power values should be estimated</p></td>
    </tr>
    <tr>
      <th>lower_pow</th>
      <td><p>Lower bound for estimated power</p></td>
    </tr>
    <tr>
      <th>upper_pow</th>
      <td><p>Upper bound for estimated power</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Matrix containing item loadings</p></td>
    </tr>
    <tr>
      <th>nu</th>
      <td><p>Matrix containing item intercepts</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Object of class <code>linking.haberman</code>.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>Number of digits after decimals for rounding in <code>summary</code>.</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>Optional file name if <code>summary</code> should be sunk into a file.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>Matrix of item intercepts (items \(times\) studies)</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>Matrix of item slopes</p></td>
    </tr>
    <tr>
      <th>wgt</th>
      <td><p>Matrix of weights</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Matrix</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Tolerance value</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Can be <code>1</code> (using Tukey's median polish) or
<code>2</code> (alternating median regression).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical indicating whether iteration progress should be displayed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For \(t=1,\ldots,T\) studies, item difficulties \(b_{it}\) and
item slopes \(a_{it}\) are available. For dichotomous responses, these
parameters are defined by the 2PL response equation
$$ logit P(X_{pi}=1| \theta_p )=a_i ( \theta_p - b_i ) $$
while for polytomous responses the generalized partial credit model holds
$$ log \frac{P(X_{pi}=k| \theta_p )}{P(X_{pi}=k-1| \theta_p )}
=a_i ( \theta_p - b_i + d_{ik} ) $$</p>
<p>The parameters \( \{ a_{it}, b_{it} \}\) of all items and studies are
linearly transformed using equations \(a_{it} \approx a_i / A_t\)
(if <code>a_log=TRUE</code>) or \(a_{it} \approx a_i + A_t\)
(if <code>a_log=FALSE</code>) and
\(b_{it} \cdot A_t \approx B_t + b_i\). For identification reasons,
we define \(A_1=1\) and \(B_1\)=0.</p>
<p>The optimization function (which is a least squares criterion;
see Haberman, 2009) seeks the transformation parameters \(A_t\) and
\(B_t\) with an alternating least squares
method (<code>estimation="OLS"</code>). Note that every item \(i\) and every study \(t\) can
be weighted (specified in the fifth column of <code>itempars</code>).
Alternatively, a robust regression method based on bisquare weighting (Fox, 2015)
can be employed for linking using the argument <code>estimation="BSQ"</code>.
For example, in the case of item loadings, bisquare weighting is applied to
residuals \(e_{it}=a_{it} - a_i - A_t \) (where logarithmized or non-logarithmized
item loadings are employed) forming weights
\(w_{it}=[ 1 - ( e_{it} / k )^2 ]^2\) for \(e_{it} &lt;k\) and 0 for \(e_{it} \ge k\)
where \(k\) is the trimming constant which can be estimated or fixed
during estimation using arguments <code>a_trim</code> or <code>b_trim</code>. Items in studies with
large residuals
(i.e., presence differential item functioning) are effectively set to zero in the
linking procedure. Alternatively, Huber weights (<code>estimation="HUB"</code>) downweight
large residuals by applying \(w_{it}=k / | e_{it} |\) for residuals
\(|e_{it}|&gt;k\).  The method <code>estimation="LTS"</code> employs trimmed least squares
where the proportion
of data retained is specified in <code>lts_prop</code> with default set to .50.</p>
<p>The method <code>estimation="MED"</code> estimates item parameters and linking constants
based on alternating median regression. A similar approach is the median polish
procedure of Tukey (Tukey, 1977, p. 362ff.; Maronna, Martin &amp; Yohai, 2006, p. 104;
see also <code><a href='https://rdrr.io/r/stats/medpolish.html'>stats::medpolish</a></code>) implemented in
<code>estimation="L1"</code> which aims to minimize \(\sum_{i,t} | e_{it} |\).
For a pre-specified tolerance value \(t\) (in <code>a_trim</code> or <code>b_trim</code>),
the approach <code>estimation="L0"</code> minimizes the number of interactions
(i.e., DIF effects) in the \(e_{it}\) effects. In more detail, it minimizes
 \(\sum_{i,t} \# \{ | e_{it} | &gt; t \} \) which is computationally conducted
 by repeatedly applying the median polish procedure in which one cell is
omitted (Davies, 2012; Terbeck &amp; Davies, 1998).</p>
<p>Effect sizes of invariance are calculated as R-squared measures
of explained item slopes and intercepts after linking
in comparison to item parameters across groups
(Asparouhov &amp; Muthen, 2014).</p>
<p>The function \(linking.haberman.lq\) uses the loss function \(\rho(x)=|x|^q\).
The originally proposed Haberman linking can be obtained with <code>pow=2</code> (\(q=2\)).
The powers can also be estimated (argument <code>est_pow=TRUE</code>).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with following entries</p>
<dt>transf.pars</dt><dd><p>Data frame with transformation parameters
\(A_t\) and \(B_t\)</p></dd>
  <dt>transf.personpars</dt><dd><p>Data frame with linear transformation functions
  for person parameters</p></dd>
  <dt>joint.itempars</dt><dd><p>Estimated joint item parameters \(a_i\) and \(b_i\)</p></dd>
  <dt>a.trans</dt><dd><p>Transformed \(a_{it}\) parameters</p></dd>
  <dt>b.trans</dt><dd><p>Transformed \(b_{it}\) parameters</p></dd>
  <dt>a.orig</dt><dd><p>Original \(a_{it}\) parameters</p></dd>
  <dt>b.orig</dt><dd><p>Original \(b_{it}\) parameters</p></dd>
  <dt>a.resid</dt><dd><p>Residual \(a_{it}\) parameters (DIF parameters)</p></dd>
  <dt>b.resid</dt><dd><p>Residual \(b_{it}\) parameters (DIF parameters)</p></dd>
  <dt>personpars</dt><dd><p>Transformed person parameters</p></dd>
  <dt>es.invariance</dt><dd><p>Effect size measures of invariance,
        separately for item slopes and intercepts.
        In the rows, \(R^2\) and \(\sqrt{1-R^2}\) are reported.</p></dd>
  <dt>es.robust</dt><dd><p>Effect size measures of invariance based on
  robust estimation (if used).</p></dd>
  <dt>selitems</dt><dd><p>Indices of items which are present in more than one
  study.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Asparouhov, T., &amp; Muthen, B. (2014). Multiple-group factor analysis alignment.
<em>Structural Equation Modeling, 21</em>(4), 1-14.
doi: <a href='https://doi.org/10.1080/10705511.2014.919210'>10.1080/10705511.2014.919210</a></p>
<p>Battauz, M. (2017). Multiple equating of separate IRT calibrations.
<em>Psychometrika, 82</em>(3), 610-636.
doi: <a href='https://doi.org/10.1007/s11336-016-9517-x'>10.1007/s11336-016-9517-x</a></p>
<p>Davies, P. L. (2012). Interactions in the analysis of variance.
<em>Journal of the American Statistical Association, 107</em>(500), 1502-1509.
doi: <a href='https://doi.org/10.1080/01621459.2012.726895'>10.1080/01621459.2012.726895</a></p>
<p>Fox, J. (2015). <em>Applied regression analysis and generalized linear models</em>.
Thousand Oaks: Sage.</p>
<p>Haberman, S. J. (2009). <em>Linking parameter estimates derived
from an item response model through separate calibrations</em>.
ETS Research Report ETS RR-09-40. Princeton, ETS.
doi: <a href='https://doi.org/10.1002/j.2333-8504.2009.tb02197.x'>10.1002/j.2333-8504.2009.tb02197.x</a></p>
<p>Kolen, M. J., &amp; Brennan, R. L. (2014). <em>Test equating, scaling, and linking:
Methods and practices</em>. New York: Springer.
doi: <a href='https://doi.org/10.1007/978-1-4939-0317-7'>10.1007/978-1-4939-0317-7</a></p>
<p>Magis, D., &amp; De Boeck, P. (2012). A robust outlier approach to prevent type I error
inflation in differential item functioning.
<em>Educational and Psychological Measurement, 72</em>(2), 291-311.
doi: <a href='https://doi.org/10.1177/0013164411416975'>10.1177/0013164411416975</a></p>
<p>Maronna, R. A., Martin, R. D., &amp; Yohai, V. J. (2006). <em>Robust statistics</em>.
West Sussex: Wiley. doi: <a href='https://doi.org/10.1002/0470010940'>10.1002/0470010940</a></p>
<p>Terbeck, W., &amp; Davies, P. L. (1998). Interactions and outliers in the two-way
analysis of variance. <em>Annals of Statistics, 26</em>(4), 1279-1305.
doi: <a href='https://doi.org/10/d66r8s'>10/d66r8s</a></p>
<p>Tukey, J. W. (1977). <em>Exploratory data analysis</em>. Addison-Wesley.</p>
<p>Weeks, J. P. (2010). <span class="pkg">plink</span>: An <span style="R">R</span> package for linking mixed-format tests
using IRT-based methods. <code>Journal of Statistical Software, 35</code>(12), 1-33.
doi: <a href='https://doi.org/10.18637/jss.v035.i12'>10.18637/jss.v035.i12</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See the <span class="pkg">plink</span> package (Weeks, 2010) for a diversity of linking methods.</p>
<p>Mean-mean linking, Stocking-Lord and Haebara linking (see Kolen &amp; Brennan, 2014,
for an overview) in the generalized logistic item response model can be conducted with
<code><a href='equating.rasch.html'>equating.rasch</a></code>. See also <code><a href='https://rdrr.io/pkg/TAM/man/tam.linking.html'>TAM::tam.linking</a></code>
in the <span class="pkg">TAM</span> package. Haebara linking and a robustified version of it can be
found in <code><a href='linking.haebara.html'>linking.haebara</a></code>.</p>
<p>The invariance alignment method employs an optimization function based on
pairwise loss functions of item parameters (Asparouhov &amp; Muthen, 2014),
see <code><a href='invariance.alignment.html'>invariance.alignment</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Item parameters data.pars1.rasch and data.pars1.2pl</span>
<span class='co'>#############################################################################</span>

<span class='co'># Model 1: Linking three studies calibrated by the Rasch model</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.pars1.rasch</span>)
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>data.pars1.rasch</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'># Model 1b: Linking these studies but weigh these studies by</span>
<span class='co'>#     proportion weights 3 : 0.5 : 1 (see below).</span>
<span class='co'>#     All weights are the same for each item but they could also</span>
<span class='co'>#     be item specific.</span>
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='no'>data.pars1.rasch</span>
<span class='no'>itempars</span>$<span class='no'>wgt</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>itempars</span>[ <span class='no'>itempars</span>$<span class='no'>study</span><span class='kw'>==</span><span class='st'>"study1"</span>,<span class='st'>"wgt"</span>] <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>itempars</span>[ <span class='no'>itempars</span>$<span class='no'>study</span><span class='kw'>==</span><span class='st'>"study2"</span>,<span class='st'>"wgt"</span>] <span class='kw'>&lt;-</span> <span class='fl'>.5</span>
<span class='no'>mod1b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1b</span>)

<span class='co'># Model 2: Linking three studies calibrated by the 2PL model</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.pars1.2pl</span>)
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>data.pars1.2pl</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'># additive model instead of logarithmic model for item slopes</span>
<span class='no'>mod2b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>data.pars1.2pl</span>, <span class='kw'>a_log</span><span class='kw'>=</span><span class='fl'>FALSE</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2b</span>)

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 2: Linking longitudinal data</span>
<span class='co'>#############################################################################</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.long</span>)

<span class='co'>#******</span>
<span class='co'># Model 1: Scaling with the 1PL model</span>

<span class='co'># scaling at T1</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='no'>data.long</span>[, <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>(<span class='st'>"T1"</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>data.long</span>) ) ]
<span class='no'>resT1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat1</span> )
<span class='no'>itempartable1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study"</span><span class='kw'>=</span><span class='st'>"T1"</span>, <span class='no'>resT1</span>$<span class='no'>item</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> ) ] )
<span class='co'># scaling at T2</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='no'>data.long</span>[, <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>(<span class='st'>"T2"</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>data.long</span>) ) ]
<span class='no'>resT2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat2</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>resT2</span>)
<span class='no'>itempartable2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study"</span><span class='kw'>=</span><span class='st'>"T2"</span>, <span class='no'>resT2</span>$<span class='no'>item</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> ) ] )
<span class='no'>itempartable</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='no'>itempartable1</span>, <span class='no'>itempartable2</span> )
<span class='no'>itempartable</span>[,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>( <span class='no'>itempartable</span>[,<span class='fl'>2</span>], <span class='fl'>1</span>, <span class='fl'>2</span> )
<span class='co'># estimate linking parameters</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempartable</span> )

<span class='co'>#******</span>
<span class='co'># Model 2: Scaling with the 2PL model</span>

<span class='co'># scaling at T1</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='no'>data.long</span>[, <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>(<span class='st'>"T1"</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>data.long</span>) ) ]
<span class='no'>resT1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat1</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>6</span>)
<span class='no'>itempartable1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study"</span><span class='kw'>=</span><span class='st'>"T1"</span>, <span class='no'>resT1</span>$<span class='no'>item</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> ) ] )

<span class='co'># scaling at T2</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='no'>data.long</span>[, <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>(<span class='st'>"T2"</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>data.long</span>) ) ]
<span class='no'>resT2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat2</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>6</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>resT2</span>)
<span class='no'>itempartable2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study"</span><span class='kw'>=</span><span class='st'>"T2"</span>, <span class='no'>resT2</span>$<span class='no'>item</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> ) ] )
<span class='no'>itempartable</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='no'>itempartable1</span>, <span class='no'>itempartable2</span> )
<span class='no'>itempartable</span>[,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>( <span class='no'>itempartable</span>[,<span class='fl'>2</span>], <span class='fl'>1</span>, <span class='fl'>2</span> )
<span class='co'># estimate linking parameters</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempartable</span> )

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 3: 2 Studies - 1PL and 2PL linking</span>
<span class='co'>#############################################################################</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>789</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>20</span>        <span class='co'># number of items</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>2000</span>       <span class='co'># number of persons</span>
<span class='co'># define item parameters</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( -<span class='fl'>1.5</span>, <span class='fl'>1.5</span>, <span class='kw'>length</span><span class='kw'>=</span><span class='no'>I</span> )
<span class='co'># simulate data</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span> ), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span> )
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>0.5</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1.50</span> ), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span> )

<span class='co'>#*** Model 1: 1PL</span>
<span class='co'># 1PL Study 1</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat1</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>I</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='co'># 1PL Study 2</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat2</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>I</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'># collect item parameters</span>
<span class='no'>dfr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study1"</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='no'>dfr2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study2"</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"study"</span>, <span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> )
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='no'>dfr1</span>, <span class='no'>dfr2</span> )

<span class='co'># Haberman linking</span>
<span class='no'>linkhab1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>)
  <span class='co'>## Transformation parameters (Haberman linking)</span>
  <span class='co'>##    study    At     Bt</span>
  <span class='co'>## 1 study1 1.000  0.000</span>
  <span class='co'>## 2 study2 1.465 -0.512</span>
  <span class='co'>##</span>
  <span class='co'>## Linear transformation for item parameters a and b</span>
  <span class='co'>##    study   A_a   A_b    B_b</span>
  <span class='co'>## 1 study1 1.000 1.000  0.000</span>
  <span class='co'>## 2 study2 0.682 1.465 -0.512</span>
  <span class='co'>##</span>
  <span class='co'>## Linear transformation for person parameters theta</span>
  <span class='co'>##    study A_theta B_theta</span>
  <span class='co'>## 1 study1   1.000   0.000</span>
  <span class='co'>## 2 study2   1.465   0.512</span>
  <span class='co'>##</span>
  <span class='co'>## R-Squared Measures of Invariance</span>
  <span class='co'>##        slopes intercepts</span>
  <span class='co'>## R2          1     0.9979</span>
  <span class='co'>## sqrtU2      0     0.0456</span>

<span class='co'>#*** Model 2: 2PL</span>
<span class='co'># 2PL Study 1</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat1</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='co'># 2PL Study 2</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat2</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'># collect item parameters</span>
<span class='no'>dfr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study1"</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='no'>dfr2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study2"</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"study"</span>, <span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> )
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='no'>dfr1</span>, <span class='no'>dfr2</span> )

<span class='co'># Haberman linking</span>
<span class='no'>linkhab2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>)
  <span class='co'>## Transformation parameters (Haberman linking)</span>
  <span class='co'>##    study    At     Bt</span>
  <span class='co'>## 1 study1 1.000  0.000</span>
  <span class='co'>## 2 study2 1.468 -0.515</span>
  <span class='co'>##</span>
  <span class='co'>## Linear transformation for item parameters a and b</span>
  <span class='co'>##    study   A_a   A_b    B_b</span>
  <span class='co'>## 1 study1 1.000 1.000  0.000</span>
  <span class='co'>## 2 study2 0.681 1.468 -0.515</span>
  <span class='co'>##</span>
  <span class='co'>## Linear transformation for person parameters theta</span>
  <span class='co'>##    study A_theta B_theta</span>
  <span class='co'>## 1 study1   1.000   0.000</span>
  <span class='co'>## 2 study2   1.468   0.515</span>
  <span class='co'>##</span>
  <span class='co'>## R-Squared Measures of Invariance</span>
  <span class='co'>##        slopes intercepts</span>
  <span class='co'>## R2     0.9984     0.9980</span>
  <span class='co'>## sqrtU2 0.0397     0.0443</span>

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 4: 3 Studies - 1PL and 2PL linking</span>
<span class='co'>#############################################################################</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>789</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>20</span>         <span class='co'># number of items</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>1500</span>       <span class='co'># number of persons</span>
<span class='co'># define item parameters</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( -<span class='fl'>1.5</span>, <span class='fl'>1.5</span>, <span class='kw'>length</span><span class='kw'>=</span><span class='no'>I</span> )
<span class='co'># simulate data</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span>), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span> )
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>0.5</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1.50</span>), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span> )
<span class='no'>dat3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N</span>, <span class='kw'>mean</span><span class='kw'>=</span>-<span class='fl'>0.2</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>0.8</span>), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span> )
<span class='co'># set some items to non-administered</span>
<span class='no'>dat3</span> <span class='kw'>&lt;-</span> <span class='no'>dat3</span>[, -<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>4</span>) ]
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='no'>dat2</span>[, -<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>) ]

<span class='co'>#*** Model 1: 1PL in sirt</span>
<span class='co'># 1PL Study 1</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat1</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat1</span>)) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='co'># 1PL Study 2</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat2</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat2</span>)) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='co'># 1PL Study 3</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat3</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat3</span>)) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'># collect item parameters</span>
<span class='no'>dfr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study1"</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='no'>dfr2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study2"</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='no'>dfr3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study3"</span>, <span class='no'>mod3</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod3</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod3</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr3</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"study"</span>, <span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> )
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='no'>dfr1</span>, <span class='no'>dfr2</span>, <span class='no'>dfr3</span> )

<span class='co'># use person parameters</span>
<span class='no'>personpars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='no'>mod1</span>$<span class='no'>person</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"EAP"</span>,<span class='st'>"SE.EAP"</span>) ], <span class='no'>mod2</span>$<span class='no'>person</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"EAP"</span>,<span class='st'>"SE.EAP"</span>) ],
    <span class='no'>mod3</span>$<span class='no'>person</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"EAP"</span>,<span class='st'>"SE.EAP"</span>) ] )

<span class='co'># Haberman linking</span>
<span class='no'>linkhab1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>personpars</span><span class='kw'>=</span><span class='no'>personpars</span>)
<span class='co'># compare item parameters</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='no'>linkhab1</span>$<span class='no'>joint.itempars</span>[,-<span class='fl'>1</span>], <span class='no'>linkhab1</span>$<span class='no'>b.trans</span> )[<span class='fl'>1</span>:<span class='fl'>5</span>,], <span class='fl'>3</span> )
  <span class='co'>##            aj     bj study1 study2 study3</span>
  <span class='co'>##   I0001 0.998 -1.427 -1.427     NA     NA</span>
  <span class='co'>##   I0002 0.998 -1.290 -1.324     NA -1.256</span>
  <span class='co'>##   I0003 0.998 -1.140 -1.068     NA -1.212</span>
  <span class='co'>##   I0004 0.998 -0.986 -1.003 -0.969     NA</span>
  <span class='co'>##   I0005 0.998 -0.869 -0.809 -0.872 -0.926</span>

<span class='co'># summary of person parameters of second study</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>( <span class='kw pkg'>psych</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/psych/man/describe.html'>describe</a></span>( <span class='no'>linkhab1</span>$<span class='no'>personpars</span><span class='kw'>[[</span><span class='fl'>2</span>]] ), <span class='fl'>2</span> )
  <span class='co'>##   var    n mean   sd median trimmed  mad   min  max range  skew kurtosis</span>
  <span class='co'>## EAP      1 1500 0.45 1.36   0.41    0.47 1.52 -2.61 3.25  5.86 -0.08    -0.62</span>
  <span class='co'>## SE.EAP   2 1500 0.57 0.09   0.53    0.56 0.04  0.49 0.84  0.35  1.47     1.56</span>
  <span class='co'>##          se</span>
  <span class='co'>## EAP    0.04</span>
  <span class='co'>## SE.EAP 0.00</span>

<span class='co'>#*** Model 2: 2PL in TAM</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>TAM</span>)
<span class='co'># 2PL Study 1</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.mml.html'>tam.mml.2pl</a></span>( <span class='kw'>resp</span><span class='kw'>=</span><span class='no'>dat1</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"2PL"</span> )
<span class='no'>pvmod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.pv.html'>tam.pv</a></span>(<span class='no'>mod1</span>, <span class='kw'>ntheta</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>normal.approx</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'># draw plausible values</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='co'># 2PL Study 2</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.mml.html'>tam.mml.2pl</a></span>( <span class='kw'>resp</span><span class='kw'>=</span><span class='no'>dat2</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"2PL"</span> )
<span class='no'>pvmod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.pv.html'>tam.pv</a></span>(<span class='no'>mod2</span>, <span class='kw'>ntheta</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>normal.approx</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='co'># 2PL Study 3</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.mml.html'>tam.mml.2pl</a></span>( <span class='kw'>resp</span><span class='kw'>=</span><span class='no'>dat3</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"2PL"</span> )
<span class='no'>pvmod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.pv.html'>tam.pv</a></span>(<span class='no'>mod3</span>, <span class='kw'>ntheta</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>normal.approx</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'># collect item parameters</span>
<span class='co'>#!!  Note that in TAM the parametrization is a*theta - b while linking.haberman</span>
<span class='co'>#!!  needs the parametrization a*(theta-b)</span>
<span class='no'>dfr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study1"</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod1</span>$<span class='no'>B</span>[,<span class='fl'>2</span>,<span class='fl'>1</span>], <span class='no'>mod1</span>$<span class='no'>xsi</span>$<span class='no'>xsi</span> / <span class='no'>mod1</span>$<span class='no'>B</span>[,<span class='fl'>2</span>,<span class='fl'>1</span>] )
<span class='no'>dfr2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study2"</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod2</span>$<span class='no'>B</span>[,<span class='fl'>2</span>,<span class='fl'>1</span>], <span class='no'>mod2</span>$<span class='no'>xsi</span>$<span class='no'>xsi</span> / <span class='no'>mod2</span>$<span class='no'>B</span>[,<span class='fl'>2</span>,<span class='fl'>1</span>] )
<span class='no'>dfr3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study3"</span>, <span class='no'>mod3</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod3</span>$<span class='no'>B</span>[,<span class='fl'>2</span>,<span class='fl'>1</span>], <span class='no'>mod3</span>$<span class='no'>xsi</span>$<span class='no'>xsi</span> / <span class='no'>mod3</span>$<span class='no'>B</span>[,<span class='fl'>2</span>,<span class='fl'>1</span>] )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr3</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"study"</span>, <span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> )
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='no'>dfr1</span>, <span class='no'>dfr2</span>, <span class='no'>dfr3</span> )

<span class='co'># define list containing person parameters</span>
<span class='no'>personpars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(  <span class='no'>pvmod1</span>$<span class='no'>pv</span>[,-<span class='fl'>1</span>], <span class='no'>pvmod2</span>$<span class='no'>pv</span>[,-<span class='fl'>1</span>], <span class='no'>pvmod3</span>$<span class='no'>pv</span>[,-<span class='fl'>1</span>] )

<span class='co'># Haberman linking</span>
<span class='no'>linkhab2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>,<span class='kw'>personpars</span><span class='kw'>=</span><span class='no'>personpars</span>)
  <span class='co'>##   Linear transformation for person parameters theta</span>
  <span class='co'>##      study A_theta B_theta</span>
  <span class='co'>##   1 study1   1.000   0.000</span>
  <span class='co'>##   2 study2   1.485   0.465</span>
  <span class='co'>##   3 study3   0.786  -0.192</span>

<span class='co'># extract transformed person parameters</span>
<span class='no'>personpars.trans</span> <span class='kw'>&lt;-</span> <span class='no'>linkhab2</span>$<span class='no'>personpars</span>

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 5: Linking with simulated item parameters containing outliers</span>
<span class='co'>#############################################################################</span>

<span class='co'># simulate some parameters</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>38</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>18785</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>I</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>.3</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1.4</span> )
<span class='co'># simulate DIF effects plus some outliers</span>
<span class='no'>bdif</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>I</span>,<span class='kw'>mean</span><span class='kw'>=</span><span class='fl'>.4</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.09</span>)+( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='no'>I</span>)<span class='kw'>&gt;</span><span class='fl'>.9</span> )* <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fl'>1</span>*<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1</span>,<span class='fl'>1</span>)+<span class='fl'>.4</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='no'>I</span>/<span class='fl'>2</span> )
<span class='co'># create item parameter table</span>
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"study"</span>,<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='no'>I</span>)),
                <span class='st'>"item"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>( <span class='st'>"I"</span>, <span class='fl'>100</span> + <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='no'>I</span>,<span class='fl'>2</span>) ), <span class='st'>"a"</span><span class='kw'>=</span><span class='fl'>1</span>,
                 <span class='st'>"b"</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='no'>b</span>, <span class='no'>b</span> + <span class='no'>bdif</span>  )  )

<span class='co'>#*** Model 1: Haberman linking with least squares regression</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#*** Model 2: Haberman linking with robust bisquare regression with fixed trimming value</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>, <span class='kw'>b_trim</span><span class='kw'>=</span><span class='fl'>.4</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#*** Model 2: Haberman linking with robust bisquare regression with estimated trimming value</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'>## see also Example 3 of ?sirt::robust.linking</span>

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 6: Toy example of Magis and De Boeck (2012)</span>
<span class='co'>#############################################################################</span>

<span class='co'># define item parameters from Magis &amp; De Boeck (20212, p. 293)</span>
<span class='no'>b1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>)
<span class='no'>b2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>)
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>study</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='fl'>4</span>), <span class='kw'>item</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>2</span>), <span class='kw'>a</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>b1</span>,<span class='no'>b2</span>) )

<span class='co'>#- Least squares regression</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"OLS"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#- Bisquare regression with estimated and fixed trimming factors</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>)
<span class='no'>mod2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>, <span class='kw'>b_trim</span><span class='kw'>=</span><span class='fl'>.4</span>)
<span class='no'>mod2b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>, <span class='kw'>b_trim</span><span class='kw'>=</span><span class='fl'>1.2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2a</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2b</span>)

<span class='co'>#- Least squares trimmed regression</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"LTS"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'>#- median regression</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>( <span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"MED"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 7: Simulated example with directional DIF</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>98</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>8</span>
<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>.5</span>, <span class='fl'>0</span>, <span class='fl'>.5</span>)
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>1.5</span>,<span class='fl'>1.5</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span>))
<span class='no'>sd_dif</span> <span class='kw'>&lt;-</span> <span class='fl'>0.001</span>
<span class='no'>pars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='no'>b</span>, <span class='no'>mu</span>, <span class='st'>"+"</span>) + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>I</span>*<span class='fl'>3</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='no'>sd_dif</span>)
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>); <span class='no'>pars</span>[<span class='no'>ind</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>pars</span>[<span class='no'>ind</span>,<span class='fl'>1</span>] + <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.5</span>,<span class='fl'>.5</span>)
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>4</span>); <span class='no'>pars</span>[<span class='no'>ind</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>pars</span>[<span class='no'>ind</span>,<span class='fl'>2</span>] + (-<span class='fl'>1</span>)*<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.6</span>,<span class='fl'>.6</span>)
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>6</span>); <span class='no'>pars</span>[<span class='no'>ind</span>,<span class='fl'>3</span>] <span class='kw'>&lt;-</span> <span class='no'>pars</span>[<span class='no'>ind</span>,<span class='fl'>3</span>] + (-<span class='fl'>1</span>)*<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>)

<span class='co'># median polish (=stats::medpolish())</span>
<span class='no'>tmod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>:::</span><span class='fu'>L1_polish</span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>pars</span>)
<span class='co'># L0 polish with tolerance criterion of .3</span>
<span class='no'>tmod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>L0_polish</span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>pars</span>, <span class='kw'>tol</span><span class='kw'>=</span><span class='fl'>.3</span>)

<span class='co'>#- prepare itempars input</span>
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking_haberman_itempars_prepare</span>(<span class='kw'>b</span><span class='kw'>=</span><span class='no'>pars</span>)

<span class='co'>#- compare different estimation functions for Haberman linking</span>
<span class='no'>mod01</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"L1"</span>)
<span class='no'>mod02</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"L0"</span>, <span class='kw'>b_trim</span><span class='kw'>=</span><span class='fl'>.3</span>)
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"OLS"</span>)
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>)
<span class='no'>mod2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>, <span class='kw'>b_trim</span><span class='kw'>=</span><span class='fl'>.4</span>)
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"MED"</span>)
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"LTS"</span>)
<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"HUB"</span>)
<span class='no'>mod01</span>$<span class='no'>transf.pars</span>
<span class='no'>mod02</span>$<span class='no'>transf.pars</span>
<span class='no'>mod1</span>$<span class='no'>transf.pars</span>
<span class='no'>mod2</span>$<span class='no'>transf.pars</span>
<span class='no'>mod2a</span>$<span class='no'>transf.pars</span>
<span class='no'>mod3</span>$<span class='no'>transf.pars</span>
<span class='no'>mod4</span>$<span class='no'>transf.pars</span>
<span class='no'>mod5</span>$<span class='no'>transf.pars</span>

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 8: Many studies and directional DIF</span>
<span class='co'>#############################################################################</span>

<span class='co'>## dataset 2</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>98</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span> <span class='co'># number of items</span>
<span class='no'>S</span> <span class='kw'>&lt;-</span> <span class='fl'>7</span>  <span class='co'># number of studies</span>
<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>S</span>))
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>1.5</span>,<span class='fl'>1.5</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span>))
<span class='no'>sd_dif</span> <span class='kw'>&lt;-</span> <span class='fl'>0.001</span>
<span class='no'>pars0</span> <span class='kw'>&lt;-</span> <span class='no'>pars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='no'>b</span>, <span class='no'>mu</span>, <span class='st'>"+"</span>) + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>I</span>*<span class='no'>S</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='no'>sd_dif</span>)

<span class='co'># select n_dif items at random per group and set it to dif or -dif</span>
<span class='no'>n_dif</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>dif</span> <span class='kw'>&lt;-</span> <span class='fl'>.6</span>
<span class='kw'>for</span> (<span class='no'>ss</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>S</span>){
    <span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>( <span class='fl'>1</span>:<span class='no'>I</span>, <span class='no'>n_dif</span> )
    <span class='no'>pars</span>[<span class='no'>ind</span>,<span class='no'>ss</span>] <span class='kw'>&lt;-</span> <span class='no'>pars</span>[<span class='no'>ind</span>,<span class='no'>ss</span>] + <span class='no'>dif</span>*<span class='fu'><a href='https://rdrr.io/r/base/sign.html'>sign</a></span>( <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>1</span>) - <span class='fl'>.5</span> )
}

<span class='co'># check DIF</span>
<span class='no'>pars</span> - <span class='no'>pars0</span>

<span class='co'>#* estimate models</span>
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking_haberman_itempars_prepare</span>(<span class='kw'>b</span><span class='kw'>=</span><span class='no'>pars</span>)
<span class='no'>mod0</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"L0"</span>, <span class='kw'>b_trim</span><span class='kw'>=</span><span class='fl'>.2</span>)
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"OLS"</span>)
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>)
<span class='no'>mod2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"BSQ"</span>, <span class='kw'>b_trim</span><span class='kw'>=</span><span class='fl'>.4</span>)
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"MED"</span>)
<span class='no'>mod3a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"L1"</span>)
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"LTS"</span>)
<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>linking.haberman</span>(<span class='no'>itempars</span>, <span class='kw'>estimation</span><span class='kw'>=</span><span class='st'>"HUB"</span>)
<span class='no'>mod0</span>$<span class='no'>transf.pars</span>
<span class='no'>mod1</span>$<span class='no'>transf.pars</span>
<span class='no'>mod2</span>$<span class='no'>transf.pars</span>
<span class='no'>mod2a</span>$<span class='no'>transf.pars</span>
<span class='no'>mod3</span>$<span class='no'>transf.pars</span>
<span class='no'>mod3a</span>$<span class='no'>transf.pars</span>
<span class='no'>mod4</span>$<span class='no'>transf.pars</span>
<span class='no'>mod5</span>$<span class='no'>transf.pars</span>

<span class='co'>#* compare results with Haebara linking</span>
<span class='no'>mod11</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='linking.haebara.html'>linking.haebara</a></span>(<span class='no'>itempars</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"L2"</span>)
<span class='no'>mod12</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='linking.haebara.html'>linking.haebara</a></span>(<span class='no'>itempars</span>, <span class='kw'>dist</span><span class='kw'>=</span><span class='st'>"L1"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod11</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod12</span>)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


