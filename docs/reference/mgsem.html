<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimation of Multiple-Group Structural Equation Models — mgsem • sirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimation of Multiple-Group Structural Equation Models — mgsem" />
<meta property="og:description" content="Estimates a multiple-group structural equation model. The function allows arbitrary
prior distributions on model parameters and regularized estimation with the SCAD and
the LASSO penalty. Moreover, it can also conduct robust moment estimation using
the \(L_p\) loss function \(\rho(x)=|x|^p\) for \(p \ge 0\). 
See Robitzsch (2023) for more details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.13-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimation of Multiple-Group Structural Equation Models</h1>
    
    <div class="hidden name"><code>mgsem.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimates a multiple-group structural equation model. The function allows arbitrary
prior distributions on model parameters and regularized estimation with the SCAD and
the LASSO penalty. Moreover, it can also conduct robust moment estimation using
the \(L_p\) loss function \(\rho(x)=|x|^p\) for \(p \ge 0\). 
See Robitzsch (2023) for more details.</p>
    </div>

    <pre class="usage"><span class='fu'>mgsem</span>(<span class='no'>suffstat</span>, <span class='no'>model</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>estimator</span> <span class='kw'>=</span> <span class='st'>"ML"</span>,
     <span class='kw'>p_me</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>p_pen</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>pen_type</span> <span class='kw'>=</span> <span class='st'>"scad"</span>, <span class='kw'>diffpar_pen</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pen_sample_size</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
     <span class='kw'>a_scad</span> <span class='kw'>=</span> <span class='fl'>3.7</span>, <span class='kw'>eps_approx</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>comp_se</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>se_delta_formula</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
     <span class='kw'>prior_list</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>hessian</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>fixed_parms</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>cd</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
     <span class='kw'>cd_control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>20</span>, <span class='kw'>tol</span><span class='kw'>=</span><span class='fl'>5</span>*<span class='fl'>1e-04</span>, <span class='kw'>interval_length</span><span class='kw'>=</span><span class='fl'>0.05</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"exact"</span>),
     <span class='kw'>partable_start</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>num_approx</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>technical</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>())</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>suffstat</th>
      <td><p>List containing sufficient statistics</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Model specification, see examples. Can have entries <code>est</code>, <code>index</code>,
<code>lower</code>, <code>upper</code>, <code>prior</code>, <code>pen_l2</code>, <code>pen_lp</code>,
<code>pen_difflp</code>. Each entry can be defined for model matrices <code>ALPHA</code>,
<code>NU</code>, <code>LAM</code>, <code>PHI</code>, and <code>PSI</code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Optional data frame</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Optional vector of group identifiers</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Optional vector of sampling weights</p></td>
    </tr>
    <tr>
      <th>estimator</th>
      <td><p>Character. Can be either <code>"ML"</code> for maximum likelihood fitting function or
<code>"ME"</code> for robust moment estimation.</p></td>
    </tr>
    <tr>
      <th>p_me</th>
      <td><p>Power in $L_p$ loss function for robust moment estimation</p></td>
    </tr>
    <tr>
      <th>p_pen</th>
      <td><p>Power for penalty in regularized estimation. For regular LASSO and SCAD penalty
functions, it is $p=1$.</p></td>
    </tr>
    <tr>
      <th>pen_type</th>
      <td><p>Penalty type. Can be either <code>"scad"</code> or <code>"lasso"</code>.</p></td>
    </tr>
    <tr>
      <th>diffpar_pen</th>
      <td><p>List containing values of regularization parameters in fused lasso estimation</p></td>
    </tr>
    <tr>
      <th>pen_sample_size</th>
      <td><p>List containing values for sample sizes for regularized estimation</p></td>
    </tr>
    <tr>
      <th>a_scad</th>
      <td><p>Parameter $a$ used in SCAD penalty</p></td>
    </tr>
    <tr>
      <th>eps_approx</th>
      <td><p>Approximation value for nondifferentiable robust moment fitting function or
penalty function</p></td>
    </tr>
    <tr>
      <th>comp_se</th>
      <td><p>Logical indicating whether standard errors should be computed</p></td>
    </tr>
    <tr>
      <th>se_delta_formula</th>
      <td><p>Logical indicating whether standard errors should be computed according to the
delta formula</p></td>
    </tr>
    <tr>
      <th>prior_list</th>
      <td><p>List containing specifications of the prior distributions</p></td>
    </tr>
    <tr>
      <th>hessian</th>
      <td><p>Logical indicating whether the Hessian matrix should be computed</p></td>
    </tr>
    <tr>
      <th>fixed_parms</th>
      <td><p>Logical indicating whether all model parameters should be fixed</p></td>
    </tr>
    <tr>
      <th>cd</th>
      <td><p>Logical indicating whether coordinate descent should be used for estimation</p></td>
    </tr>
    <tr>
      <th>cd_control</th>
      <td><p>Control parameters for coordinate descent estimation</p></td>
    </tr>
    <tr>
      <th>partable_start</th>
      <td><p>Starting values for parameter estimation</p></td>
    </tr>
    <tr>
      <th>num_approx</th>
      <td><p>Logical indicating whether derivatives should be computed based on numerical 
differentiation</p></td>
    </tr>
    <tr>
      <th>technical</th>
      <td><p>Parameters used for optimization in <code>sirt_optimizer</code></p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>Control paramaters for optimization</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>[MORE INFORMATION TO BE ADDED]</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with following values</p>
<dt>coef</dt><dd><p>Coeffients</p></dd>
<dt>vcov</dt><dd><p>Variance matrix</p></dd>
<dt>se</dt><dd><p>Vector of standard errors</p></dd>
<dt>partable</dt><dd><p>Parameter table</p></dd>
<dt>model</dt><dd><p>Specified model</p></dd>
<dt>opt_res</dt><dd><p>Result from optimization</p></dd>
<dt>opt_value</dt><dd><p>Value of fitting function</p></dd>
<dt>residuals</dt><dd><p>Residuals of sufficient statistics</p></dd>
<dt>ic</dt><dd><p>Information criteria</p></dd>
<dt>technical</dt><dd><p>Specifications of optimizer</p></dd>
<dt>suffstat_vcov</dt><dd><p>Variance matrix of sufficient statistics</p></dd>
<dt>data_proc</dt><dd><p>Processed data</p></dd>
<dt>case_ll</dt><dd><p>Casewise log-likelihood function</p></dd>
<dt>...</dt><dd><p>Further values</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Robitzsch, A. (2023). Model-robust estimation of multiple-group structural 
equation models. <em>Algorithms, 16</em>(4), 210. doi: <a href='https://doi.org/10.3390/a16040210'>10.3390/a16040210</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Noninvariant item intercepts in a multiple-group SEM</span>
<span class='co'>#############################################################################</span>

<span class='co'>#---- simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>65</span>)
<span class='no'>G</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>  <span class='co'># number of groups</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>5</span>  <span class='co'># number of items</span>
<span class='co'># define lambda and nu parameters</span>
<span class='no'>lambda</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>1</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>G</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span>)
<span class='no'>nu</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>G</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span>)
<span class='no'>err_var</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>1</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>G</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span>)

<span class='co'># define extent of noninvariance</span>
<span class='no'>dif_int</span> <span class='kw'>&lt;-</span> <span class='fl'>.5</span>

<span class='co'>#- 1st group: N(0,1)</span>
<span class='no'>nu</span>[<span class='fl'>1</span>,<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>dif_int</span>
<span class='co'>#- 2nd group: N(0.3,1.5)</span>
<span class='no'>gg</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span> ;
<span class='no'>nu</span>[<span class='no'>gg</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> -<span class='no'>dif_int</span>
<span class='co'>#- 3nd group: N(.8,1.2)</span>
<span class='no'>gg</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>nu</span>[<span class='no'>gg</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> -<span class='no'>dif_int</span>
<span class='co'>#- define distributions of groups</span>
<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>.3</span>,<span class='fl'>.8</span>)
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1.5</span>,<span class='fl'>1.2</span>))
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1000</span>,<span class='fl'>3</span>) <span class='co'># sample sizes per group</span>

<span class='no'>exact</span> <span class='kw'>&lt;-</span> <span class='fl'>FALSE</span>
<span class='no'>suffstat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='invariance.alignment.html'>invariance_alignment_simulate</a></span>(<span class='no'>nu</span>, <span class='no'>lambda</span>, <span class='no'>err_var</span>, <span class='no'>mu</span>, <span class='no'>sigma</span>, <span class='no'>N</span>,
                <span class='kw'>output</span><span class='kw'>=</span><span class='st'>"suffstat"</span>, <span class='kw'>groupwise</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>exact</span><span class='kw'>=</span><span class='no'>exact</span>)

<span class='co'>#---- model specification</span>

<span class='co'># model specifications joint group</span>
<span class='no'>est</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='kw'>ALPHA</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>),
        <span class='kw'>NU</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>I</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>),
        <span class='kw'>LAM</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>1</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>I</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>),
        <span class='kw'>PHI</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0</span>,<span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>),
        <span class='kw'>PSI</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>I</span>))
        )

<span class='co'># parameter index</span>
<span class='no'>index</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='kw'>ALPHA</span><span class='kw'>=</span><span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>ALPHA</span>,
        <span class='kw'>NU</span><span class='kw'>=</span><span class='fl'>1</span>+<span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>NU</span>,
        <span class='kw'>LAM</span><span class='kw'>=</span><span class='fl'>1</span>+<span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>LAM</span>,
        <span class='kw'>PHI</span><span class='kw'>=</span><span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>PHI</span>,
        <span class='kw'>PSI</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fl'>1</span>,<span class='no'>I</span>)
        )

<span class='co'># lower bounds</span>
<span class='no'>lower</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='kw'>PSI</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0.01</span>,<span class='no'>I</span>)), <span class='kw'>PHI</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0.01</span>,<span class='fl'>1</span>,<span class='fl'>1</span>)
        )

<span class='co'>#*** joint parameters</span>
<span class='no'>group0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>est</span><span class='kw'>=</span><span class='no'>est</span>, <span class='kw'>index</span><span class='kw'>=</span><span class='no'>index</span>, <span class='kw'>lower</span><span class='kw'>=</span><span class='no'>lower</span>)

<span class='co'>#*** group1</span>
<span class='no'>est</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='kw'>ALPHA</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>),
        <span class='kw'>NU</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>I</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>),
        <span class='kw'>LAM</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>I</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>),
        <span class='kw'>PHI</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>1</span>,<span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>)
            )

<span class='co'># parameter index</span>
<span class='no'>index</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
        <span class='kw'>ALPHA</span><span class='kw'>=</span><span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>ALPHA</span>,
        <span class='kw'>NU</span><span class='kw'>=</span><span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>NU</span>,
        <span class='kw'>LAM</span><span class='kw'>=</span><span class='fl'>1</span>*<span class='no'>est</span>$<span class='no'>LAM</span>,
        <span class='kw'>PHI</span><span class='kw'>=</span><span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>PHI</span>
        )

<span class='no'>group1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>est</span><span class='kw'>=</span><span class='no'>est</span>, <span class='kw'>index</span><span class='kw'>=</span><span class='no'>index</span>, <span class='kw'>lower</span><span class='kw'>=</span><span class='no'>lower</span>)

<span class='co'>#*** group 2 and group 3</span>

<span class='co'># modify parameter index</span>
<span class='no'>index</span>$<span class='no'>ALPHA</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>+<span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>ALPHA</span>
<span class='no'>index</span>$<span class='no'>PHI</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>+<span class='fl'>0</span>*<span class='no'>est</span>$<span class='no'>PHI</span>
<span class='no'>group3</span> <span class='kw'>&lt;-</span> <span class='no'>group2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>est</span><span class='kw'>=</span><span class='no'>est</span>, <span class='kw'>index</span><span class='kw'>=</span><span class='no'>index</span>, <span class='kw'>lower</span><span class='kw'>=</span><span class='no'>lower</span>)

<span class='co'>#*** define model</span>
<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>group0</span><span class='kw'>=</span><span class='no'>group0</span>, <span class='kw'>group1</span><span class='kw'>=</span><span class='no'>group1</span>, <span class='kw'>group2</span><span class='kw'>=</span><span class='no'>group2</span>, <span class='kw'>group3</span><span class='kw'>=</span><span class='no'>group3</span>)

<span class='co'>#-- estimate model with ML </span>
<span class='no'>res1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mgsem</span>( <span class='kw'>suffstat</span><span class='kw'>=</span><span class='no'>suffstat</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model2</span>, <span class='kw'>eps_approx</span><span class='kw'>=</span><span class='fl'>1e-4</span>, <span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"ML"</span>,
                    <span class='kw'>technical</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>500</span>, <span class='kw'>optimizer</span><span class='kw'>=</span><span class='st'>"optim"</span>),
                    <span class='kw'>hessian</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>comp_se</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>trace</span><span class='kw'>=</span><span class='fl'>1</span>) )
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>res1</span>)

<span class='co'>#-- robust moment estimation with p=0.5</span>

<span class='no'>optimizer</span> <span class='kw'>&lt;-</span> <span class='st'>"optim"</span>
<span class='no'>technical</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>500</span>, <span class='kw'>optimizer</span><span class='kw'>=</span><span class='no'>optimizer</span>)
<span class='no'>eps_approx</span> <span class='kw'>&lt;-</span> <span class='fl'>1e-3</span>

<span class='no'>res2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mgsem</span>( <span class='kw'>suffstat</span><span class='kw'>=</span><span class='no'>suffstat</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>res1</span>$<span class='no'>model</span>, <span class='kw'>p_me</span><span class='kw'>=</span><span class='fl'>0.5</span>,
                    <span class='kw'>eps_approx</span><span class='kw'>=</span><span class='no'>eps_approx</span>, <span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"ME"</span>, <span class='kw'>technical</span><span class='kw'>=</span><span class='no'>technical</span>,
                    <span class='kw'>hessian</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>comp_se</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>trace</span><span class='kw'>=</span><span class='fl'>1</span>) )

<span class='co'>#---- regularized estimation</span>

<span class='no'>nu_lam</span> <span class='kw'>&lt;-</span> <span class='fl'>0.1</span>    <span class='co'># regularization parameter</span>

<span class='co'># redefine model</span>
<span class='no'>define_model</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>model</span>, <span class='no'>nu_lam</span>)
{
    <span class='no'>pen_lp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='kw'>NU</span><span class='kw'>=</span><span class='no'>nu_lam</span>+<span class='fl'>0</span>*<span class='no'>model</span>$<span class='no'>group1</span>$<span class='no'>est</span>$<span class='no'>NU</span>)
    <span class='no'>ee</span> <span class='kw'>&lt;-</span> <span class='st'>"group1"</span>
    <span class='kw'>for</span> (<span class='no'>ee</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"group1"</span>,<span class='st'>"group2"</span>,<span class='st'>"group3"</span>))
    {
        <span class='no'>model</span><span class='kw'>[[</span><span class='no'>ee</span>]]$<span class='no'>index</span>$<span class='no'>NU</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>+<span class='fl'>0</span>*<span class='no'>index</span>$<span class='no'>NU</span>
        <span class='no'>model</span><span class='kw'>[[</span><span class='no'>ee</span>]]$<span class='no'>pen_lp</span> <span class='kw'>&lt;-</span> <span class='no'>pen_lp</span>
    }
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>model</span>)
}

<span class='no'>model3</span> <span class='kw'>&lt;-</span> <span class='fu'>define_model</span>(<span class='kw'>model</span><span class='kw'>=</span><span class='no'>model</span>, <span class='kw'>nu_lam</span><span class='kw'>=</span><span class='no'>nu_lam</span>)
<span class='no'>pen_type</span> <span class='kw'>&lt;-</span> <span class='st'>"scad"</span>

<span class='no'>res3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mgsem</span>( <span class='kw'>suffstat</span><span class='kw'>=</span><span class='no'>suffstat</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>model3</span>, <span class='kw'>p_pen</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>pen_type</span><span class='kw'>=</span><span class='no'>pen_type</span>,
                    <span class='kw'>eps_approx</span><span class='kw'>=</span><span class='no'>eps_approx</span>, <span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"ML"</span>,
                    <span class='kw'>technical</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>500</span>, <span class='kw'>optimizer</span><span class='kw'>=</span><span class='st'>"optim"</span>),
                    <span class='kw'>hessian</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>comp_se</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>trace</span><span class='kw'>=</span><span class='fl'>1</span>) )
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>res3</span>)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


