<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimates a multiple-group structural equation model. The function allows arbitrary
prior distributions on model parameters and regularized estimation with the SCAD and
the LASSO penalty. Moreover, it can also conduct robust moment estimation using
the \(L_p\) loss function \(\rho(x)=|x|^p\) for \(p \ge 0\).
See Robitzsch (2023) for more details."><title>Estimation of Multiple-Group Structural Equation Models — mgsem • sirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimation of Multiple-Group Structural Equation Models — mgsem"><meta property="og:description" content="Estimates a multiple-group structural equation model. The function allows arbitrary
prior distributions on model parameters and regularized estimation with the SCAD and
the LASSO penalty. Moreover, it can also conduct robust moment estimation using
the \(L_p\) loss function \(\rho(x)=|x|^p\) for \(p \ge 0\).
See Robitzsch (2023) for more details."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.2</small

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexanderrobitzsch/sirt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimation of Multiple-Group Structural Equation Models</h1>
      
      <div class="d-none name"><code>mgsem.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates a multiple-group structural equation model. The function allows arbitrary
prior distributions on model parameters and regularized estimation with the SCAD and
the LASSO penalty. Moreover, it can also conduct robust moment estimation using
the \(L_p\) loss function \(\rho(x)=|x|^p\) for \(p \ge 0\).
See Robitzsch (2023) for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mgsem</span><span class="op">(</span><span class="va">suffstat</span>, <span class="va">model</span>, data<span class="op">=</span><span class="cn">NULL</span>, group<span class="op">=</span><span class="cn">NULL</span>, weights<span class="op">=</span><span class="cn">NULL</span>, estimator<span class="op">=</span><span class="st">"ML"</span>,</span>
<span>     p_me<span class="op">=</span><span class="fl">2</span>, p_pen<span class="op">=</span><span class="fl">1</span>, pen_type<span class="op">=</span><span class="st">"scad"</span>, diffpar_pen<span class="op">=</span><span class="cn">NULL</span>, pen_sample_size<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>     a_scad<span class="op">=</span><span class="fl">3.7</span>, eps_approx<span class="op">=</span><span class="fl">0.001</span>, comp_se<span class="op">=</span><span class="cn">TRUE</span>, se_delta_formula<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>     prior_list<span class="op">=</span><span class="cn">NULL</span>, hessian<span class="op">=</span><span class="cn">TRUE</span>, fixed_parms<span class="op">=</span><span class="cn">FALSE</span>, cd<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>     cd_control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxiter<span class="op">=</span><span class="fl">20</span>, tol<span class="op">=</span><span class="fl">5</span><span class="op">*</span><span class="fl">1e-04</span>, interval_length<span class="op">=</span><span class="fl">0.05</span>, method<span class="op">=</span><span class="st">"exact"</span><span class="op">)</span>,</span>
<span>     partable_start<span class="op">=</span><span class="cn">NULL</span>, num_approx<span class="op">=</span><span class="cn">FALSE</span>, technical<span class="op">=</span><span class="cn">NULL</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>suffstat</dt>
<dd><p>List containing sufficient statistics</p></dd>

  <dt>model</dt>
<dd><p>Model specification, see examples. Can have entries <code>est</code>, <code>index</code>,
<code>lower</code>, <code>upper</code>, <code>prior</code>, <code>pen_l2</code>, <code>pen_lp</code>,
<code>pen_difflp</code>. Each entry can be defined for model matrices <code>ALPHA</code>,
<code>NU</code>, <code>LAM</code>, <code>PHI</code>, and <code>PSI</code>.</p></dd>

  <dt>data</dt>
<dd><p>Optional data frame</p></dd>

  <dt>group</dt>
<dd><p>Optional vector of group identifiers</p></dd>

  <dt>weights</dt>
<dd><p>Optional vector of sampling weights</p></dd>

  <dt>estimator</dt>
<dd><p>Character. Can be either <code>"ML"</code> for maximum likelihood fitting function or
<code>"ME"</code> for robust moment estimation.</p></dd>

  <dt>p_me</dt>
<dd><p>Power in $L_p$ loss function for robust moment estimation</p></dd>

  <dt>p_pen</dt>
<dd><p>Power for penalty in regularized estimation. For regular LASSO and SCAD penalty
functions, it is $p=1$.</p></dd>

  <dt>pen_type</dt>
<dd><p>Penalty type. Can be either <code>"scad"</code> or <code>"lasso"</code>.</p></dd>

  <dt>diffpar_pen</dt>
<dd><p>List containing values of regularization parameters in fused lasso estimation</p></dd>

  <dt>pen_sample_size</dt>
<dd><p>List containing values for sample sizes for regularized estimation</p></dd>

  <dt>a_scad</dt>
<dd><p>Parameter $a$ used in SCAD penalty</p></dd>

  <dt>eps_approx</dt>
<dd><p>Approximation value for nondifferentiable robust moment fitting function or
penalty function</p></dd>

  <dt>comp_se</dt>
<dd><p>Logical indicating whether standard errors should be computed</p></dd>

  <dt>se_delta_formula</dt>
<dd><p>Logical indicating whether standard errors should be computed according to the
delta formula</p></dd>

  <dt>prior_list</dt>
<dd><p>List containing specifications of the prior distributions</p></dd>

  <dt>hessian</dt>
<dd><p>Logical indicating whether the Hessian matrix should be computed</p></dd>

  <dt>fixed_parms</dt>
<dd><p>Logical indicating whether all model parameters should be fixed</p></dd>

  <dt>cd</dt>
<dd><p>Logical indicating whether coordinate descent should be used for estimation</p></dd>

  <dt>cd_control</dt>
<dd><p>Control parameters for coordinate descent estimation</p></dd>

  <dt>partable_start</dt>
<dd><p>Starting values for parameter estimation</p></dd>

  <dt>num_approx</dt>
<dd><p>Logical indicating whether derivatives should be computed based on numerical
differentiation</p></dd>

  <dt>technical</dt>
<dd><p>Parameters used for optimization in <code>sirt_optimizer</code></p></dd>

  <dt>control</dt>
<dd><p>Control paramaters for optimization</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>[MORE INFORMATION TO BE ADDED]</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with following values</p>
<dl><dt>coef</dt>
<dd><p>Coeffients</p></dd>

<dt>vcov</dt>
<dd><p>Variance matrix</p></dd>

<dt>se</dt>
<dd><p>Vector of standard errors</p></dd>

<dt>partable</dt>
<dd><p>Parameter table</p></dd>

<dt>model</dt>
<dd><p>Specified model</p></dd>

<dt>opt_res</dt>
<dd><p>Result from optimization</p></dd>

<dt>opt_value</dt>
<dd><p>Value of fitting function</p></dd>

<dt>residuals</dt>
<dd><p>Residuals of sufficient statistics</p></dd>

<dt>ic</dt>
<dd><p>Information criteria</p></dd>

<dt>technical</dt>
<dd><p>Specifications of optimizer</p></dd>

<dt>suffstat_vcov</dt>
<dd><p>Variance matrix of sufficient statistics</p></dd>

<dt>me_delta_method</dt>
<dd><p>Input and output matrices for delta method if
<code>estimator="ME"</code></p></dd>

<dt>data_proc</dt>
<dd><p>Processed data</p></dd>

<dt>case_ll</dt>
<dd><p>Casewise log-likelihood function</p></dd>

<dt>...</dt>
<dd><p>Further values</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Robitzsch, A. (2023). Model-robust estimation of multiple-group structural
equation models. <em>Algorithms, 16</em>(4), 210. <a href="https://doi.org/10.3390/a16040210" class="external-link">doi:10.3390/a16040210</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 1: Noninvariant item intercepts in a multiple-group SEM</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="co">#---- simulate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">65</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># number of groups</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">5</span>  <span class="co"># number of items</span></span>
<span><span class="co"># define lambda and nu parameters</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="va">G</span>, ncol<span class="op">=</span><span class="va">I</span><span class="op">)</span></span>
<span><span class="va">nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="va">G</span>, ncol<span class="op">=</span><span class="va">I</span><span class="op">)</span></span>
<span><span class="va">err_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="va">G</span>, ncol<span class="op">=</span><span class="va">I</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define extent of noninvariance</span></span>
<span><span class="va">dif_int</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span></span>
<span><span class="co">#- 1st group: N(0,1)</span></span>
<span><span class="va">nu</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dif_int</span></span>
<span><span class="co">#- 2nd group: N(0.3,1.5)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fl">2</span> ;</span>
<span><span class="va">nu</span><span class="op">[</span><span class="va">gg</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">dif_int</span></span>
<span><span class="co">#- 3nd group: N(.8,1.2)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">nu</span><span class="op">[</span><span class="va">gg</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">dif_int</span></span>
<span><span class="co">#- define distributions of groups</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.3</span>,<span class="fl">.8</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1.5</span>,<span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">3</span><span class="op">)</span> <span class="co"># sample sizes per group</span></span>
<span></span>
<span><span class="va">exact</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">suffstat</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="invariance.alignment.html">invariance_alignment_simulate</a></span><span class="op">(</span><span class="va">nu</span>, <span class="va">lambda</span>, <span class="va">err_var</span>, <span class="va">mu</span>, <span class="va">sigma</span>, <span class="va">N</span>,</span>
<span>                output<span class="op">=</span><span class="st">"suffstat"</span>, groupwise<span class="op">=</span><span class="cn">TRUE</span>, exact<span class="op">=</span><span class="va">exact</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#---- model specification</span></span>
<span></span>
<span><span class="co"># model specifications joint group</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        ALPHA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        NU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">0</span>, nrow<span class="op">=</span><span class="va">I</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        LAM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow<span class="op">=</span><span class="va">I</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        PHI<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">1</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        PSI<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">I</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span><span class="co"># parameter index</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        ALPHA<span class="op">=</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">ALPHA</span>,</span>
<span>        NU<span class="op">=</span><span class="fl">1</span><span class="op">+</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">NU</span>,</span>
<span>        LAM<span class="op">=</span><span class="fl">1</span><span class="op">+</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">LAM</span>,</span>
<span>        PHI<span class="op">=</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">PHI</span>,</span>
<span>        PSI<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">I</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span><span class="co"># lower bounds</span></span>
<span><span class="va">lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        PSI<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="va">I</span><span class="op">)</span><span class="op">)</span>, PHI<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** joint parameters</span></span>
<span><span class="va">group0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est<span class="op">=</span><span class="va">est</span>, index<span class="op">=</span><span class="va">index</span>, lower<span class="op">=</span><span class="va">lower</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** group1</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        ALPHA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        NU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">0</span>, nrow<span class="op">=</span><span class="va">I</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        LAM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="va">I</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        PHI<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">1</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span></span>
<span><span class="co"># parameter index</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        ALPHA<span class="op">=</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">ALPHA</span>,</span>
<span>        NU<span class="op">=</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">NU</span>,</span>
<span>        LAM<span class="op">=</span><span class="fl">1</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">LAM</span>,</span>
<span>        PHI<span class="op">=</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">PHI</span></span>
<span>        <span class="op">)</span></span>
<span></span>
<span><span class="va">group1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est<span class="op">=</span><span class="va">est</span>, index<span class="op">=</span><span class="va">index</span>, lower<span class="op">=</span><span class="va">lower</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** group 2 and group 3</span></span>
<span></span>
<span><span class="co"># modify parameter index</span></span>
<span><span class="va">index</span><span class="op">$</span><span class="va">ALPHA</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">+</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">ALPHA</span></span>
<span><span class="va">index</span><span class="op">$</span><span class="va">PHI</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">+</span><span class="fl">0</span><span class="op">*</span><span class="va">est</span><span class="op">$</span><span class="va">PHI</span></span>
<span><span class="va">group3</span> <span class="op">&lt;-</span> <span class="va">group2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>est<span class="op">=</span><span class="va">est</span>, index<span class="op">=</span><span class="va">index</span>, lower<span class="op">=</span><span class="va">lower</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** define model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group0<span class="op">=</span><span class="va">group0</span>, group1<span class="op">=</span><span class="va">group1</span>, group2<span class="op">=</span><span class="va">group2</span>, group3<span class="op">=</span><span class="va">group3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#-- estimate model with ML</span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">mgsem</span><span class="op">(</span> suffstat<span class="op">=</span><span class="va">suffstat</span>, model<span class="op">=</span><span class="va">model2</span>, eps_approx<span class="op">=</span><span class="fl">1e-4</span>, estimator<span class="op">=</span><span class="st">"ML"</span>,</span>
<span>                    technical<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxiter<span class="op">=</span><span class="fl">500</span>, optimizer<span class="op">=</span><span class="st">"optim"</span><span class="op">)</span>,</span>
<span>                    hessian<span class="op">=</span><span class="cn">FALSE</span>, comp_se<span class="op">=</span><span class="cn">FALSE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#-- robust moment estimation with p=0.5</span></span>
<span></span>
<span><span class="va">optimizer</span> <span class="op">&lt;-</span> <span class="st">"optim"</span></span>
<span><span class="va">technical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxiter<span class="op">=</span><span class="fl">500</span>, optimizer<span class="op">=</span><span class="va">optimizer</span><span class="op">)</span></span>
<span><span class="va">eps_approx</span> <span class="op">&lt;-</span> <span class="fl">1e-3</span></span>
<span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">mgsem</span><span class="op">(</span> suffstat<span class="op">=</span><span class="va">suffstat</span>, model<span class="op">=</span><span class="va">res1</span><span class="op">$</span><span class="va">model</span>, p_me<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>                    eps_approx<span class="op">=</span><span class="va">eps_approx</span>, estimator<span class="op">=</span><span class="st">"ME"</span>, technical<span class="op">=</span><span class="va">technical</span>,</span>
<span>                    hessian<span class="op">=</span><span class="cn">FALSE</span>, comp_se<span class="op">=</span><span class="cn">FALSE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#---- regularized estimation</span></span>
<span></span>
<span><span class="va">nu_lam</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>    <span class="co"># regularization parameter</span></span>
<span></span>
<span><span class="co"># redefine model</span></span>
<span><span class="va">define_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">nu_lam</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>    <span class="va">pen_lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> NU<span class="op">=</span><span class="va">nu_lam</span><span class="op">+</span><span class="fl">0</span><span class="op">*</span><span class="va">model</span><span class="op">$</span><span class="va">group1</span><span class="op">$</span><span class="va">est</span><span class="op">$</span><span class="va">NU</span><span class="op">)</span></span>
<span>    <span class="va">ee</span> <span class="op">&lt;-</span> <span class="st">"group1"</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">ee</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group1"</span>,<span class="st">"group2"</span>,<span class="st">"group3"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">{</span></span>
<span>        <span class="va">model</span><span class="op">[[</span><span class="va">ee</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">index</span><span class="op">$</span><span class="va">NU</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">+</span><span class="fl">0</span><span class="op">*</span><span class="va">index</span><span class="op">$</span><span class="va">NU</span></span>
<span>        <span class="va">model</span><span class="op">[[</span><span class="va">ee</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pen_lp</span> <span class="op">&lt;-</span> <span class="va">pen_lp</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu">define_model</span><span class="op">(</span>model<span class="op">=</span><span class="va">model</span>, nu_lam<span class="op">=</span><span class="va">nu_lam</span><span class="op">)</span></span>
<span><span class="va">pen_type</span> <span class="op">&lt;-</span> <span class="st">"scad"</span></span>
<span></span>
<span><span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">mgsem</span><span class="op">(</span> suffstat<span class="op">=</span><span class="va">suffstat</span>, model<span class="op">=</span><span class="va">model3</span>, p_pen<span class="op">=</span><span class="fl">1</span>, pen_type<span class="op">=</span><span class="va">pen_type</span>,</span>
<span>                    eps_approx<span class="op">=</span><span class="va">eps_approx</span>, estimator<span class="op">=</span><span class="st">"ML"</span>,</span>
<span>                    technical<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxiter<span class="op">=</span><span class="fl">500</span>, optimizer<span class="op">=</span><span class="st">"optim"</span><span class="op">)</span>,</span>
<span>                    hessian<span class="op">=</span><span class="cn">FALSE</span>, comp_se<span class="op">=</span><span class="cn">FALSE</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res3</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

