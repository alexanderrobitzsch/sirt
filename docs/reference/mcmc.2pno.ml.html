<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Random Item Response Model / Multilevel IRT Model — mcmc.2pno.ml • sirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Random Item Response Model / Multilevel IRT Model — mcmc.2pno.ml" />
<meta property="og:description" content="This function enables the estimation of random item models and multilevel
(or hierarchical) IRT models (Chaimongkol, Huffer &amp;amp; Kamata, 2007;
Fox &amp;amp; Verhagen, 2010; van den Noortgate, de Boeck &amp;amp; Meulders, 2003;
Asparouhov &amp;amp; Muthen, 2012; Muthen &amp;amp; Asparouhov, 2013, 2014).
Dichotomous response data is supported using a probit link. Normally
distributed responses can also be analyzed.
See Details for a description of the implemented item
response models." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.11-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Random Item Response Model / Multilevel IRT Model</h1>
    
    <div class="hidden name"><code>mcmc.2pno.ml.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function enables the estimation of random item models and multilevel
(or hierarchical) IRT models (Chaimongkol, Huffer &amp; Kamata, 2007;
Fox &amp; Verhagen, 2010; van den Noortgate, de Boeck &amp; Meulders, 2003;
Asparouhov &amp; Muthen, 2012; Muthen &amp; Asparouhov, 2013, 2014).
Dichotomous response data is supported using a probit link. Normally
distributed responses can also be analyzed.
See Details for a description of the implemented item
response models.</p>
    </div>

    <pre class="usage"><span class='fu'>mcmc.2pno.ml</span>(<span class='no'>dat</span>, <span class='no'>group</span>, <span class='kw'>link</span><span class='kw'>=</span><span class='st'>"logit"</span>, <span class='kw'>est.b.M</span><span class='kw'>=</span><span class='st'>"h"</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"n"</span>,
    <span class='kw'>est.a.M</span><span class='kw'>=</span><span class='st'>"f"</span>, <span class='kw'>est.a.Var</span><span class='kw'>=</span><span class='st'>"n"</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>500</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='fl'>1000</span>,
    <span class='kw'>N.sampvalues</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>progress.iter</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>prior.sigma2</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>0.4</span>),
    <span class='kw'>prior.sigma.b</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>), <span class='kw'>prior.sigma.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>), <span class='kw'>prior.omega.b</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>),
    <span class='kw'>prior.omega.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>0.4</span>), <span class='kw'>sigma.b.init</span><span class='kw'>=</span><span class='fl'>.3</span> )</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>Data frame with item responses.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Vector of group identifiers (e.g. classes, schools or countries)</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>Link function. Choices are <code>"logit"</code> for dichotomous data
    and <code>"normal"</code> for data under normal distribution assumptions</p></td>
    </tr>
    <tr>
      <th>est.b.M</th>
      <td><p>Estimation type of \(b_i\) parameters: <br /> <code>n</code> - non-hierarchical prior
distribution, i.e. \(\omega_b\) is set to a very high value and is not
estimated <br /> <code>h</code> - hierarchical prior distribution with estimated
distribution parameters \(\mu_b\) and \(\omega_b\)</p></td>
    </tr>
    <tr>
      <th>est.b.Var</th>
      <td><p>Estimation type of standard deviations of item difficulties \(b_i\). <br />
<code>n</code> -- no estimation of the item variance, i.e. \(\sigma_{b,i}\) is
assumed to be zero <br />
<code>i</code> -- item-specific standard deviation of item difficulties <br />
<code>j</code> -- a joint standard deviation of all item difficulties is estimated,
i.e. \(\sigma_{b,1}=\ldots=\sigma_{b,I}=\sigma_b\)</p></td>
    </tr>
    <tr>
      <th>est.a.M</th>
      <td><p>Estimation type of \(a_i\) parameters: <br />
<code>f</code> - no estimation of item slopes, i.e all item slopes \(a_i\) are
fixed at one <br />
<code>n</code> - non-hierarchical prior distribution, i.e. \(\omega_a=0\) <br />
<code>h</code> - hierarchical prior distribution with estimated
distribution parameter \(\omega_a\)</p></td>
    </tr>
    <tr>
      <th>est.a.Var</th>
      <td><p>Estimation type of standard deviations of item slopes \(a_i\). <br />
<code>n</code> -- no estimation of the item variance <br />
<code>i</code> -- item-specific standard deviation of item slopes <br />
<code>j</code> -- a joint standard deviation of all item slopes is estimated,
i.e. \(\sigma_{a,1}=\ldots=\sigma_{a,I}=\sigma_a\)</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>Number of burnin iterations</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>Total number of iterations</p></td>
    </tr>
    <tr>
      <th>N.sampvalues</th>
      <td><p>Maximum number of sampled values to save</p></td>
    </tr>
    <tr>
      <th>progress.iter</th>
      <td><p>Display progress every <code>progress.iter</code>-th iteration. If no progress
   display is wanted, then choose <code>progress.iter</code> larger than <code>iter</code>.</p></td>
    </tr>
    <tr>
      <th>prior.sigma2</th>
      <td><p>Prior for Level 2 standard deviation \(\sigma_{L2}\)</p></td>
    </tr>
    <tr>
      <th>prior.sigma.b</th>
      <td><p>Priors for item difficulty standard deviations \(\sigma_{b,i}\)</p></td>
    </tr>
    <tr>
      <th>prior.sigma.a</th>
      <td><p>Priors for item difficulty standard deviations \(\sigma_{a,i}\)</p></td>
    </tr>
    <tr>
      <th>prior.omega.b</th>
      <td><p>Prior for \(\omega_b\)</p></td>
    </tr>
    <tr>
      <th>prior.omega.a</th>
      <td><p>Prior for \(\omega_a\)</p></td>
    </tr>
    <tr>
      <th>sigma.b.init</th>
      <td><p>Initial standard deviation for \(\sigma_{b,i}\) parameters</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For dichotomous item responses (<code>link="logit"</code>) of persons \(p\) in
group \(j\) on
item \(i\), the probability of a correct response is defined as
$$P( X_{pji}=1 | \theta_{pj} )=\Phi ( a_{ij} \theta_{pj} - b_{ij} )$$
The ability \(\theta_{pj}\) is decomposed into a Level 1 and a Level 2
effect $$\theta_{pj}=u_j + e_{pj} \quad, \quad
    u_j \sim N ( 0, \sigma_{L2}^2 ) \quad, \quad
    e_{pj} \sim N ( 0, \sigma_{L1}^2 ) $$
In a multilevel IRT model (or a random item model), item parameters are
allowed to vary across groups:
$$ b_{ij} \sim N( b_i, \sigma^2_{b,i} ) \quad, \quad
    a_{ij} \sim N( a_i, \sigma^2_{a,i} ) $$
In a hierarchical IRT model, a hierarchical distribution of the (main)
item parameters is assumed
$$ b_{i} \sim N( \mu_b, \omega^2_{b} ) \quad, \quad
    a_{i} \sim N( 1, \omega^2_{a} ) $$
Note that for identification purposes, the mean of all item slopes \(a_i\)
is set to one. Using the arguments <code>est.b.M</code>, <code>est.b.Var</code>,
<code>est.a.M</code> and <code>est.a.Var</code> defines which variance components
should be estimated.</p>
<p>For normally distributed item responses (<code>link="normal"</code>), the model
equations remain the same except the item response model which is now written as
$$ X_{pji}=a_{ij} \theta_{pj} - b_{ij} + \varepsilon_{pji} \quad,
\quad \varepsilon_{pji} \sim N( 0, \sigma^2_{res,i} ) $$</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>mcmc.sirt</code> with following entries:</p>
<dt>mcmcobj</dt><dd><p>Object of class <code>mcmc.list</code></p></dd>
  <dt>summary.mcmcobj</dt><dd><p>Summary of the <code>mcmcobj</code> object. In this
  summary the Rhat statistic and the mode estimate MAP is included.
  The variable <code>PercSEratio</code> indicates the proportion of the Monte Carlo
  standard error in relation to the total standard deviation of the
  posterior distribution.</p></dd>
  <dt>ic</dt><dd><p>Information criteria (DIC)</p></dd>
  <dt>burnin</dt><dd><p>Number of burnin iterations</p></dd>
  <dt>iter</dt><dd><p>Total number of iterations</p></dd>
  <dt>theta.chain</dt><dd><p>Sampled values of \(\theta_{pj}\) parameters</p></dd>
  <dt>theta.chain</dt><dd><p>Sampled values of \(u_{j}\) parameters</p></dd>
  <dt>deviance.chain</dt><dd><p>Sampled values of Deviance values</p></dd>
  <dt>EAP.rel</dt><dd><p>EAP reliability</p></dd>
  <dt>person</dt><dd><p>Data frame with EAP person parameter estimates for
        \(\theta_pj\) and their corresponding posterior standard
      deviations</p></dd>
  <dt>dat</dt><dd><p>Used data frame</p></dd>
  <dt>...</dt><dd><p>Further values</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Asparouhov, T. &amp; Muthen, B. (2012). General random effect latent variable
modeling: Random subjects, items, contexts, and parameters.
<em>http://www.statmodel.com/papers_date.shtml</em>.</p>
<p>Chaimongkol, S., Huffer, F. W., &amp; Kamata, A. (2007).
An explanatory differential item functioning (DIF)
model by the WinBUGS 1.4.
<em>Songklanakarin Journal of Science and Technology, 29</em>, 449-458.</p>
<p>Fox, J.-P., &amp; Verhagen, A.-J. (2010). Random item effects modeling for
cross-national survey data.
In E. Davidov, P. Schmidt, &amp; J. Billiet (Eds.),
<em>Cross-cultural Analysis: Methods and Applications</em>
(pp. 467-488), London: Routledge Academic.</p>
<p>Muthen, B. &amp; Asparouhov, T. (2013). New methods for the study of measurement
invariance with many groups. <em>http://www.statmodel.com/papers_date.shtml</em></p>
<p>Muthen, B. &amp; Asparouhov, T. (2014).
Item response modeling in Mplus: A multi-dimensional, multi-level,
and multi-timepoint example. In W. Linden &amp; R. Hambleton (2014).
<em>Handbook of item response theory: Models, statistical tools, and
applications</em>. <em>http://www.statmodel.com/papers_date.shtml</em></p>
<p>van den Noortgate, W., De Boeck, P., &amp; Meulders, M. (2003).
Cross-classification multilevel logistic models in psychometrics.
<em>Journal of Educational and Behavioral Statistics, 28</em>, 369-386.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>S3 methods: <code><a href='summary.mcmc.sirt.html'>summary.mcmc.sirt</a></code>, <code><a href='plot.mcmc.sirt.html'>plot.mcmc.sirt</a></code></p>
<p>For MCMC estimation of three-parameter (testlet) models see
<code><a href='mcmc.3pno.testlet.html'>mcmc.3pno.testlet</a></code>.</p>
<p>See also the <span class="pkg">MLIRT</span> package (http://www.jean-paulfox.com).</p>
<p>For more flexible estimation of multilevel IRT models see the
<span class="pkg">MCMCglmm</span> and <span class="pkg">lme4</span> packages.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Dataset Multilevel data.ml1 - dichotomous items</span>
<span class='co'>#############################################################################</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.ml1</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.ml1</span>[,-<span class='fl'>1</span>]
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='no'>data.ml1</span>$<span class='no'>group</span>
<span class='co'># just for a try use a very small number of iterations</span>
<span class='no'>burnin</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span> ; <span class='no'>iter</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>

<span class='co'>#***</span>
<span class='co'># Model 1: 1PNO with no cluster item effects</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='no'>dat</span>, <span class='no'>group</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"n"</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)    <span class='co'># summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod1</span>,<span class='kw'>layout</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>ask</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'># plot results</span>
<span class='co'># write results to coda file</span>
<span class='fu'><a href='mcmclist2coda.html'>mcmclist2coda</a></span>( <span class='no'>mod1</span>$<span class='no'>mcmcobj</span>, <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"data.ml1_mod1"</span> )

<span class='co'>#***</span>
<span class='co'># Model 2: 1PNO with cluster item effects of item difficulties</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='no'>dat</span>, <span class='no'>group</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"i"</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod2</span>, <span class='kw'>ask</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>layout</span><span class='kw'>=</span><span class='fl'>2</span> )

<span class='co'>#***</span>
<span class='co'># Model 3: 2PNO with cluster item effects of item difficulties but</span>
<span class='co'>#          joint item slopes</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='no'>dat</span>, <span class='no'>group</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"i"</span>, <span class='kw'>est.a.M</span><span class='kw'>=</span><span class='st'>"h"</span>,
              <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'>#***</span>
<span class='co'># Model 4: 2PNO with cluster item effects of item difficulties and</span>
<span class='co'>#          cluster item effects with a jointly estimated SD</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='no'>dat</span>, <span class='no'>group</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"i"</span>, <span class='kw'>est.a.M</span><span class='kw'>=</span><span class='st'>"h"</span>,
                <span class='kw'>est.a.Var</span><span class='kw'>=</span><span class='st'>"j"</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 2: Dataset Multilevel data.ml2 - polytomous items</span>
<span class='co'>#            assuming a normal distribution for polytomous items</span>
<span class='co'>#############################################################################</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.ml2</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.ml2</span>[,-<span class='fl'>1</span>]
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='no'>data.ml2</span>$<span class='no'>group</span>
<span class='co'># set iterations for all examples (too few!!)</span>
<span class='no'>burnin</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span> ; <span class='no'>iter</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span>

<span class='co'>#***</span>
<span class='co'># Model 1: no intercept variance, no slopes</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"n"</span>,
             <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span>, <span class='kw'>link</span><span class='kw'>=</span><span class='st'>"normal"</span>,  <span class='kw'>progress.iter</span><span class='kw'>=</span><span class='fl'>20</span>  )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#***</span>
<span class='co'># Model 2a: itemwise intercept variance, no slopes</span>
<span class='no'>mod2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"i"</span>,
            <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span>,<span class='kw'>link</span><span class='kw'>=</span><span class='st'>"normal"</span>,  <span class='kw'>progress.iter</span><span class='kw'>=</span><span class='fl'>20</span>  )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2a</span>)

<span class='co'>#***</span>
<span class='co'># Model 2b: homogeneous intercept variance, no slopes</span>
<span class='no'>mod2b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"j"</span>,
              <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span>,<span class='kw'>link</span><span class='kw'>=</span><span class='st'>"normal"</span>,  <span class='kw'>progress.iter</span><span class='kw'>=</span><span class='fl'>20</span>  )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2b</span>)

<span class='co'>#***</span>
<span class='co'># Model 3: intercept variance and slope variances</span>
<span class='co'>#          hierarchical item and slope parameters</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>,
               <span class='kw'>est.b.M</span><span class='kw'>=</span><span class='st'>"h"</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"i"</span>, <span class='kw'>est.a.M</span><span class='kw'>=</span><span class='st'>"h"</span>, <span class='kw'>est.a.Var</span><span class='kw'>=</span><span class='st'>"i"</span>,
               <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span>,<span class='kw'>link</span><span class='kw'>=</span><span class='st'>"normal"</span>,  <span class='kw'>progress.iter</span><span class='kw'>=</span><span class='fl'>20</span>  )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 3: Simulated random effects model | dichotomous items</span>
<span class='co'>#############################################################################</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>7698</span>)

<span class='co'>#*** model parameters</span>
<span class='no'>sig2.lev2</span> <span class='kw'>&lt;-</span> <span class='fl'>.3</span>^<span class='fl'>2</span>   <span class='co'># theta level 2 variance</span>
<span class='no'>sig2.lev1</span> <span class='kw'>&lt;-</span> <span class='fl'>.8</span>^<span class='fl'>2</span>   <span class='co'># theta level 1 variance</span>
<span class='no'>G</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>            <span class='co'># number of groups</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>20</span>             <span class='co'># number of persons within a group</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>12</span>             <span class='co'># number of items</span>
<span class='co'>#*** simuate theta</span>
<span class='no'>theta2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>G</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>sig2.lev2</span>) )
<span class='no'>theta1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>n</span>*<span class='no'>G</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>sig2.lev1</span>) )
<span class='no'>theta</span>  <span class='kw'>&lt;-</span> <span class='no'>theta1</span> + <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='no'>theta2</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='no'>n</span> )
<span class='co'>#*** item difficulties</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( -<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span> )
<span class='co'>#*** define group identifier</span>
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span> + <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='no'>G</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='no'>n</span> )
<span class='co'>#*** SD of group specific difficulties for items 3 and 5</span>
<span class='no'>sigma.item</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='no'>I</span>)
<span class='no'>sigma.item</span>[<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>5</span>)] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='co'>#*** simulate group specific item difficulties</span>
<span class='no'>b.class</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>( <span class='no'>sigma.item</span>, <span class='kw'>FUN</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>sii</span>){ <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>G</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='no'>sii</span> ) } )
<span class='no'>b.class</span> <span class='kw'>&lt;-</span> <span class='no'>b.class</span>[ <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fl'>1</span>:<span class='no'>G</span>,<span class='kw'>each</span><span class='kw'>=</span><span class='no'>n</span> ), ]
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='no'>b</span>, <span class='no'>n</span>*<span class='no'>G</span>, <span class='no'>I</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span> ) + <span class='no'>b.class</span>
<span class='co'>#*** simulate item responses</span>
<span class='no'>m1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>pnorm</a></span>( <span class='no'>theta</span> - <span class='no'>b</span> )
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> * ( <span class='no'>m1</span> <span class='kw'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>( <span class='no'>n</span>*<span class='no'>G</span>*<span class='no'>I</span> ), <span class='no'>n</span>*<span class='no'>G</span>, <span class='no'>I</span> ) )

<span class='co'>#*** estimate model</span>
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>mcmc.2pno.ml</span>( <span class='no'>dat</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='no'>burnin</span>, <span class='kw'>iter</span><span class='kw'>=</span><span class='no'>iter</span>,
            <span class='kw'>est.b.M</span><span class='kw'>=</span><span class='st'>"n"</span>, <span class='kw'>est.b.Var</span><span class='kw'>=</span><span class='st'>"i"</span>, <span class='kw'>progress.iter</span><span class='kw'>=</span><span class='fl'>20</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod</span>, <span class='kw'>layout</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>ask</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


