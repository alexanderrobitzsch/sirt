<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Approximates individual likelihood functions \(L(\bold{X}_p | \theta)\)
by normal distributions (see Mislevy, 1990). Extreme response patterns
are handled by adding pseudo-observations of items with extreme item
difficulties (see argument extreme.item. The individual standard
deviations of the likelihood, used in the normal approximation, can be
modified by individual adjustment factors which are specified in adjfac.
In addition, a reliability of the adjusted likelihood can be specified
in target.EAP.rel."><title>Adjustment and Approximation of Individual Likelihood Functions — likelihood.adjustment • sirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adjustment and Approximation of Individual Likelihood Functions — likelihood.adjustment"><meta property="og:description" content="Approximates individual likelihood functions \(L(\bold{X}_p | \theta)\)
by normal distributions (see Mislevy, 1990). Extreme response patterns
are handled by adding pseudo-observations of items with extreme item
difficulties (see argument extreme.item. The individual standard
deviations of the likelihood, used in the normal approximation, can be
modified by individual adjustment factors which are specified in adjfac.
In addition, a reliability of the adjusted likelihood can be specified
in target.EAP.rel."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.2</small

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexanderrobitzsch/sirt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Adjustment and Approximation of Individual Likelihood Functions</h1>
      
      <div class="d-none name"><code>likelihood.adjustment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Approximates individual likelihood functions \(L(\bold{X}_p | \theta)\)
by normal distributions (see Mislevy, 1990). Extreme response patterns
are handled by adding pseudo-observations of items with extreme item
difficulties (see argument <code>extreme.item</code>. The individual standard
deviations of the likelihood, used in the normal approximation, can be
modified by individual adjustment factors which are specified in <code>adjfac</code>.
In addition, a reliability of the adjusted likelihood can be specified
in <code>target.EAP.rel</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">likelihood.adjustment</span><span class="op">(</span><span class="va">likelihood</span>, theta<span class="op">=</span><span class="cn">NULL</span>, prob.theta<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     adjfac<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">likelihood</span><span class="op">)</span><span class="op">)</span>, extreme.item<span class="op">=</span><span class="fl">5</span>, target.EAP.rel<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     min_tuning<span class="op">=</span><span class="fl">0.2</span>, max_tuning<span class="op">=</span><span class="fl">3</span>, maxiter<span class="op">=</span><span class="fl">100</span>, conv<span class="op">=</span><span class="fl">1e-04</span>,</span>
<span>     trait.normal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>likelihood</dt>
<dd><p>A matrix containing the individual likelihood \(L(\bold{X}_p | \theta)\) or
an object of class <code>IRT.likelihood</code>.</p></dd>

  <dt>theta</dt>
<dd><p>Optional vector of (unidimensional) \(\theta\) values</p></dd>

  <dt>prob.theta</dt>
<dd><p>Optional vector of probabilities of \(\theta\) trait distribution</p></dd>

  <dt>adjfac</dt>
<dd><p>Vector with individual adjustment factors of the standard deviations of the
likelihood</p></dd>

  <dt>extreme.item</dt>
<dd><p>Item difficulties of two extreme pseudo items which are added as additional
observed data to the likelihood. A large number (e.g. <code>extreme.item=15</code>)
leaves the likelihood almost unaffected. See also Mislevy (1990).</p></dd>

  <dt>target.EAP.rel</dt>
<dd><p>Target EAP reliability. An additional tuning parameter is estimated
which adjusts the likelihood to obtain a pre-specified reliability.</p></dd>

  <dt>min_tuning</dt>
<dd><p>Minimum value of tuning parameter (if <code>! is.null(target.EAP.rel) </code>)</p></dd>

  <dt>max_tuning</dt>
<dd><p>Maximum value of tuning parameter (if <code>! is.null(target.EAP.rel) </code>)</p></dd>

  <dt>maxiter</dt>
<dd><p>Maximum number of iterations (if <code>! is.null(target.EAP.rel) </code>)</p></dd>

  <dt>conv</dt>
<dd><p>Convergence criterion (if <code>! is.null(target.EAP.rel) </code>)</p></dd>

  <dt>trait.normal</dt>
<dd><p>Optional logical indicating whether the trait distribution should be
normally distributed (if <code>! is.null(target.EAP.rel) </code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Object of class <code>IRT.likelihood</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mislevy, R. (1990). Scaling procedures. In E. Johnson &amp; R. Zwick (Eds.),
<em>Focusing the new design: The NAEP 1988 technical report</em> (ETS RR 19-20).
Princeton, NJ: Educational Testing Service.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/CDM/man/IRT.likelihood.html" class="external-link">CDM::IRT.likelihood</a></code>,
<code><a href="https://rdrr.io/pkg/TAM/man/tam.latreg.html" class="external-link">TAM::tam.latreg</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 1: Adjustment of the likelihood | data.read</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexanderrobitzsch/CDM" class="external-link">CDM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.edmeasurementsurveys.com/TAM/Tutorials/" class="external-link">TAM</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.read</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.read</span></span>
<span></span>
<span><span class="co"># define theta grid</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span>,len<span class="op">=</span><span class="fl">41</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 1: fit Rasch model in TAM</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">tam.mml</a></span><span class="op">(</span> <span class="va">dat</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> nodes<span class="op">=</span><span class="va">theta.k</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 2: fit Rasch copula model</span></span>
<span><span class="va">testlets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">)</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.copula.html">rasch.copula2</a></span><span class="op">(</span> <span class="va">dat</span>, itemcluster<span class="op">=</span><span class="va">testlets</span>, theta.k<span class="op">=</span><span class="va">theta.k</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># model comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/CDM/man/IRT.compareModels.html" class="external-link">IRT.compareModels</a></span><span class="op">(</span> <span class="va">mod1</span>, <span class="va">mod2</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># extract EAP reliabilities</span></span>
<span><span class="va">rel1</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="va">EAP.rel</span></span>
<span><span class="va">rel2</span> <span class="op">&lt;-</span> <span class="va">mod2</span><span class="op">$</span><span class="va">EAP.Rel</span></span>
<span><span class="co"># variance inflation factor</span></span>
<span><span class="va">vif</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rel2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rel1</span><span class="op">)</span></span>
<span>  <span class="co">##  &gt; vif</span></span>
<span>  <span class="co">##  [1] 1.211644</span></span>
<span></span>
<span><span class="co"># extract individual likelihood</span></span>
<span><span class="va">like1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CDM/man/IRT.likelihood.html" class="external-link">IRT.likelihood</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span></span>
<span><span class="co"># adjust likelihood from Model 1 to obtain a target EAP reliability of .599</span></span>
<span><span class="va">like1b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">likelihood.adjustment</span><span class="op">(</span> <span class="va">like1</span>, target.EAP.rel<span class="op">=</span><span class="fl">.599</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># compare estimated latent regressions</span></span>
<span><span class="va">lmod1a</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.latreg.html" class="external-link">tam.latreg</a></span><span class="op">(</span> <span class="va">like1</span>, Y<span class="op">=</span><span class="cn">NULL</span> <span class="op">)</span></span>
<span><span class="va">lmod1b</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.latreg.html" class="external-link">tam.latreg</a></span><span class="op">(</span> <span class="va">like1b</span>, Y<span class="op">=</span><span class="cn">NULL</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lmod1a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lmod1b</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

