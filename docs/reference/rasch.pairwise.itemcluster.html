<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pairwise Estimation of the Rasch Model for Locally Dependent Items — rasch.pairwise.itemcluster • sirt</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Pairwise Estimation of the Rasch Model for Locally Dependent Items — rasch.pairwise.itemcluster" />

<meta property="og:description" content="This function uses pairwise conditional likelihood estimation
for estimating item parameters in the Rasch model." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.6-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pairwise Estimation of the Rasch Model for Locally Dependent Items</h1>
    
    <div class="hidden name"><code>rasch.pairwise.itemcluster.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function uses pairwise conditional likelihood estimation
for estimating item parameters in the Rasch model.</p>
    
    </div>

    <pre class="usage"><span class='fu'>rasch.pairwise.itemcluster</span>(<span class='no'>dat</span>, <span class='kw'>itemcluster</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>b.fixed</span><span class='kw'>=</span><span class='kw'>NULL</span>,
    <span class='kw'>conv</span><span class='kw'>=</span><span class='fl'>1e-05</span>, <span class='kw'>maxiter</span><span class='kw'>=</span><span class='fl'>3000</span>, <span class='kw'>progress</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>b.init</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>zerosum</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>An \(N \times I\) data frame.
  Missing responses are allowed and must be recoded as <code>NA</code>.</p></td>
    </tr>
    <tr>
      <th>itemcluster</th>
      <td><p>Optional integer vector of itemcluster (see Examples). Different
integers correspond to different item clusters. No item cluster
is set as default.</p></td>
    </tr>
    <tr>
      <th>b.fixed</th>
      <td><p>Matrix for fixing item parameters. The first columns contains the item
(number or name), the second column the parameter to be fixed.</p></td>
    </tr>
    <tr>
      <th>conv</th>
      <td><p>Convergence criterion in maximal absolute parameter change</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>Maximal number of iterations</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>A logical which displays progress. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>b.init</th>
      <td><p>Vector of initial item difficulty estimates. Default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>zerosum</th>
      <td><p>Optional logical indicating whether item difficulties
    should be centered in each iteration. The default is that
        no centering is conducted.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is an adaptation of the algorithm of van der Linden and Eggen (1986). Only item pairs
of different item clusters are taken into account for item difficulty estimation.
Therefore, the problem of locally dependent items within each itemcluster is (almost)
eliminated (see Examples below) because contributions of local dependencies
do not appear in the pairwise likelihood terms. In detail, the estimation rests
on observed frequency tables of items \(i\) and \(j\) and therefore on conditional
probabilities
$$ \frac{P(X_i=x, X_j=y)}{P(X_i + X_j=1 )} \quad \mbox{with}
\quad x,y=0,1 \quad \mbox{and} \quad x+y=1 $$
If for some item pair \((i,j)\) a higher positive (or negative) correlation
is expected (i.e. deviation from local dependence), then this pair is
removed from estimation. Clearly, there is a loss in precision but item
parameters can be less biased.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object of class <code>rasch.pairwise</code> with elements</p>
<dt>b</dt><dd><p>Vector of item difficulties</p></dd>
 <dt>item</dt><dd><p>Data frame of item parameters (\(N\), \(p\) and item difficulty)</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>van der Linden, W. J., &amp; Eggen, T. J. H. M. (1986). <em>An empirical
Bayes approach to item banking</em>. Research Report 86-6, University of Twente.</p>
<p>Zwinderman, A. H. (1995). Pairwise parameter estimation in Rasch models.
<em>Applied Psychological Measurement, 19</em>, 369-375.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>No standard errors are provided by this function. Use resampling
methods for conducting statistical inference.</p>
<p>Formulas for asymptotic standard errors of this pairwise estimation method are
described in Zwinderman (1995).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>rasch.pairwise</code>, <code>summary.rasch.pairwise</code>,</p>
<p>Pairwise marginal likelihood estimation (also labeled as pseudolikelihood
estimation) can be conducted with <code>rasch.pml3</code>.</p>
<p>Other estimation methods are implemented in <code>rasch.copula2</code> or
<code>rasch.mml2</code>.</p>
<p>For simulation of locally dependent data see <code>sim.rasch.dep</code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Example with locally dependent items</span>
<span class='co'>#      12 Items: Cluster 1 -&gt; Items 1,...,4</span>
<span class='co'>#                Cluster 2 -&gt; Items 6,...,9</span>
<span class='co'>#                Cluster 3 -&gt; Items 10,11,12</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>7896</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>12</span>                             <span class='co'># number of items</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>5000</span>                           <span class='co'># number of persons</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(-<span class='fl'>2</span>,<span class='fl'>2</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span>)               <span class='co'># item difficulties</span>
<span class='no'>bsamp</span> <span class='kw'>&lt;-</span> <span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='no'>b</span>)             <span class='co'># sample item difficulties</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>( <span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1</span> ) <span class='co'># person abilities</span>
<span class='co'># itemcluster</span>
<span class='no'>itemcluster</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>0</span>,<span class='no'>I</span>)
<span class='no'>itemcluster</span>[ <span class='fl'>1</span>:<span class='fl'>4</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>itemcluster</span>[ <span class='fl'>6</span>:<span class='fl'>9</span> ] <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>itemcluster</span>[ <span class='fl'>10</span>:<span class='fl'>12</span> ] <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='co'># residual correlations</span>
<span class='no'>rho</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>( <span class='fl'>.55</span>, <span class='fl'>.25</span>, <span class='fl'>.45</span> )

<span class='co'># simulate data</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/sim.rasch.dep'>sim.rasch.dep</a></span>( <span class='no'>theta</span>, <span class='no'>b</span>, <span class='no'>itemcluster</span>, <span class='no'>rho</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>dat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste</a></span>(<span class='st'>"I"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>dat</span>)), <span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>)

<span class='co'># estimation with pairwise Rasch model</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/rasch.pairwise'>rasch.pairwise</a></span>( <span class='no'>dat</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'># use item cluster in rasch pairwise estimation</span>
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/rasch.pairwise.itemcluster'>rasch.pairwise.itemcluster</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>itemcluster</span><span class='kw'>=</span><span class='no'>itemcluster</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod</span>)

<span class='co'># }</span><span class='co'># NOT RUN {</span>
<span class='co'># Rasch MML estimation</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/rasch.mml'>rasch.mml2</a></span>( <span class='no'>dat</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod4</span>)

<span class='co'># Rasch Copula estimation</span>
<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/rasch.copula'>rasch.copula2</a></span>( <span class='no'>dat</span>, <span class='kw'>itemcluster</span><span class='kw'>=</span><span class='no'>itemcluster</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod5</span>)

<span class='co'># compare different item parameter estimates</span>
<span class='no'>M1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>( <span class='st'>"true.b"</span><span class='kw'>=</span><span class='no'>bsamp</span>, <span class='st'>"b.rasch"</span><span class='kw'>=</span><span class='no'>mod4</span>$<span class='no'>item</span>$<span class='no'>b</span>, <span class='st'>"b.rasch.copula"</span><span class='kw'>=</span><span class='no'>mod5</span>$<span class='no'>item</span>$<span class='no'>thresh</span>,
         <span class='st'>"b.rasch.pairwise"</span><span class='kw'>=</span><span class='no'>mod3</span>$<span class='no'>b</span>, <span class='st'>"b.rasch.pairwise.cluster"</span><span class='kw'>=</span><span class='no'>mod</span>$<span class='no'>b</span> )
<span class='co'># center item difficulties</span>
<span class='no'>M1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/scale'>scale</a></span>( <span class='no'>M1</span>, <span class='kw'>scale</span><span class='kw'>=</span><span class='fl'>FALSE</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>( <span class='no'>M1</span>, <span class='fl'>3</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>( <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>( <span class='no'>M1</span>, <span class='fl'>2</span>, <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='no'><a href='https://www.rdocumentation.org/packages/stats/topics/sd'>sd</a></span> ), <span class='fl'>3</span> )

<span class='co'>#  Below the output of the example is presented.</span>
<span class='co'>#  The rasch.pairwise.itemcluster is pretty close to the estimate in the Rasch copula model.</span>

  <span class='co'>##   &gt; round( M1, 3 )</span>
  <span class='co'>##       true.b b.rasch b.rasch.copula b.rasch.pairwise b.rasch.pairwise.cluster</span>
  <span class='co'>##   I1   0.545   0.561          0.526            0.628                    0.524</span>
  <span class='co'>##   I2  -0.182  -0.168         -0.174           -0.121                   -0.156</span>
  <span class='co'>##   I3  -0.909  -0.957         -0.867           -0.971                   -0.899</span>
  <span class='co'>##   I4  -1.636  -1.726         -1.625           -1.765                   -1.611</span>
  <span class='co'>##   I5   1.636   1.751          1.648            1.694                    1.649</span>
  <span class='co'>##   I6   0.909   0.892          0.836            0.898                    0.827</span>
  <span class='co'>##   I7  -2.000  -2.134         -2.020           -2.051                   -2.000</span>
  <span class='co'>##   I8  -1.273  -1.355         -1.252           -1.303                   -1.271</span>
  <span class='co'>##   I9  -0.545  -0.637         -0.589           -0.581                   -0.598</span>
  <span class='co'>##   I10  1.273   1.378          1.252            1.308                    1.276</span>
  <span class='co'>##   I11  0.182   0.241          0.226            0.109                    0.232</span>
  <span class='co'>##   I12  2.000   2.155          2.039            2.154                    2.026</span>
  <span class='co'>##   &gt; round( apply( M1, 2, sd ), 3 )</span>
  <span class='co'>##                     true.b                  b.rasch           b.rasch.copula</span>
  <span class='co'>##                      1.311                    1.398                    1.310</span>
  <span class='co'>##      b.rasch.pairwise    b.rasch.pairwise.cluster</span>
  <span class='co'>##                 1.373                       1.310</span>

<span class='co'># set item parameters of first item to 0 and of second item to -0.7</span>
<span class='no'>b.fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>( <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>,-<span class='fl'>.7</span>) )
<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/rasch.pairwise.itemcluster'>rasch.pairwise.itemcluster</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>b.fixed</span><span class='kw'>=</span><span class='no'>b.fixed</span>,
             <span class='kw'>itemcluster</span><span class='kw'>=</span><span class='no'>itemcluster</span> )
<span class='co'># difference between estimations 'mod' and 'mod5'</span>
<span class='no'>dfr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>( <span class='no'>mod5</span>$<span class='no'>item</span>$<span class='no'>b</span>, <span class='no'>mod</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>( <span class='no'>mod5</span>$<span class='no'>item</span>$<span class='no'>b</span>, <span class='no'>mod</span>$<span class='no'>item</span>$<span class='no'>b</span>, <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>16</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>( <span class='no'>dfr</span>, <span class='fl'>1</span>, <span class='no'>diff</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

