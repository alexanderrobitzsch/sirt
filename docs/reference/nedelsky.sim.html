<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Functions for the Nedelsky Model — nedelsky-methods • sirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Functions for the Nedelsky Model — nedelsky-methods" />
<meta property="og:description" content="Functions for simulating and estimating the Nedelsky model
(Bechger et al., 2003, 2005). nedelsky.sim can be used for
simulating the model, nedelsky.irf computes the item response
function and can be used for example when estimating the
Nedelsky model in the mirt package or using the
xxirt function in the sirt package." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.13-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functions for the Nedelsky Model</h1>
    
    <div class="hidden name"><code>nedelsky.sim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions for simulating and estimating the Nedelsky model
(Bechger et al., 2003, 2005). <code>nedelsky.sim</code> can be used for
simulating the model, <code>nedelsky.irf</code> computes the item response
function and can be used for example when estimating the
Nedelsky model in the <span class="pkg">mirt</span> package or using the
<code>xxirt</code> function in the <span class="pkg">sirt</span> package.</p>
    </div>

    <pre class="usage"><span class='co'># simulating the Nedelsky model</span>
<span class='fu'>nedelsky.sim</span>(<span class='no'>theta</span>, <span class='no'>b</span>, <span class='kw'>a</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>tau</span><span class='kw'>=</span><span class='kw'>NULL</span>)

<span class='co'># creating latent responses of the Nedelsky model</span>
<span class='fu'>nedelsky.latresp</span>(<span class='no'>K</span>)

<span class='co'># computing the item response function of the Nedelsky model</span>
<span class='fu'>nedelsky.irf</span>(<span class='no'>Theta</span>, <span class='no'>K</span>, <span class='no'>b</span>, <span class='no'>a</span>, <span class='no'>tau</span>, <span class='no'>combis</span>, <span class='kw'>thdim</span><span class='kw'>=</span><span class='fl'>1</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>theta</th>
      <td><p>Unidimensional ability (theta)</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>Matrix of category difficulties</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>Vector of item discriminations</p></td>
    </tr>
    <tr>
      <th>tau</th>
      <td><p>Category attractivity parameters \(\tau\) (see Bechger et al., 2005)</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>(Maximum) Number of distractors of the used multiple choice items</p></td>
    </tr>
    <tr>
      <th>Theta</th>
      <td><p>Theta vector. Note that the Nedelsky model can be only specified
  as models with between item dimensionality (defined in <code>thdim</code>).</p></td>
    </tr>
    <tr>
      <th>combis</th>
      <td><p>Latent response classes as produced by <code>nedelsky.latresp</code>.</p></td>
    </tr>
    <tr>
      <th>thdim</th>
      <td><p>Theta dimension at which the item loads</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Assume that for item \(i\) there exists \(K+1\) categories \(0,1,...,K\).
The category 0 denotes the correct alternative. The Nedelsky model assumes
that a respondent eliminates all distractors which are thought to be
incorrect and guesses the solution from the remaining alternatives.
This means, that for item \(i\), \(K\) latent variables \(S_{ik}\)
are defined which indicate whether alternative \(k\) has been correctly
identified as a distractor. By definition, the correct alternative is never
been judged as wrong by the respondent.</p>
<p>Formally, the Nedelsky model assumes a 2PL model for eliminating each of the
distractors
$$P(S_{ik}=1 | \theta )=invlogit[ a_i ( \theta - b_{ik} ) ] $$
where \(\theta\) is the person ability and \(b_{ik}\) are
distractor difficulties.</p>
<p>The guessing process of the Nedelsky model is defined as
$$P(X_i=j | \theta, S_{i1}, ..., S_{iK} )=
\frac{ ( 1- S_{ij} ) \tau_{ij} }{ \sum_{k=0}^K [ ( 1- S_{ik} ) \tau_{ik} ] }$$
where \(\tau_{ij}\) are attractivity parameters of alternative \(j\).
By definition \(\tau_{i0}\) is set to 1. By default, all attractivity parameters
are set to 1.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bechger, T. M., Maris, G., Verstralen, H. H. F. M., &amp; Verhelst, N. D. (2003).
<em>The Nedelsky model for multiple-choice items</em>.
CITO Research Report, 2003-5.</p>
<p>Bechger, T. M., Maris, G., Verstralen, H. H. F. M., &amp; Verhelst, N. D. (2005).
The Nedelsky model for multiple-choice items.
In L. van der Ark, M. Croon, &amp; Sijtsma, K. (Eds.).
<em>New developments in categorical data analysis for the social and behavioral
sciences</em>, pp. 187-206. Mahwah, Lawrence Erlbaum.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Simulated data according to the Nedelsky model</span>
<span class='co'>#############################################################################</span>

<span class='co'>#*** simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>20</span>          <span class='co'># number of items</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>NA</span>,<span class='no'>I</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='no'>b</span>[,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> -<span class='fl'>0.5</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>( <span class='no'>I</span>, -<span class='fl'>.75</span>, <span class='fl'>.75</span> )
<span class='no'>b</span>[,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> -<span class='fl'>1.5</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>( <span class='no'>I</span>, -<span class='fl'>.75</span>, <span class='fl'>.75</span> )
<span class='no'>b</span>[,<span class='fl'>3</span>] <span class='kw'>&lt;-</span> -<span class='fl'>2.5</span> + <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>( <span class='no'>I</span>, -<span class='fl'>.75</span>, <span class='fl'>.75</span> )
<span class='no'>K</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>           <span class='co'># number of distractors</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>2000</span>        <span class='co'># number of persons</span>
<span class='co'># apply simulation function</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>nedelsky.sim</span>( <span class='kw'>theta</span><span class='kw'>=</span><span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>N</span>,<span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1.2</span>), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span> )

<span class='co'>#*** latent response patterns</span>
<span class='no'>K</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>combis</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>nedelsky.latresp</span>(<span class='kw'>K</span><span class='kw'>=</span><span class='fl'>3</span>)

<span class='co'>#*** defining the Nedelsky item response function for estimation in mirt</span>
<span class='no'>par</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>3</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(-<span class='fl'>1</span>,<span class='no'>K</span>), <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>K</span>+<span class='fl'>1</span>),<span class='fl'>1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>par</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"K"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"b"</span>,<span class='fl'>1</span>:<span class='no'>K</span>), <span class='st'>"a"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"tau"</span>, <span class='fl'>0</span>:<span class='no'>K</span>),<span class='st'>"thdim"</span>)
<span class='no'>est</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>FALSE</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>TRUE</span>,<span class='no'>K</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>FALSE</span>, <span class='no'>K</span>+<span class='fl'>1</span> + <span class='fl'>2</span> ) )
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>est</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>par</span>)
<span class='no'>nedelsky.icc</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>( <span class='no'>par</span>, <span class='no'>Theta</span>, <span class='no'>ncat</span> ){
     <span class='no'>K</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>1</span>]
     <span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[ <span class='fl'>1</span>:<span class='no'>K</span> + <span class='fl'>1</span>]
     <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[ <span class='no'>K</span>+<span class='fl'>2</span>]
     <span class='no'>tau</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>1</span>:(<span class='no'>K</span>+<span class='fl'>1</span>) + (<span class='no'>K</span>+<span class='fl'>2</span>) ]
     <span class='no'>thdim</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[ <span class='no'>K</span>+<span class='fl'>2</span>+<span class='no'>K</span>+<span class='fl'>1</span> +<span class='fl'>1</span> ]
     <span class='no'>probs</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>nedelsky.irf</span>( <span class='no'>Theta</span>, <span class='kw'>K</span><span class='kw'>=</span><span class='no'>K</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span>, <span class='kw'>a</span><span class='kw'>=</span><span class='no'>a</span>, <span class='kw'>tau</span><span class='kw'>=</span><span class='no'>tau</span>, <span class='no'>combis</span>,
                    <span class='kw'>thdim</span><span class='kw'>=</span><span class='no'>thdim</span>  )$<span class='no'>probs</span>
     <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>probs</span>)
}
<span class='no'>name</span> <span class='kw'>&lt;-</span> <span class='st'>"nedelsky"</span>
<span class='co'># create item response function</span>
<span class='no'>nedelsky.itemfct</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/createItem.html'>createItem</a></span>(<span class='no'>name</span>, <span class='kw'>par</span><span class='kw'>=</span><span class='no'>par</span>, <span class='kw'>est</span><span class='kw'>=</span><span class='no'>est</span>, <span class='kw'>P</span><span class='kw'>=</span><span class='no'>nedelsky.icc</span>)

<span class='co'>#*** define model in mirt</span>
<span class='no'>mirtmodel</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.model.html'>mirt.model</a></span>(<span class='st'>"
           F1=1-20
           COV=F1*F1
           # define some prior distributions
           PRIOR=(1-20,b1,norm,-1,2),(1-20,b2,norm,-1,2),
                   (1-20,b3,norm,-1,2)
        "</span> )

<span class='no'>itemtype</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"nedelsky"</span>, <span class='no'>I</span> )
<span class='no'>customItems</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"nedelsky"</span><span class='kw'>=</span><span class='no'>nedelsky.itemfct</span>)
<span class='co'># define parameters to be estimated</span>
<span class='no'>mod1.pars</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.html'>mirt</a></span>(<span class='no'>dat</span>, <span class='no'>mirtmodel</span>, <span class='kw'>itemtype</span><span class='kw'>=</span><span class='no'>itemtype</span>,
                   <span class='kw'>customItems</span><span class='kw'>=</span><span class='no'>customItems</span>, <span class='kw'>pars</span><span class='kw'>=</span><span class='st'>"values"</span>)
<span class='co'># estimate model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.html'>mirt</a></span>(<span class='no'>dat</span>,<span class='no'>mirtmodel</span>, <span class='kw'>itemtype</span><span class='kw'>=</span><span class='no'>itemtype</span>, <span class='kw'>customItems</span><span class='kw'>=</span><span class='no'>customItems</span>,
               <span class='kw'>pars</span><span class='kw'>=</span><span class='no'>mod1.pars</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>  )
<span class='co'># model summaries</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'>mirt.wrapper.coef</span>( <span class='no'>mod1</span> )$<span class='no'>coef</span>
<span class='fu'>mirt.wrapper.itemplot</span>(<span class='no'>mod1</span>,<span class='kw'>ask</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='co'>#******************************************************</span>
<span class='co'># fit Nedelsky model with xxirt function in sirt</span>

<span class='co'># define item class for xxirt</span>
<span class='no'>item_nedelsky</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>xxirt_createDiscItem</span>( <span class='kw'>name</span><span class='kw'>=</span><span class='st'>"nedelsky"</span>, <span class='kw'>par</span><span class='kw'>=</span><span class='no'>par</span>,
                <span class='kw'>est</span><span class='kw'>=</span><span class='no'>est</span>, <span class='kw'>P</span><span class='kw'>=</span><span class='no'>nedelsky.icc</span>,
                <span class='kw'>prior</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='kw'>b1</span><span class='kw'>=</span><span class='st'>"dnorm"</span>, <span class='kw'>b2</span><span class='kw'>=</span><span class='st'>"dnorm"</span>, <span class='kw'>b3</span><span class='kw'>=</span><span class='st'>"dnorm"</span> ),
                <span class='kw'>prior_par1</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='kw'>b1</span><span class='kw'>=</span>-<span class='fl'>1</span>, <span class='kw'>b2</span><span class='kw'>=</span>-<span class='fl'>1</span>, <span class='kw'>b3</span><span class='kw'>=</span>-<span class='fl'>1</span>),
                <span class='kw'>prior_par2</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>b1</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>b2</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>b3</span><span class='kw'>=</span><span class='fl'>2</span>) )
<span class='no'>customItems</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='no'>item_nedelsky</span> )

<span class='co'>#---- definition theta distribution</span>
<span class='co'>#** theta grid</span>
<span class='no'>Theta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>6</span>,<span class='fl'>6</span>,<span class='kw'>length</span><span class='kw'>=</span><span class='fl'>21</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span> )
<span class='co'>#** theta distribution</span>
<span class='no'>P_Theta1</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>( <span class='no'>par</span>, <span class='no'>Theta</span>, <span class='no'>G</span>){
    <span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>1</span>]
    <span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>( <span class='no'>par</span>[<span class='fl'>2</span>], <span class='fl'>.01</span> )
    <span class='no'>TP</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>Theta</span>)
    <span class='no'>pi_Theta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>TP</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>G</span>)
    <span class='no'>pi1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>dnorm</a></span>( <span class='no'>Theta</span>[,<span class='fl'>1</span>], <span class='kw'>mean</span><span class='kw'>=</span><span class='no'>mu</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='no'>sigma</span> )
    <span class='no'>pi1</span> <span class='kw'>&lt;-</span> <span class='no'>pi1</span> / <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>pi1</span>)
    <span class='no'>pi_Theta</span>[,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>pi1</span>
    <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>pi_Theta</span>)
}
<span class='co'>#** create distribution class</span>
<span class='no'>par_Theta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='st'>"mu"</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='st'>"sigma"</span><span class='kw'>=</span><span class='fl'>1</span> )
<span class='no'>customTheta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>xxirt_createThetaDistribution</span>( <span class='kw'>par</span><span class='kw'>=</span><span class='no'>par_Theta</span>, <span class='kw'>est</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>FALSE</span>,<span class='fl'>TRUE</span>),
                   <span class='kw'>P</span><span class='kw'>=</span><span class='no'>P_Theta1</span> )

<span class='co'>#-- create parameter table</span>
<span class='no'>itemtype</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='st'>"nedelsky"</span>, <span class='no'>I</span> )
<span class='no'>partable</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>xxirt_createParTable</span>( <span class='no'>dat</span>, <span class='kw'>itemtype</span><span class='kw'>=</span><span class='no'>itemtype</span>, <span class='kw'>customItems</span><span class='kw'>=</span><span class='no'>customItems</span>)

<span class='co'># estimate model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>xxirt</span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Theta</span><span class='kw'>=</span><span class='no'>Theta</span>, <span class='kw'>partable</span><span class='kw'>=</span><span class='no'>partable</span>, <span class='kw'>customItems</span><span class='kw'>=</span><span class='no'>customItems</span>,
                    <span class='kw'>customTheta</span><span class='kw'>=</span><span class='no'>customTheta</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='co'># compare sirt::xxirt and mirt::mirt</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod2</span>)
<span class='no'>mod1</span>@<span class='kw'>Fit</span>$<span class='no'>logLik</span>

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 2: Multiple choice dataset data.si06</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.si06</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.si06</span>

<span class='co'>#*** create latent responses</span>
<span class='no'>combis</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>nedelsky.latresp</span>(<span class='no'>K</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)
<span class='co'>#*** define item response function</span>
<span class='no'>K</span> <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>par</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>3</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(-<span class='fl'>1</span>,<span class='no'>K</span>), <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>K</span>+<span class='fl'>1</span>),<span class='fl'>1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>par</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"K"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"b"</span>,<span class='fl'>1</span>:<span class='no'>K</span>), <span class='st'>"a"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"tau"</span>, <span class='fl'>0</span>:<span class='no'>K</span>),<span class='st'>"thdim"</span>)
<span class='no'>est</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>FALSE</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>TRUE</span>,<span class='no'>K</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>FALSE</span>, <span class='no'>K</span>+<span class='fl'>1</span> + <span class='fl'>2</span> ) )
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>est</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>par</span>)
<span class='no'>nedelsky.icc</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>( <span class='no'>par</span>, <span class='no'>Theta</span>, <span class='no'>ncat</span> ){
     <span class='no'>K</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>1</span>]
     <span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[ <span class='fl'>1</span>:<span class='no'>K</span> + <span class='fl'>1</span>]
     <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[ <span class='no'>K</span>+<span class='fl'>2</span>]
     <span class='no'>tau</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>1</span>:(<span class='no'>K</span>+<span class='fl'>1</span>) + (<span class='no'>K</span>+<span class='fl'>2</span>) ]
     <span class='no'>thdim</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[ <span class='no'>K</span>+<span class='fl'>2</span>+<span class='no'>K</span>+<span class='fl'>1</span> +<span class='fl'>1</span> ]
     <span class='no'>probs</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>nedelsky.irf</span>( <span class='no'>Theta</span>, <span class='kw'>K</span><span class='kw'>=</span><span class='no'>K</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span>, <span class='kw'>a</span><span class='kw'>=</span><span class='no'>a</span>, <span class='kw'>tau</span><span class='kw'>=</span><span class='no'>tau</span>, <span class='no'>combis</span>,
                    <span class='kw'>thdim</span><span class='kw'>=</span><span class='no'>thdim</span>  )$<span class='no'>probs</span>
     <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='no'>probs</span>)
}
<span class='no'>name</span> <span class='kw'>&lt;-</span> <span class='st'>"nedelsky"</span>
<span class='co'># create item response function</span>
<span class='no'>nedelsky.itemfct</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/createItem.html'>createItem</a></span>(<span class='no'>name</span>, <span class='kw'>par</span><span class='kw'>=</span><span class='no'>par</span>, <span class='kw'>est</span><span class='kw'>=</span><span class='no'>est</span>, <span class='kw'>P</span><span class='kw'>=</span><span class='no'>nedelsky.icc</span>)

<span class='co'>#*** define model in mirt</span>
<span class='no'>mirtmodel</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.model.html'>mirt.model</a></span>(<span class='st'>"
           F1=1-14
           COV=F1*F1
           PRIOR=(1-14,b1,norm,-1,2),(1-14,b2,norm,-1,2),
                   (1-14,b3,norm,-1,2)
        "</span> )

<span class='no'>itemtype</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"nedelsky"</span>, <span class='no'>I</span> )
<span class='no'>customItems</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"nedelsky"</span><span class='kw'>=</span><span class='no'>nedelsky.itemfct</span>)
<span class='co'># define parameters to be estimated</span>
<span class='no'>mod1.pars</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.html'>mirt</a></span>(<span class='no'>dat</span>, <span class='no'>mirtmodel</span>, <span class='kw'>itemtype</span><span class='kw'>=</span><span class='no'>itemtype</span>,
                   <span class='kw'>customItems</span><span class='kw'>=</span><span class='no'>customItems</span>, <span class='kw'>pars</span><span class='kw'>=</span><span class='st'>"values"</span>)

<span class='co'>#*** estimate model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.html'>mirt</a></span>(<span class='no'>dat</span>,<span class='no'>mirtmodel</span>, <span class='kw'>itemtype</span><span class='kw'>=</span><span class='no'>itemtype</span>, <span class='kw'>customItems</span><span class='kw'>=</span><span class='no'>customItems</span>,
               <span class='kw'>pars</span><span class='kw'>=</span><span class='no'>mod1.pars</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
<span class='co'>#*** summaries</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'>mirt.wrapper.coef</span>( <span class='no'>mod1</span> )$<span class='no'>coef</span>
<span class='fu'>mirt.wrapper.itemplot</span>(<span class='no'>mod1</span>,<span class='kw'>ask</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


