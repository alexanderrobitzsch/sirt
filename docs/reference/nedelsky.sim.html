<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Functions for simulating and estimating the Nedelsky model
(Bechger et al., 2003, 2005). nedelsky.sim can be used for
simulating the model, nedelsky.irf computes the item response
function and can be used for example when estimating the
Nedelsky model in the mirt package or using the
xxirt function in the sirt package."><title>Functions for the Nedelsky Model — nedelsky-methods • sirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Functions for the Nedelsky Model — nedelsky-methods"><meta property="og:description" content="Functions for simulating and estimating the Nedelsky model
(Bechger et al., 2003, 2005). nedelsky.sim can be used for
simulating the model, nedelsky.irf computes the item response
function and can be used for example when estimating the
Nedelsky model in the mirt package or using the
xxirt function in the sirt package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3</small

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexanderrobitzsch/sirt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Functions for the Nedelsky Model</h1>
      
      <div class="d-none name"><code>nedelsky.sim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions for simulating and estimating the Nedelsky model
(Bechger et al., 2003, 2005). <code>nedelsky.sim</code> can be used for
simulating the model, <code>nedelsky.irf</code> computes the item response
function and can be used for example when estimating the
Nedelsky model in the <span class="pkg">mirt</span> package or using the
<code><a href="xxirt.html">xxirt</a></code> function in the <span class="pkg">sirt</span> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># simulating the Nedelsky model</span></span>
<span><span class="fu">nedelsky.sim</span><span class="op">(</span><span class="va">theta</span>, <span class="va">b</span>, a<span class="op">=</span><span class="cn">NULL</span>, tau<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># creating latent responses of the Nedelsky model</span></span>
<span><span class="fu">nedelsky.latresp</span><span class="op">(</span><span class="va">K</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># computing the item response function of the Nedelsky model</span></span>
<span><span class="fu">nedelsky.irf</span><span class="op">(</span><span class="va">Theta</span>, <span class="va">K</span>, <span class="va">b</span>, <span class="va">a</span>, <span class="va">tau</span>, <span class="va">combis</span>, thdim<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>theta</dt>
<dd><p>Unidimensional ability (theta)</p></dd>

  <dt>b</dt>
<dd><p>Matrix of category difficulties</p></dd>

  <dt>a</dt>
<dd><p>Vector of item discriminations</p></dd>

  <dt>tau</dt>
<dd><p>Category attractivity parameters \(\tau\) (see Bechger et al., 2005)</p></dd>

<dt>K</dt>
<dd><p>(Maximum) Number of distractors of the used multiple choice items</p></dd>

  <dt>Theta</dt>
<dd><p>Theta vector. Note that the Nedelsky model can be only specified
  as models with between item dimensionality (defined in <code>thdim</code>).</p></dd>

  <dt>combis</dt>
<dd><p>Latent response classes as produced by <code>nedelsky.latresp</code>.</p></dd>

  <dt>thdim</dt>
<dd><p>Theta dimension at which the item loads</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Assume that for item \(i\) there exists \(K+1\) categories \(0,1,...,K\).
The category 0 denotes the correct alternative. The Nedelsky model assumes
that a respondent eliminates all distractors which are thought to be
incorrect and guesses the solution from the remaining alternatives.
This means, that for item \(i\), \(K\) latent variables \(S_{ik}\)
are defined which indicate whether alternative \(k\) has been correctly
identified as a distractor. By definition, the correct alternative is never
been judged as wrong by the respondent.</p>
<p>Formally, the Nedelsky model assumes a 2PL model for eliminating each of the
distractors
$$P(S_{ik}=1 | \theta )=invlogit[ a_i ( \theta - b_{ik} ) ] $$
where \(\theta\) is the person ability and \(b_{ik}\) are
distractor difficulties.</p>
<p>The guessing process of the Nedelsky model is defined as
$$P(X_i=j | \theta, S_{i1}, ..., S_{iK} )=
\frac{ ( 1- S_{ij} ) \tau_{ij} }{ \sum_{k=0}^K [ ( 1- S_{ik} ) \tau_{ik} ] }$$
where \(\tau_{ij}\) are attractivity parameters of alternative \(j\).
By definition \(\tau_{i0}\) is set to 1. By default, all attractivity parameters
are set to 1.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bechger, T. M., Maris, G., Verstralen, H. H. F. M., &amp; Verhelst, N. D. (2003).
<em>The Nedelsky model for multiple-choice items</em>.
CITO Research Report, 2003-5.</p>
<p>Bechger, T. M., Maris, G., Verstralen, H. H. F. M., &amp; Verhelst, N. D. (2005).
The Nedelsky model for multiple-choice items.
In L. van der Ark, M. Croon, &amp; Sijtsma, K. (Eds.).
<em>New developments in categorical data analysis for the social and behavioral
sciences</em>, pp. 187-206. Mahwah, Lawrence Erlbaum.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 1: Simulated data according to the Nedelsky model</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="co">#*** simulate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">20</span>          <span class="co"># number of items</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">I</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">b</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="va">I</span>, <span class="op">-</span><span class="fl">.75</span>, <span class="fl">.75</span> <span class="op">)</span></span>
<span><span class="va">b</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="va">I</span>, <span class="op">-</span><span class="fl">.75</span>, <span class="fl">.75</span> <span class="op">)</span></span>
<span><span class="va">b</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="va">I</span>, <span class="op">-</span><span class="fl">.75</span>, <span class="fl">.75</span> <span class="op">)</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span>           <span class="co"># number of distractors</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">2000</span>        <span class="co"># number of persons</span></span>
<span><span class="co"># apply simulation function</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">nedelsky.sim</span><span class="op">(</span> theta<span class="op">=</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N</span>,sd<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** latent response patterns</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">combis</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">nedelsky.latresp</span><span class="op">(</span>K<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** defining the Nedelsky item response function for estimation in mirt</span></span>
<span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">K</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">K</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"b"</span>,<span class="fl">1</span><span class="op">:</span><span class="va">K</span><span class="op">)</span>, <span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"tau"</span>, <span class="fl">0</span><span class="op">:</span><span class="va">K</span><span class="op">)</span>,<span class="st">"thdim"</span><span class="op">)</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="cn">FALSE</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="va">K</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="va">K</span><span class="op">+</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="va">nedelsky.icc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">par</span>, <span class="va">Theta</span>, <span class="va">ncat</span> <span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">K</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>     <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="va">K</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span>
<span>     <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span> <span class="va">K</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span></span>
<span>     <span class="va">tau</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">K</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">K</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span> <span class="op">]</span></span>
<span>     <span class="va">thdim</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span> <span class="va">K</span><span class="op">+</span><span class="fl">2</span><span class="op">+</span><span class="va">K</span><span class="op">+</span><span class="fl">1</span> <span class="op">+</span><span class="fl">1</span> <span class="op">]</span></span>
<span>     <span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">nedelsky.irf</span><span class="op">(</span> <span class="va">Theta</span>, K<span class="op">=</span><span class="va">K</span>, b<span class="op">=</span><span class="va">b</span>, a<span class="op">=</span><span class="va">a</span>, tau<span class="op">=</span><span class="va">tau</span>, <span class="va">combis</span>,</span>
<span>                    thdim<span class="op">=</span><span class="va">thdim</span>  <span class="op">)</span><span class="op">$</span><span class="va">probs</span></span>
<span>     <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">"nedelsky"</span></span>
<span><span class="co"># create item response function</span></span>
<span><span class="va">nedelsky.itemfct</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/createItem.html" class="external-link">createItem</a></span><span class="op">(</span><span class="va">name</span>, par<span class="op">=</span><span class="va">par</span>, est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">nedelsky.icc</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** define model in mirt</span></span>
<span><span class="va">mirtmodel</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.model.html" class="external-link">mirt.model</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">           F1=1-20</span></span>
<span><span class="st">           COV=F1*F1</span></span>
<span><span class="st">           # define some prior distributions</span></span>
<span><span class="st">           PRIOR=(1-20,b1,norm,-1,2),(1-20,b2,norm,-1,2),</span></span>
<span><span class="st">                   (1-20,b3,norm,-1,2)</span></span>
<span><span class="st">        "</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"nedelsky"</span>, <span class="va">I</span> <span class="op">)</span></span>
<span><span class="va">customItems</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"nedelsky"</span><span class="op">=</span><span class="va">nedelsky.itemfct</span><span class="op">)</span></span>
<span><span class="co"># define parameters to be estimated</span></span>
<span><span class="va">mod1.pars</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html" class="external-link">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">mirtmodel</span>, itemtype<span class="op">=</span><span class="va">itemtype</span>,</span>
<span>                   customItems<span class="op">=</span><span class="va">customItems</span>, pars<span class="op">=</span><span class="st">"values"</span><span class="op">)</span></span>
<span><span class="co"># estimate model</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html" class="external-link">mirt</a></span><span class="op">(</span><span class="va">dat</span>,<span class="va">mirtmodel</span>, itemtype<span class="op">=</span><span class="va">itemtype</span>, customItems<span class="op">=</span><span class="va">customItems</span>,</span>
<span>               pars<span class="op">=</span><span class="va">mod1.pars</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>  <span class="op">)</span></span>
<span><span class="co"># model summaries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="mirt.wrapper.html">mirt.wrapper.coef</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span><span class="op">$</span><span class="va">coef</span></span>
<span><span class="fu"><a href="mirt.wrapper.html">mirt.wrapper.itemplot</a></span><span class="op">(</span><span class="va">mod1</span>,ask<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#******************************************************</span></span>
<span><span class="co"># fit Nedelsky model with xxirt function in sirt</span></span>
<span></span>
<span><span class="co"># define item class for xxirt</span></span>
<span><span class="va">item_nedelsky</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="xxirt_createParTable.html">xxirt_createDiscItem</a></span><span class="op">(</span> name<span class="op">=</span><span class="st">"nedelsky"</span>, par<span class="op">=</span><span class="va">par</span>,</span>
<span>                est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">nedelsky.icc</span>,</span>
<span>                prior<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> b1<span class="op">=</span><span class="st">"dnorm"</span>, b2<span class="op">=</span><span class="st">"dnorm"</span>, b3<span class="op">=</span><span class="st">"dnorm"</span> <span class="op">)</span>,</span>
<span>                prior_par1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> b1<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, b2<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, b3<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>                prior_par2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>b1<span class="op">=</span><span class="fl">2</span>, b2<span class="op">=</span><span class="fl">2</span>, b3<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">customItems</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="va">item_nedelsky</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#---- definition theta distribution</span></span>
<span><span class="co">#** theta grid</span></span>
<span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span>,length<span class="op">=</span><span class="fl">21</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span> <span class="op">)</span></span>
<span><span class="co">#** theta distribution</span></span>
<span><span class="va">P_Theta1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">par</span>, <span class="va">Theta</span>, <span class="va">G</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span> <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">.01</span> <span class="op">)</span></span>
<span>    <span class="va">TP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span></span>
<span>    <span class="va">pi_Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">0</span>, nrow<span class="op">=</span><span class="va">TP</span>, ncol<span class="op">=</span><span class="va">G</span><span class="op">)</span></span>
<span>    <span class="va">pi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span> <span class="va">Theta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, mean<span class="op">=</span><span class="va">mu</span>, sd<span class="op">=</span><span class="va">sigma</span> <span class="op">)</span></span>
<span>    <span class="va">pi1</span> <span class="op">&lt;-</span> <span class="va">pi1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pi1</span><span class="op">)</span></span>
<span>    <span class="va">pi_Theta</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pi1</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pi_Theta</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#** create distribution class</span></span>
<span><span class="va">par_Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"mu"</span><span class="op">=</span><span class="fl">0</span>, <span class="st">"sigma"</span><span class="op">=</span><span class="fl">1</span> <span class="op">)</span></span>
<span><span class="va">customTheta</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="xxirt_createThetaDistribution.html">xxirt_createThetaDistribution</a></span><span class="op">(</span> par<span class="op">=</span><span class="va">par_Theta</span>, est<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                   P<span class="op">=</span><span class="va">P_Theta1</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#-- create parameter table</span></span>
<span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="st">"nedelsky"</span>, <span class="va">I</span> <span class="op">)</span></span>
<span><span class="va">partable</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="xxirt_createParTable.html">xxirt_createParTable</a></span><span class="op">(</span> <span class="va">dat</span>, itemtype<span class="op">=</span><span class="va">itemtype</span>, customItems<span class="op">=</span><span class="va">customItems</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># estimate model</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="xxirt.html">xxirt</a></span><span class="op">(</span> dat<span class="op">=</span><span class="va">dat</span>, Theta<span class="op">=</span><span class="va">Theta</span>, partable<span class="op">=</span><span class="va">partable</span>, customItems<span class="op">=</span><span class="va">customItems</span>,</span>
<span>                    customTheta<span class="op">=</span><span class="va">customTheta</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="co"># compare sirt::xxirt and mirt::mirt</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="va">mod1</span><span class="op">@</span><span class="va">Fit</span><span class="op">$</span><span class="va">logLik</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 2: Multiple choice dataset data.si06</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.si06</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.si06</span></span>
<span></span>
<span><span class="co">#*** create latent responses</span></span>
<span><span class="va">combis</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">nedelsky.latresp</span><span class="op">(</span><span class="va">K</span><span class="op">)</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#*** define item response function</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="va">K</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">K</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"b"</span>,<span class="fl">1</span><span class="op">:</span><span class="va">K</span><span class="op">)</span>, <span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"tau"</span>, <span class="fl">0</span><span class="op">:</span><span class="va">K</span><span class="op">)</span>,<span class="st">"thdim"</span><span class="op">)</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="cn">FALSE</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="va">K</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="va">K</span><span class="op">+</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="va">nedelsky.icc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span> <span class="va">par</span>, <span class="va">Theta</span>, <span class="va">ncat</span> <span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">K</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>     <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="va">K</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span>
<span>     <span class="va">a</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span> <span class="va">K</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span></span>
<span>     <span class="va">tau</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">K</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">K</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span> <span class="op">]</span></span>
<span>     <span class="va">thdim</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span> <span class="va">K</span><span class="op">+</span><span class="fl">2</span><span class="op">+</span><span class="va">K</span><span class="op">+</span><span class="fl">1</span> <span class="op">+</span><span class="fl">1</span> <span class="op">]</span></span>
<span>     <span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">nedelsky.irf</span><span class="op">(</span> <span class="va">Theta</span>, K<span class="op">=</span><span class="va">K</span>, b<span class="op">=</span><span class="va">b</span>, a<span class="op">=</span><span class="va">a</span>, tau<span class="op">=</span><span class="va">tau</span>, <span class="va">combis</span>,</span>
<span>                    thdim<span class="op">=</span><span class="va">thdim</span>  <span class="op">)</span><span class="op">$</span><span class="va">probs</span></span>
<span>     <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">name</span> <span class="op">&lt;-</span> <span class="st">"nedelsky"</span></span>
<span><span class="co"># create item response function</span></span>
<span><span class="va">nedelsky.itemfct</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/createItem.html" class="external-link">createItem</a></span><span class="op">(</span><span class="va">name</span>, par<span class="op">=</span><span class="va">par</span>, est<span class="op">=</span><span class="va">est</span>, P<span class="op">=</span><span class="va">nedelsky.icc</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** define model in mirt</span></span>
<span><span class="va">mirtmodel</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.model.html" class="external-link">mirt.model</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">           F1=1-14</span></span>
<span><span class="st">           COV=F1*F1</span></span>
<span><span class="st">           PRIOR=(1-14,b1,norm,-1,2),(1-14,b2,norm,-1,2),</span></span>
<span><span class="st">                   (1-14,b3,norm,-1,2)</span></span>
<span><span class="st">        "</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"nedelsky"</span>, <span class="va">I</span> <span class="op">)</span></span>
<span><span class="va">customItems</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"nedelsky"</span><span class="op">=</span><span class="va">nedelsky.itemfct</span><span class="op">)</span></span>
<span><span class="co"># define parameters to be estimated</span></span>
<span><span class="va">mod1.pars</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html" class="external-link">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">mirtmodel</span>, itemtype<span class="op">=</span><span class="va">itemtype</span>,</span>
<span>                   customItems<span class="op">=</span><span class="va">customItems</span>, pars<span class="op">=</span><span class="st">"values"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** estimate model</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://philchalmers.github.io/mirt/reference/mirt.html" class="external-link">mirt</a></span><span class="op">(</span><span class="va">dat</span>,<span class="va">mirtmodel</span>, itemtype<span class="op">=</span><span class="va">itemtype</span>, customItems<span class="op">=</span><span class="va">customItems</span>,</span>
<span>               pars<span class="op">=</span><span class="va">mod1.pars</span>, verbose<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="co">#*** summaries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="mirt.wrapper.html">mirt.wrapper.coef</a></span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span><span class="op">$</span><span class="va">coef</span></span>
<span><span class="fu"><a href="mirt.wrapper.html">mirt.wrapper.itemplot</a></span><span class="op">(</span><span class="va">mod1</span>,ask<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

