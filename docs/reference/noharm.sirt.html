<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>NOHARM Model in <span style="R">R</span> — noharm.sirt • sirt</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="NOHARM Model in <span style="R">R</span> — noharm.sirt" />

<meta property="og:description" content="The function is an R implementation of the normal ogive harmonic analysis
robust method (the NOHARM model; McDonald, 1997). Exploratory and confirmatory
multidimensional item response models for dichotomous data using the
probit link function can be estimated. Lower asymptotes (guessing parameters)
and upper asymptotes (one minus slipping parameters) can be provided as
fixed values." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.5-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>NOHARM Model in <span style="R">R</span></h1>
    
    <div class="hidden name"><code>noharm.sirt.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The function is an <span style="R">R</span> implementation of the normal ogive harmonic analysis
robust method (the NOHARM model; McDonald, 1997). Exploratory and confirmatory
multidimensional item response models for dichotomous data using the
probit link function can be estimated. Lower asymptotes (guessing parameters)
and upper asymptotes (one minus slipping parameters) can be provided as
fixed values.</p>
    
    </div>

    <pre class="usage">noharm.sirt(dat, pm=NULL, N=NULL, weights=NULL, Fval=NULL, Fpatt=NULL, Pval=NULL,
   Ppatt=NULL, Psival=NULL, Psipatt=NULL, dimensions=NULL, lower=0, upper=1, wgtm=NULL,
   pos.loading=FALSE, pos.variance=FALSE, pos.residcorr=FALSE, maxiter=1000, conv=1e-6,
   optimizer="nlminb", par_lower=NULL, reliability=FALSE, &#8230;)

# S3 method for noharm.sirt
summary(object, file=NULL, &#8230;)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>Matrix of dichotomous item responses. This matrix may contain missing data (indicated
by <code>NA</code>) but missingness is assumed to be missing completely at random (MCAR).
Alternatively, a product-moment matrix <code>pm</code> can be used as input.</p></td>
    </tr>
    <tr>
      <th>pm</th>
      <td><p>Optional product-moment matrix</p></td>
    </tr>
    <tr>
      <th>N</th>
      <td><p>Sample size if <code>pm</code> is provided</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Optional vector of student weights.</p></td>
    </tr>
    <tr>
      <th>Fval</th>
      <td><p>Initial or fixed values of the loading matrix \(\bold{F}\).</p></td>
    </tr>
    <tr>
      <th>Fpatt</th>
      <td><p>Pattern matrix of the loading matrix \(\bold{F}\). If elements should be
estimated, then an entry of 1 must be included in the pattern matrix. Parameters
which should be estimated with equality constraints must be indicated by same
integers but values largers than 1.</p></td>
    </tr>
    <tr>
      <th>Pval</th>
      <td><p>Initial or fixed values for the covariance matrix \(\bold{P}\).</p></td>
    </tr>
    <tr>
      <th>Ppatt</th>
      <td><p>Pattern matrix for the covariance matrix \(\bold{P}\).</p></td>
    </tr>
    <tr>
      <th>Psival</th>
      <td><p>Initial or fixed values for the matrix of residual correlations \(\bold{\Psi}\).</p></td>
    </tr>
    <tr>
      <th>Psipatt</th>
      <td><p>Pattern matrix for the matrix of residual correlations \(\bold{\Psi}\).</p></td>
    </tr>
    <tr>
      <th>dimensions</th>
      <td><p>Number of dimensions if an exploratory factor analysis should be estimated.</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>Fixed vector (or numeric) of lower asymptotes \(c_i\).</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>Fixed vector (or numeric) of upper asymptotes \(d_i\).</p></td>
    </tr>
    <tr>
      <th>wgtm</th>
      <td><p>Matrix with positive entries which indicates by a positive entry which
item pairs should be used for estimation.</p></td>
    </tr>
    <tr>
      <th>pos.loading</th>
      <td><p>An optional logical indicating whether all entries in the
loading matrix \(\bold{F}\) should be positive</p></td>
    </tr>
    <tr>
      <th>pos.variance</th>
      <td><p>An optional logical indicating whether all variances (i.e.
    diagonal entries in \(\bold{P}\)) should be positive</p></td>
    </tr>
    <tr>
      <th>pos.residcorr</th>
      <td><p>An optional logical indicating whether all
    entries in the matrix of residual correlations \(\bold{\Psi}\) should
    be positive</p></td>
    </tr>
    <tr>
      <th>par_lower</th>
      <td><p>Optional vector of lower parameter bounds</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>Maximum number of iterations</p></td>
    </tr>
    <tr>
      <th>conv</th>
      <td><p>Convergence criterion for parameters</p></td>
    </tr>
    <tr>
      <th>optimizer</th>
      <td><p>Optimization function to be used. Can be <code>"nlminb"</code> for
<code><a href='https://www.rdocumentation.org/packages/stats/topics/nlminb'>stats::nlminb</a></code>
or <code>"optim"</code> for <code><a href='https://www.rdocumentation.org/packages/stats/topics/optim'>stats::optim</a></code>.</p></td>
    </tr>
    <tr>
      <th>reliability</th>
      <td><p>Logical indicating whether reliability should be computed.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Further arguments to be passed.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Object of class <code>noharm.sirt</code></p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>String indicating a file name for summary.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The NOHARM item response model follows the response equation
$$P( X_{pi}=1 | \bold{\theta}_p )=c_i + ( d_i - c_i )
\Phi( f_{i0} + f_{i1} \theta_{p1} + ... +
f_{iD} \theta_{pD} ) $$
for item responses \(X_{pi}\) of person \(p\) on
item \(i\), \(\bold{F}=(f_{id})\) is a loading matrix and \(\bold{P}\)
the covariance matrix of \(\bold{\theta}_p\). The lower
asymptotes \(c_i\) and upper asymptotes \(d_i\) must be
provided as fixed values.
The response equation can be equivalently written by introducing a latent
continuous item response \(X_{pi}^\ast\)
$$ X_{pi}^\ast=f_{i0} + f_{i1} \theta_{p1} + ... +  f_{iD} \theta_{pD} + e_{pi} $$
with a standard normally distributed residual \(e_{pi}\). These residuals
have a correlation matrix \(\bold{\Psi}\) with ones in the diagonal.
In this <span style="R">R</span> implementation of the NOHARM model, correlations between residuals
are allowed.</p>
<p>The estimation relies on a Hermite series approximation of the normal ogive
item response functions. In more detail, a series expansion
$$\Phi(x)=b_0 + b_1 H_1(x) + b_2 H_2(x) + b_3 H_3(x)$$ is used
(McDonald, 1982a).
This enables to express cross products \(p_ij=P(X_i=1, X_j=1)\) as a function of
unknown model parameters
$$\hat{p}_ij=b_{0i} b_{0j} + \sum_{m=1}^3 b_{mi} b_{mj}
\left( \frac{\bold{f}_i \bold{P} \bold{f}_j }{\sqrt{ (1+\bold{f}_i \bold{P} \bold{f}_i)
(1+\bold{f}_j \bold{P} \bold{f}_j)}} \right) ^m $$
where \(b_{0i}=p_{i}=P(X_i=1)=c_i + (d_i - c_i) \Phi(\tau_i)\),
\(b_{1i}=(d_i-c_i)\phi(\tau_i)\), \(b_{2i}=(d_i-c_i)\tau_i \phi(\tau_i) / \sqrt{2}\),
and \(b_{3i}=(d_i-c_i)(\tau_i^2 - 1)\phi(\tau_i) / \sqrt{6}\).</p>
<p>The least squares criterion \(\sum_{i&lt;j} ( p_{ij} - \hat{p}_{ij})^2\) is used
for estimating unknown model parameters (McDonald, 1982a, 1982b, 1997).</p>
<p>For derivations of standard errors and fit statistics see
Maydeu-Olivares (2001) and Swaminathan and Rogers (2016).</p>
<p>For the statistical properties of the NOHARM approach see
Knol and Berger (1991), Finch (2011) or Svetina and Levy (2016).</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list. The most important entries are</p>
<dt>tanaka</dt><dd><p>Tanaka fit statistic</p></dd>
<dt>rmsr</dt><dd><p>RMSR fit statistic</p></dd>
<dt>N.itempair</dt><dd><p>Sample size per item pair</p></dd>
<dt>pm</dt><dd><p>Product moment matrix</p></dd>
<dt>wgtm</dt><dd><p>Matrix of weights for each item pair</p></dd>
<dt>sumwgtm</dt><dd><p>Sum of lower triangle matrix <code>wgtm</code></p></dd>
<dt>lower</dt><dd><p>Lower asymptotes</p></dd>
<dt>upper</dt><dd><p>Upper asymptotes</p></dd>
<dt>residuals</dt><dd><p>Residual matrix from approximation of the <code>pm</code> matrix</p></dd>
<dt>final.constants</dt><dd><p>Final constants</p></dd>
<dt>factor.cor</dt><dd><p>Covariance matrix</p></dd>
<dt>thresholds</dt><dd><p>Threshold parameters</p></dd>
<dt>uniquenesses</dt><dd><p>Uniquenesses</p></dd>
<dt>loadings</dt><dd><p>Matrix of standardized factor loadings (delta parametrization)</p></dd>
<dt>loadings.theta</dt><dd><p>Matrix of factor loadings \(\bold{F}\) (theta parametrization)</p></dd>
<dt>residcorr</dt><dd><p>Matrix of residual correlations</p></dd>
<dt>Nobs</dt><dd><p>Number of observations</p></dd>
<dt>Nitems</dt><dd><p>Number of items</p></dd>
<dt>Fpatt</dt><dd><p>Pattern loading matrix for \(\bold{F}\)</p></dd>
<dt>Ppatt</dt><dd><p>Pattern loading matrix for \(\bold{P}\)</p></dd>
<dt>Psipatt</dt><dd><p>Pattern loading matrix for \(\bold{\Psi}\)</p></dd>
<dt>dat</dt><dd><p>Used dataset</p></dd>
<dt>dimensions</dt><dd><p>Number of dimensions</p></dd>
<dt>iter</dt><dd><p>Number of iterations</p></dd>
<dt>Nestpars</dt><dd><p>Number of estimated parameters</p></dd>
<dt>chisquare</dt><dd><p>Statistic \(\chi^2\)</p></dd>
<dt>df</dt><dd><p>Degrees of freedom</p></dd>
<dt>chisquare_df</dt><dd><p>Ratio \(\chi^2 / df\)</p></dd>
<dt>rmsea</dt><dd><p>RMSEA statistic</p></dd>
<dt>p.chisquare</dt><dd><p>Significance for \(\chi^2\) statistic</p></dd>
<dt>omega.rel</dt><dd><p>Reliability of the sum score according to Green and Yang (2009)</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Finch, H. (2011). Multidimensional item response theory parameter estimation with
nonsimple structure items. <em>Applied Psychological Measurement, 35</em>(1), 67-82. <br />
https://doi.org/10.1177/0146621610367787</p>
<p>Fraser, C., &amp; McDonald, R. P. (1988). NOHARM: Least squares item factor analysis.
<em>Multivariate Behavioral Research, 23</em>, 267-269.
https://doi.org/10.1207/s15327906mbr2302_9</p>
<p>Fraser, C., &amp; McDonald, R. P. (2012). <em>NOHARM 4 Manual</em>. <br />
http://noharm.niagararesearch.ca/nh4man/nhman.html.</p>
<p>Knol, D. L., &amp; Berger, M. P. (1991). Empirical comparison between factor analysis
and multidimensional item response models. <em>Multivariate Behavioral Research, 26</em>(3),
457-477. <br /> https://doi.org/10.1207/s15327906mbr2603_5</p>
<p>Maydeu-Olivares, A. (2001). Multidimensional item response theory modeling of binary data:
Large sample properties of NOHARM estimates.
<em>Journal of Educational and Behavioral Statistics, 26</em>(1), 51-71.
https://doi.org/10.3102/10769986026001051</p>
<p>McDonald, R. P. (1982a). Linear versus nonlinear models in item response theory.
<em>Applied Psychological Measurement, 6</em>, 379-396.
https://doi.org/10.1177/014662168200600402</p>
<p>McDonald, R. P. (1982b). <em>Unidimensional and multidimensional models for
item response theory</em>. I.R.T., C.A.T. conference, Minneapolis, 1982, Proceedings.</p>
<p>McDonald, R. P. (1997). Normal-ogive multidimensional model.
In W. van der Linden &amp; R. K. Hambleton (1997):
<em>Handbook of modern item response theory</em> (pp. 257-269).
New York: Springer. http://dx.doi.org/10.1007/978-1-4757-2691-6</p>
<p>Svetina, D., &amp; Levy, R. (2016). Dimensionality in compensatory MIRT when complex structure
exists: Evaluation of DETECT and NOHARM. <em>The Journal of Experimental Education, 84</em>(2),
398-420. https://doi.org/10.1080/00220973.2015.1048845</p>
<p>Swaminathan, H., &amp; Rogers, H. J. (2016). Normal-ogive multidimensional models.
In W. J. van der Linden (Ed.). <em>Handbook of item response theory.
Volume One: Models</em> (pp. 167-187). Boca Raton: CRC Press.
http://dx.doi.org/10.1201/9781315374512</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>EAP person parameter estimates can be obtained by <code><a href='R2noharm.EAP.html'>R2noharm.EAP</a></code>.</p>
<p>Model fit can be assessed by <code><a href='modelfit.sirt.html'>modelfit.sirt</a></code>.</p>
<p>See <code><a href='R2noharm.html'>R2noharm</a></code> for running the NOHARM software from within <span style="R">R</span>.</p>
<p>See Fraser and McDonald (1988, 2012) for an implementation of the NOHARM model which
is available as freeware (http://noharm.niagararesearch.ca/;
the link seems to be broken in the meanwhile).</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Two-dimensional IRT model with 10 items</span>
<span class='co'>#############################################################################</span>

<span class='co'>#**** data simulation</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>9776</span>)
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>3400</span> <span class='co'># sample size</span>
<span class='co'># define difficulties</span>
<span class='no'>f0</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>( <span class='fl'>.5</span>, <span class='fl'>.25</span>, -<span class='fl'>.25</span>, -<span class='fl'>.5</span>, <span class='fl'>0</span>, -<span class='fl'>.5</span>, -<span class='fl'>.25</span>, <span class='fl'>.25</span>, <span class='fl'>.5</span>, <span class='fl'>0</span> )
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>f0</span>)
<span class='co'># define loadings</span>
<span class='no'>f1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fl'>0</span>, <span class='no'>I</span>, <span class='fl'>2</span> )
<span class='no'>f1</span>[ <span class='fl'>1</span>:<span class='fl'>5</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>.8</span>,<span class='fl'>.7</span>,<span class='fl'>.6</span>,<span class='fl'>.5</span>, <span class='fl'>.5</span>)
<span class='no'>f1</span>[ <span class='fl'>6</span>:<span class='fl'>10</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>.8</span>,<span class='fl'>.7</span>,<span class='fl'>.6</span>,<span class='fl'>.5</span>, <span class='fl'>.5</span> )
<span class='co'># covariance matrix</span>
<span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>.5</span>,<span class='fl'>.5</span>,<span class='fl'>1</span>), <span class='fl'>2</span>, <span class='fl'>2</span> )
<span class='co'># simulate theta</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>mvtnorm</span>)
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mvtnorm</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/mvtnorm/topics/Mvnorm'>rmvnorm</a></span>(<span class='no'>N</span>, <span class='kw'>mean</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>), <span class='kw'>sigma</span><span class='kw'>=</span><span class='no'>Pval</span> )
<span class='co'># simulate item responses</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fl'>NA</span>, <span class='no'>N</span>, <span class='no'>I</span> )
<span class='kw'>for</span> (<span class='no'>ii</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>I</span>){ <span class='co'># ii &lt;- 1</span>
    <span class='no'>dat</span>[,<span class='no'>ii</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>*( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>pnorm</a></span>(<span class='no'>f0</span>[<span class='no'>ii</span>]+<span class='no'>theta</span>[,<span class='fl'>1</span>]*<span class='no'>f1</span>[<span class='no'>ii</span>,<span class='fl'>1</span>]+<span class='no'>theta</span>[,<span class='fl'>2</span>]*<span class='no'>f1</span>[<span class='no'>ii</span>,<span class='fl'>2</span>])<span class='kw'>&gt;</span>
                     <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='no'>N</span>) )
        }
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>dat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"I"</span>, <span class='fl'>1</span>:<span class='no'>I</span>)

<span class='co'>#**** Model 1: Two-dimensional CFA with estimated item loadings</span>
<span class='co'># define pattern matrices</span>
<span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fl'>.3</span>+<span class='fl'>0</span>*<span class='no'>Pval</span>
<span class='no'>Ppatt</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>*(<span class='no'>Pval</span><span class='kw'>&gt;</span><span class='fl'>0</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>Ppatt</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>Pval</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Fval</span> <span class='kw'>&lt;-</span> <span class='fl'>.7</span> * ( <span class='no'>f1</span><span class='kw'>&gt;</span><span class='fl'>0</span>)
<span class='no'>Fpatt</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> * ( <span class='no'>Fval</span> <span class='kw'>&gt;</span> <span class='fl'>0</span> )
<span class='co'># estimate model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>, <span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod1</span>)
<span class='co'># EAP ability estimates</span>
<span class='no'>pmod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/R2noharm.EAP'>R2noharm.EAP</a></span>(<span class='no'>mod1</span>, <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(-<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>) )
<span class='co'># model fit</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>( <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/modelfit.sirt'>modelfit.sirt</a></span>( <span class='no'>mod1</span> ))

<span class='co'>#**** Model 1c: put some equality constraints</span>
<span class='no'>Fpatt</span>[ <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>4</span>),<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>Fpatt</span>[ <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>( <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>7</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>)) ] <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>mod1c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>, <span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod1c</span>)

<span class='co'># }</span><span class='co'># NOT RUN {</span>
<span class='co'>#**** Model 2: Two-dimensional CFA with correlated residuals</span>
<span class='co'># define pattern matrix for residual correlation</span>
<span class='no'>Psipatt</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>I</span>)
<span class='no'>Psipatt</span>[<span class='fl'>1</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Psival</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='no'>Psipatt</span>
<span class='co'># estimate model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>,
            <span class='kw'>Psival</span><span class='kw'>=</span><span class='no'>Psival</span>, <span class='kw'>Psipatt</span><span class='kw'>=</span><span class='no'>Psipatt</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#**** Model 3: Two-dimensional Rasch model</span>
<span class='co'># pattern matrices</span>
<span class='no'>Fval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='fl'>2</span>)
<span class='no'>Fval</span>[<span class='fl'>1</span>:<span class='fl'>5</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>6</span>:<span class='fl'>10</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Fpatt</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='no'>Fval</span>
<span class='no'>Ppatt</span> <span class='kw'>&lt;-</span> <span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span>)
<span class='no'>Pval</span>[<span class='fl'>1</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>Pval</span>[<span class='fl'>2</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='co'># estimate model</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod3</span>)
<span class='co'># model fit</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>( <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/modelfit.sirt'>modelfit.sirt</a></span>( <span class='no'>mod3</span> ))

<span class='co'>#** compare fit with NOHARM</span>
<span class='no'>noharm.path</span> <span class='kw'>&lt;-</span> <span class='st'>"c:/NOHARM"</span>
<span class='no'>P.pattern</span> <span class='kw'>&lt;-</span> <span class='no'>Ppatt</span> ; <span class='no'>P.init</span> <span class='kw'>&lt;-</span> <span class='no'>Pval</span>
<span class='no'>F.pattern</span> <span class='kw'>&lt;-</span> <span class='no'>Fpatt</span> ; <span class='no'>F.init</span> <span class='kw'>&lt;-</span> <span class='no'>Fval</span>
<span class='no'>mod3b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/R2noharm'>R2noharm</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>model.type</span><span class='kw'>=</span><span class='st'>"CFA"</span>,
             <span class='kw'>F.pattern</span><span class='kw'>=</span><span class='no'>F.pattern</span>, <span class='kw'>F.init</span><span class='kw'>=</span><span class='no'>F.init</span>, <span class='kw'>P.pattern</span><span class='kw'>=</span><span class='no'>P.pattern</span>,
             <span class='kw'>P.init</span><span class='kw'>=</span><span class='no'>P.init</span>, <span class='kw'>writename</span><span class='kw'>=</span><span class='st'>"example_sim_2dim_rasch"</span>,
             <span class='kw'>noharm.path</span><span class='kw'>=</span><span class='no'>noharm.path</span>, <span class='kw'>dec</span><span class='kw'>=</span><span class='st'>","</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod3b</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 2: data.read</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>data.read</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.read</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>dat</span>)

<span class='co'>#**** Model 1: Unidimensional Rasch model</span>
<span class='no'>Fpatt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fl'>0</span>, <span class='no'>I</span>, <span class='fl'>1</span> )
<span class='no'>Fval</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> + <span class='fl'>0</span>*<span class='no'>Fpatt</span>
<span class='no'>Ppatt</span> <span class='kw'>&lt;-</span> <span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>)
<span class='co'># estimate model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>mod1</span>)    <span class='co'># semPaths plot</span>

<span class='co'>#**** Model 2: Rasch model in which item pairs within a testlet are excluded</span>
<span class='no'>wgtm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fl'>1</span>, <span class='no'>I</span>, <span class='no'>I</span> )
<span class='no'>wgtm</span>[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>1</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>wgtm</span>[<span class='fl'>5</span>:<span class='fl'>8</span>,<span class='fl'>5</span>:<span class='fl'>8</span>] <span class='kw'>&lt;-</span> <span class='no'>wgtm</span>[ <span class='fl'>9</span>:<span class='fl'>12</span>, <span class='fl'>9</span>:<span class='fl'>12</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='co'># estimation</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>(<span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>, <span class='kw'>wgtm</span><span class='kw'>=</span><span class='no'>wgtm</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#**** Model 3: Rasch model with correlated residuals</span>
<span class='no'>Psipatt</span> <span class='kw'>&lt;-</span> <span class='no'>Psival</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>I</span>)
<span class='no'>Psipatt</span>[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>1</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>Psipatt</span>[<span class='fl'>5</span>:<span class='fl'>8</span>,<span class='fl'>5</span>:<span class='fl'>8</span>] <span class='kw'>&lt;-</span> <span class='no'>Psipatt</span>[ <span class='fl'>9</span>:<span class='fl'>12</span>, <span class='fl'>9</span>:<span class='fl'>12</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>Psipatt</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>Psival</span> <span class='kw'>&lt;-</span> <span class='fl'>.6</span>*(<span class='no'>Psipatt</span><span class='kw'>&gt;</span><span class='fl'>0</span>)
<span class='co'># estimation</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>,
            <span class='kw'>Psival</span><span class='kw'>=</span><span class='no'>Psival</span>, <span class='kw'>Psipatt</span><span class='kw'>=</span><span class='no'>Psipatt</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod3</span>)
<span class='co'># allow only positive residual correlations</span>
<span class='no'>mod3b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>, <span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>,
            <span class='kw'>Psival</span><span class='kw'>=</span><span class='no'>Psival</span>, <span class='kw'>Psipatt</span><span class='kw'>=</span><span class='no'>Psipatt</span>, <span class='kw'>pos.residcorr</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod3b</span>)
<span class='co'>#* constrain residual correlations</span>
<span class='no'>Psipatt</span>[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>1</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>Psipatt</span>[<span class='fl'>5</span>:<span class='fl'>8</span>,<span class='fl'>5</span>:<span class='fl'>8</span>] <span class='kw'>&lt;-</span> <span class='fl'>3</span>
<span class='no'>Psipatt</span>[ <span class='fl'>9</span>:<span class='fl'>12</span>, <span class='fl'>9</span>:<span class='fl'>12</span>] <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>mod3c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>, <span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>,
            <span class='kw'>Psival</span><span class='kw'>=</span><span class='no'>Psival</span>, <span class='kw'>Psipatt</span><span class='kw'>=</span><span class='no'>Psipatt</span>, <span class='kw'>pos.residcorr</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod3c</span>)

<span class='co'>#**** Model 4: Rasch testlet model</span>
<span class='no'>Fval</span> <span class='kw'>&lt;-</span> <span class='no'>Fpatt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fl'>0</span>, <span class='no'>I</span>, <span class='fl'>4</span> )
<span class='no'>Fval</span>[,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>5</span>:<span class='fl'>8</span>,<span class='fl'>3</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>9</span>:<span class='fl'>12</span>,<span class='fl'>4</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Ppatt</span> <span class='kw'>&lt;-</span> <span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>4</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>Ppatt</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"g"</span>, <span class='st'>"A"</span>, <span class='st'>"B"</span>,<span class='st'>"C"</span>)
<span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fl'>.5</span>*<span class='no'>Pval</span>
<span class='co'># estimation</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>  )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod4</span>)
<span class='co'># allow only positive variance entries</span>
<span class='no'>mod4b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>,
               <span class='kw'>pos.variance</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod4b</span>)

<span class='co'>#**** Model 5: Bifactor model</span>
<span class='no'>Fval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fl'>0</span>, <span class='no'>I</span>, <span class='fl'>4</span> )
<span class='no'>Fval</span>[,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>5</span>:<span class='fl'>8</span>,<span class='fl'>3</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>9</span>:<span class='fl'>12</span>,<span class='fl'>4</span> ] <span class='kw'>&lt;-</span> <span class='fl'>.6</span>
<span class='no'>Fpatt</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> * ( <span class='no'>Fval</span> <span class='kw'>&gt;</span> <span class='fl'>0</span> )
<span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>4</span>)
<span class='no'>Ppatt</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='no'>Pval</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>Ppatt</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"g"</span>, <span class='st'>"A"</span>, <span class='st'>"B"</span>,<span class='st'>"C"</span>)
<span class='co'># estimation</span>
<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>  )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod5</span>)
<span class='co'># allow only positive loadings</span>
<span class='no'>mod5b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>,
              <span class='kw'>pos.loading</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod5b</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>( <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/modelfit.sirt'>modelfit.sirt</a></span>(<span class='no'>mod5b</span>))

<span class='co'>#**** Model 6: 3-dimensional Rasch model</span>
<span class='no'>Fval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fl'>0</span>, <span class='no'>I</span>, <span class='fl'>3</span> )
<span class='no'>Fval</span>[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>5</span>:<span class='fl'>8</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>9</span>:<span class='fl'>12</span>,<span class='fl'>3</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Fpatt</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='no'>Fval</span>
<span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fl'>.6</span>*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>3</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>Pval</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Ppatt</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>+<span class='fl'>0</span>*<span class='no'>Pval</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>Ppatt</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>,<span class='st'>"C"</span>)
<span class='co'># estimation</span>
<span class='no'>mod6</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>  )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod6</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>( <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/modelfit.sirt'>modelfit.sirt</a></span>(<span class='no'>mod6</span>) )  <span class='co'># model fit</span>

<span class='co'>#**** Model 7: 3-dimensional 2PL model</span>
<span class='no'>Fval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>( <span class='fl'>0</span>, <span class='no'>I</span>, <span class='fl'>3</span> )
<span class='no'>Fval</span>[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>5</span>:<span class='fl'>8</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='no'>Fval</span>[<span class='fl'>9</span>:<span class='fl'>12</span>,<span class='fl'>3</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Fpatt</span> <span class='kw'>&lt;-</span> <span class='no'>Fval</span>
<span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fl'>.6</span>*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='fl'>3</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>Pval</span>) <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Ppatt</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>+<span class='fl'>0</span>*<span class='no'>Pval</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/diag'>diag</a></span>(<span class='no'>Ppatt</span>) <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>Ppatt</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>,<span class='st'>"C"</span>)
<span class='co'># estimation</span>
<span class='no'>mod7</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,<span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>  )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod7</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>( <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/modelfit.sirt'>modelfit.sirt</a></span>(<span class='no'>mod7</span>) )

<span class='co'>#**** Model 8: Exploratory factor analysis with 3 dimensions</span>
<span class='co'># estimation</span>
<span class='no'>mod8</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>( <span class='kw'>dat</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>dimensions</span><span class='kw'>=</span><span class='fl'>3</span>  )
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod8</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 3: Product-moment matrix input, McDonald (1997)</span>
<span class='co'>#############################################################################</span>

<span class='co'># data from Table 1 of McDonald (1997, p. 266)</span>
<span class='no'>pm0</span> <span class='kw'>&lt;-</span> <span class='st'>"
0.828
0.567 0.658
0.664 0.560 0.772
0.532 0.428 0.501 0.606
0.718 0.567 0.672 0.526 0.843
"</span>
<span class='no'>pm</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>miceadds</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/miceadds/topics/filename_split'>string_to_matrix</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='no'>pm0</span>, <span class='kw'>as_numeric</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>extend</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>pm</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames</a></span>(<span class='no'>pm</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>pm</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"I"</span>, <span class='fl'>1</span>:<span class='no'>I</span>)

<span class='co'>#- Model 1: Unidimensional model</span>
<span class='no'>Fval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>.7</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>I</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='no'>Fpatt</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>+<span class='fl'>0</span>*<span class='no'>Fval</span>
<span class='no'>Pval</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>1</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='no'>Ppatt</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='no'>Pval</span>

<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>(<span class='kw'>pm</span><span class='kw'>=</span><span class='no'>pm</span>, <span class='kw'>N</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#- Model 2: Twodimensional exploratory model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>(<span class='kw'>pm</span><span class='kw'>=</span><span class='no'>pm</span>, <span class='kw'>N</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>dimensions</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#- Model 3: Unidimensional model with correlated residuals</span>
<span class='no'>Psival</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>I</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span>)
<span class='no'>Psipatt</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>*<span class='no'>Psival</span>
<span class='no'>Psipatt</span>[<span class='fl'>5</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>

<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/sirt/topics/noharm.sirt'>noharm.sirt</a></span>(<span class='kw'>pm</span><span class='kw'>=</span><span class='no'>pm</span>, <span class='kw'>N</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>Fval</span><span class='kw'>=</span><span class='no'>Fval</span>, <span class='kw'>Fpatt</span><span class='kw'>=</span><span class='no'>Fpatt</span>, <span class='kw'>Pval</span><span class='kw'>=</span><span class='no'>Pval</span>, <span class='kw'>Ppatt</span><span class='kw'>=</span><span class='no'>Ppatt</span>,
            <span class='kw'>Psival</span><span class='kw'>=</span><span class='no'>Psival</span>, <span class='kw'>Psipatt</span><span class='kw'>=</span><span class='no'>Psipatt</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod3</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

