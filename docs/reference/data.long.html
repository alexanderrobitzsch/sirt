<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Longitudinal Dataset — data.long • sirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Longitudinal Dataset — data.long" />
<meta property="og:description" content="This dataset contains 200 observations on
12 items. 6 items (I1T1, ...,I6T1)
were administered at measurement occasion T1
and 6 items at T2 (I3T2, ..., I8T2). There were 4 anchor items
which were presented at both time points.
The first column in the dataset contains the student identifier." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.11-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Longitudinal Dataset</h1>
    
    <div class="hidden name"><code>data.long.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This dataset contains 200 observations on
12 items. 6 items (<code>I1T1</code>, ...,<code>I6T1</code>)
were administered at measurement occasion T1
and 6 items at T2 (<code>I3T2</code>, ..., <code>I8T2</code>). There were 4 anchor items
which were presented at both time points.
The first column in the dataset contains the student identifier.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.long</span>)</pre>


    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p>The format of the dataset is</p>
<p><code>'data.frame':   200 obs. of  13 variables:</code> <br />
<code> $ idstud: int  1001 1002 1003 1004 1005 1006 1007 1008 1009 1010 ...</code> <br />
<code> $ I1T1  : int  1 1 1 1 1 1 1 0 1 1 ...</code> <br />
<code> $ I2T1  : int  0 0 1 1 1 1 0 1 1 1 ...</code> <br />
<code> $ I3T1  : int  1 0 1 1 0 1 0 0 0 0 ...</code> <br />
<code> $ I4T1  : int  1 0 0 1 0 0 0 0 1 1 ...</code> <br />
<code> $ I5T1  : int  1 0 0 1 0 0 0 0 1 0 ...</code> <br />
<code> $ I6T1  : int  1 0 0 0 0 0 0 0 0 0 ...</code> <br />
<code> $ I3T2  : int  1 1 0 0 1 1 1 1 0 1 ...</code> <br />
<code> $ I4T2  : int  1 1 0 0 1 1 0 0 0 1 ...</code> <br />
<code> $ I5T2  : int  1 0 1 1 1 1 1 0 1 1 ...</code> <br />
<code> $ I6T2  : int  1 1 0 0 0 0 0 0 0 1 ...</code> <br />
<code> $ I7T2  : int  1 0 0 0 0 0 0 0 0 1 ...</code> <br />
<code> $ I8T2  : int  0 0 0 0 1 0 0 0 0 0 ...</code> <br /></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.long</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.long</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>[,-<span class='fl'>1</span>]
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)

<span class='co'>#*************************************************</span>
<span class='co'># Model 1: 2-dimensional Rasch model</span>
<span class='co'>#*************************************************</span>
<span class='co'># define Q-matrix</span>
<span class='no'>Q</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0</span>,<span class='no'>I</span>,<span class='fl'>2</span>)
<span class='no'>Q</span>[<span class='fl'>1</span>:<span class='fl'>6</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Q</span>[<span class='fl'>7</span>:<span class='fl'>12</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>Q</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>)
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>Q</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"T1"</span>,<span class='st'>"T2"</span>)

<span class='co'># vector with same items</span>
<span class='no'>itemnr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>),<span class='fl'>2</span>,<span class='fl'>2</span>) )
<span class='co'># fix mean at T2 to zero</span>
<span class='no'>mu.fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='fl'>2</span>,<span class='fl'>0</span> )

<span class='co'>#--- M1a: rasch.mml2 (in sirt)</span>
<span class='no'>mod1a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>(<span class='no'>dat</span>, <span class='kw'>Q</span><span class='kw'>=</span><span class='no'>Q</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>itemnr</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='no'>mu.fixed</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1a</span>)

<span class='co'>#--- M1b: smirt (in sirt)</span>
<span class='no'>mod1b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='smirt.html'>smirt</a></span>(<span class='no'>dat</span>, <span class='kw'>Qmatrix</span><span class='kw'>=</span><span class='no'>Q</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"comp"</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>itemnr</span>,
                  <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='no'>mu.fixed</span> )

<span class='co'>#--- M1c: tam.mml (in TAM)</span>

<span class='co'># assume equal item difficulty of I3T1 and I3T2, I4T1 and I4T2, ...</span>
<span class='co'># create draft design matrix and modify it</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/designMatrices.html'>designMatrices</a></span>(<span class='kw'>resp</span><span class='kw'>=</span><span class='no'>dat</span>)$<span class='no'>A</span>
<span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span>(<span class='no'>A</span>)<span class='kw'>[[</span><span class='fl'>1</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>)
  <span class='co'>##   &gt; str(A)</span>
  <span class='co'>##    num [1:12, 1:2, 1:12] 0 0 0 0 0 0 0 0 0 0 ...</span>
  <span class='co'>##    - attr(*, "dimnames")=List of 3</span>
  <span class='co'>##     ..$ : chr [1:12] "Item01" "Item02" "Item03" "Item04" ...</span>
  <span class='co'>##     ..$ : chr [1:2] "Category0" "Category1"</span>
  <span class='co'>##     ..$ : chr [1:12] "I1T1" "I2T1" "I3T1" "I4T1" ...</span>
<span class='no'>A1</span> <span class='kw'>&lt;-</span> <span class='no'>A</span>[,, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fl'>6</span>, <span class='fl'>11</span>:<span class='fl'>12</span> ) ]
<span class='no'>A1</span>[<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>3</span>] <span class='kw'>&lt;-</span> -<span class='fl'>1</span>     <span class='co'># difficulty(I3T1)=difficulty(I3T2)</span>
<span class='no'>A1</span>[<span class='fl'>8</span>,<span class='fl'>2</span>,<span class='fl'>4</span>] <span class='kw'>&lt;-</span> -<span class='fl'>1</span>     <span class='co'># I4T1=I4T2</span>
<span class='no'>A1</span>[<span class='fl'>9</span>,<span class='fl'>2</span>,<span class='fl'>5</span>] <span class='kw'>&lt;-</span> <span class='no'>A1</span>[<span class='fl'>10</span>,<span class='fl'>2</span>,<span class='fl'>6</span>] <span class='kw'>&lt;-</span> -<span class='fl'>1</span>
<span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span>(<span class='no'>A1</span>)<span class='kw'>[[</span><span class='fl'>3</span>]] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/dimnames.html'>dimnames</a></span>(<span class='no'>A1</span>)<span class='kw'>[[</span><span class='fl'>3</span>]],<span class='fl'>1</span>,<span class='fl'>2</span>)
  <span class='co'>##   &gt; A1[,2,]</span>
  <span class='co'>##        I1 I2 I3 I4 I5 I6 I7 I8</span>
  <span class='co'>##   I1T1 -1  0  0  0  0  0  0  0</span>
  <span class='co'>##   I2T1  0 -1  0  0  0  0  0  0</span>
  <span class='co'>##   I3T1  0  0 -1  0  0  0  0  0</span>
  <span class='co'>##   I4T1  0  0  0 -1  0  0  0  0</span>
  <span class='co'>##   I5T1  0  0  0  0 -1  0  0  0</span>
  <span class='co'>##   I6T1  0  0  0  0  0 -1  0  0</span>
  <span class='co'>##   I3T2  0  0 -1  0  0  0  0  0</span>
  <span class='co'>##   I4T2  0  0  0 -1  0  0  0  0</span>
  <span class='co'>##   I5T2  0  0  0  0 -1  0  0  0</span>
  <span class='co'>##   I6T2  0  0  0  0  0 -1  0  0</span>
  <span class='co'>##   I7T2  0  0  0  0  0  0 -1  0</span>
  <span class='co'>##   I8T2  0  0  0  0  0  0  0 -1</span>

<span class='co'># estimate model</span>
<span class='co'># set intercept of second dimension (T2) to zero</span>
<span class='no'>beta.fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>0</span> )
<span class='no'>mod1c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.mml.html'>tam.mml</a></span>( <span class='kw'>resp</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>Q</span><span class='kw'>=</span><span class='no'>Q</span>, <span class='kw'>A</span><span class='kw'>=</span><span class='no'>A1</span>, <span class='kw'>beta.fixed</span><span class='kw'>=</span><span class='no'>beta.fixed</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1c</span>)

<span class='co'>#*************************************************</span>
<span class='co'># Model 2: 2-dimensional 2PL model</span>
<span class='co'>#*************************************************</span>

<span class='co'># set variance at T2 to 1</span>
<span class='no'>variance.fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>1</span>)

<span class='co'># M2a: rasch.mml2 (in sirt)</span>
<span class='no'>mod2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>(<span class='no'>dat</span>, <span class='kw'>Q</span><span class='kw'>=</span><span class='no'>Q</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>itemnr</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='no'>itemnr</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='no'>mu.fixed</span>,
             <span class='kw'>variance.fixed</span><span class='kw'>=</span><span class='no'>variance.fixed</span>, <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>100</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2a</span>)

<span class='co'>#*************************************************</span>
<span class='co'># Model 3: Concurrent calibration by assuming invariant item parameters</span>
<span class='co'>#*************************************************</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>mirt</span>)   <span class='co'># use mirt for concurrent calibration</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.long</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.long</span>[,-<span class='fl'>1</span>]
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)

<span class='co'># create user defined function for between item dimensionality 4PL model</span>
<span class='no'>name</span> <span class='kw'>&lt;-</span> <span class='st'>"4PLbw"</span>
<span class='no'>par</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"low"</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='st'>"upp"</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='st'>"a"</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='st'>"d"</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='st'>"dimItem"</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='no'>est</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>TRUE</span>, <span class='fl'>TRUE</span>,<span class='fl'>TRUE</span>,<span class='fl'>TRUE</span>,<span class='fl'>FALSE</span>)
<span class='co'># item response function</span>
<span class='no'>irf</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>par</span>,<span class='no'>Theta</span>,<span class='no'>ncat</span>){
     <span class='no'>low</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>1</span>]
     <span class='no'>upp</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>2</span>]
     <span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>3</span>]
     <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>4</span>]
     <span class='no'>dimItem</span> <span class='kw'>&lt;-</span> <span class='no'>par</span>[<span class='fl'>5</span>]
     <span class='no'>P1</span> <span class='kw'>&lt;-</span> <span class='no'>low</span> + ( <span class='no'>upp</span> - <span class='no'>low</span> ) * <span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>( <span class='no'>a</span>*<span class='no'>Theta</span>[,<span class='no'>dimItem</span>] + <span class='no'>d</span> )
     <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fl'>1</span>-<span class='no'>P1</span>, <span class='no'>P1</span>)
}

<span class='co'># create item response function</span>
<span class='no'>fourPLbetw</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/createItem.html'>createItem</a></span>(<span class='no'>name</span>, <span class='kw'>par</span><span class='kw'>=</span><span class='no'>par</span>, <span class='kw'>est</span><span class='kw'>=</span><span class='no'>est</span>, <span class='kw'>P</span><span class='kw'>=</span><span class='no'>irf</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>dat</span>)

<span class='co'># create mirt model (use variable names in mirt.model)</span>
<span class='no'>mirtsyn</span> <span class='kw'>&lt;-</span> <span class='st'>"
     T1=I1T1,I2T1,I3T1,I4T1,I5T1,I6T1
     T2=I3T2,I4T2,I5T2,I6T2,I7T2,I8T2
     COV=T1*T2,,T2*T2
     MEAN=T1
     CONSTRAIN=(I3T1,I3T2,d),(I4T1,I4T2,d),(I5T1,I5T2,d),(I6T1,I6T2,d),
                 (I3T1,I3T2,a),(I4T1,I4T2,a),(I5T1,I5T2,a),(I6T1,I6T2,a)
        "</span>
<span class='co'># create mirt model</span>
<span class='no'>mirtmodel</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.model.html'>mirt.model</a></span>( <span class='no'>mirtsyn</span>, <span class='kw'>itemnames</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>) )
<span class='co'># define parameters to be estimated</span>
<span class='no'>mod3.pars</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.html'>mirt</a></span>(<span class='no'>dat</span>, <span class='no'>mirtmodel</span>$<span class='no'>model</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='st'>"4PLbw"</span>,<span class='no'>I</span>),
                   <span class='kw'>customItems</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"4PLbw"</span><span class='kw'>=</span><span class='no'>fourPLbetw</span>), <span class='kw'>pars</span><span class='kw'>=</span><span class='st'>"values"</span>)
<span class='co'># select dimensions</span>
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>(<span class='st'>"T2"</span>,<span class='no'>mod3.pars</span>$<span class='no'>item</span>), <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>mod3.pars</span>$<span class='no'>name</span><span class='kw'>==</span><span class='st'>"dimItem"</span> ) )
<span class='no'>mod3.pars</span>[<span class='no'>ind</span>,<span class='st'>"value"</span>] <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='co'># set item parameters low and upp to non-estimated</span>
<span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>mod3.pars</span>$<span class='no'>name</span> <span class='kw'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"low"</span>,<span class='st'>"upp"</span>) )
<span class='no'>mod3.pars</span>[<span class='no'>ind</span>,<span class='st'>"est"</span>] <span class='kw'>&lt;-</span> <span class='fl'>FALSE</span>

<span class='co'># estimate 2PL model</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.html'>mirt</a></span>(<span class='no'>dat</span>, <span class='no'>mirtmodel</span>$<span class='no'>model</span>, <span class='kw'>itemtype</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='st'>"4PLbw"</span>,<span class='no'>I</span>),
                <span class='kw'>customItems</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"4PLbw"</span><span class='kw'>=</span><span class='no'>fourPLbetw</span>), <span class='kw'>pars</span><span class='kw'>=</span><span class='no'>mod3.pars</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
                <span class='kw'>technical</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>NCYCLES</span><span class='kw'>=</span><span class='fl'>50</span>)  )
<span class='fu'><a href='mirt.wrapper.html'>mirt.wrapper.coef</a></span>(<span class='no'>mod3</span>)

<span class='co'>#****** estimate model in lavaan</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>lavaan</span>)

<span class='co'># specify syntax</span>
<span class='no'>lavmodel</span> <span class='kw'>&lt;-</span> <span class='st'>"
             #**** T1
             F1=~ a1*I1T1+a2*I2T1+a3*I3T1+a4*I4T1+a5*I5T1+a6*I6T1
             I1T1 | b1*t1 ; I2T1 | b2*t1 ; I3T1 | b3*t1 ; I4T1 | b4*t1
             I5T1 | b5*t1 ; I6T1 | b6*t1
             F1 ~~ 1*F1
             #**** T2
             F2=~ a3*I3T2+a4*I4T2+a5*I5T2+a6*I6T2+a7*I7T2+a8*I8T2
             I3T2 | b3*t1 ; I4T2 | b4*t1 ; I5T2 | b5*t1 ; I6T2 | b6*t1
             I7T2 | b7*t1 ; I8T2 | b8*t1
             F2 ~~ NA*F2
             F2 ~ 1
             #*** covariance
             F1 ~~ F2
                "</span>
<span class='co'># estimate model using theta parameterization</span>
<span class='no'>mod3lav</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>lavaan</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/cfa.html'>cfa</a></span>( <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dat</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='no'>lavmodel</span>,
            <span class='kw'>std.lv</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>ordered</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>), <span class='kw'>parameterization</span><span class='kw'>=</span><span class='st'>"theta"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3lav</span>, <span class='kw'>standardized</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>fit.measures</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>rsquare</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='co'>#*************************************************</span>
<span class='co'># Model 4: Linking with items of different item slope groups</span>
<span class='co'>#*************************************************</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.long</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.long</span>
<span class='co'># dataset for T1</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>[, <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>( <span class='st'>"T1"</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>) ) ]
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span>(<span class='st'>"T1"</span>,<span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat1</span>) )
<span class='co'># dataset for T2</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>[, <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>( <span class='st'>"T2"</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>) ) ]
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span>(<span class='st'>"T2"</span>,<span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat2</span>) )

<span class='co'># 2PL model with slope groups T1</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat1</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>,<span class='fl'>4</span>) ) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'># 2PL model with slope groups T2</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rasch.mml.html'>rasch.mml2</a></span>( <span class='no'>dat2</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>4</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>) ) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#------- Link 1: Haberman Linking</span>
<span class='co'># collect item parameters</span>
<span class='no'>dfr1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study1"</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='no'>dfr2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='st'>"study2"</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>item</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>a</span>, <span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dfr1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"study"</span>, <span class='st'>"item"</span>, <span class='st'>"a"</span>, <span class='st'>"b"</span> )
<span class='no'>itempars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='no'>dfr1</span>, <span class='no'>dfr2</span> )
<span class='co'># Linking</span>
<span class='no'>link1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='linking.haberman.html'>linking.haberman</a></span>(<span class='kw'>itempars</span><span class='kw'>=</span><span class='no'>itempars</span>)

<span class='co'>#------- Link 2: Invariance alignment method</span>
<span class='co'># create objects for invariance.alignment</span>
<span class='no'>nu</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>thresh</span>,<span class='fl'>NA</span>,<span class='fl'>NA</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>NA</span>,<span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>thresh</span>) )
<span class='no'>lambda</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>a</span>,<span class='fl'>NA</span>,<span class='fl'>NA</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>,<span class='fl'>NA</span>,<span class='no'>mod2</span>$<span class='no'>item</span>$<span class='no'>a</span> ) )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>lambda</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>nu</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"I"</span>,<span class='fl'>1</span>:<span class='fl'>8</span>)
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>lambda</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>nu</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"T1"</span>, <span class='st'>"T2"</span>)
<span class='co'># Linking</span>
<span class='no'>link2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='invariance.alignment.html'>invariance.alignment</a></span>( <span class='no'>lambda</span>, <span class='no'>nu</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>link2a</span>)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


