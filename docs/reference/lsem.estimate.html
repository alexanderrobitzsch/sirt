<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Local Structural Equation Models (LSEM) — lsem.estimate • sirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Local Structural Equation Models (LSEM) — lsem.estimate" />
<meta property="og:description" content="Local structural equation models (LSEM) are structural equation models (SEM)
which are evaluated for each value of a pre-defined moderator variable
(Hildebrandt, Wilhelm, &amp;amp; Robitzsch, 2009; Hildebrandt, Luedtke, Robitzsch,
Sommer &amp;amp; Wilhelm, 2016).
As in nonparametric regression models, observations near a focal point - at
which the model is evaluated - obtain higher weights, far distant observations
obtain lower weights. The LSEM can be specified by making use of lavaan syntax.
It is also possible to specify a discretized version of LSEM in which
values of the moderator are grouped and a multiple group SEM is specified.
The LSEM can be tested by employing a permutation test, see
lsem.permutationTest.
The function lsem.MGM.stepfunctions outputs stepwise functions
for a multiple group model evaluated at a grid of focal points of the
moderator, specified in moderator.grid.
The argument pseudo_weights provides an ad hoc solution to estimate
an LSEM for any model which can be fitted in lavaan.
It is also possible to constrain some of the parameters along the values
of the moderator in a joint estimation approach (est_joint=TRUE). Parameter
names can be specified which are assumed to be invariant (in par_invariant).
In addition, linear or quadratic constraints can be imposed on
parameters (par_linear or par_quadratic).
Statistical inference in case of joint estimation (but also for separate estimation)
can be conducted via bootstrap using the function lsem.bootstrap.
Bootstrap at the level of a cluster identifier is allowed (argument cluster)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.13-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Local Structural Equation Models (LSEM)</h1>
    
    <div class="hidden name"><code>lsem.estimate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Local structural equation models (LSEM) are structural equation models (SEM)
which are evaluated for each value of a pre-defined moderator variable
(Hildebrandt, Wilhelm, &amp; Robitzsch, 2009; Hildebrandt, Luedtke, Robitzsch,
Sommer &amp; Wilhelm, 2016).
As in nonparametric regression models, observations near a focal point - at
which the model is evaluated - obtain higher weights, far distant observations
obtain lower weights. The LSEM can be specified by making use of <span class="pkg">lavaan</span> syntax.
It is also possible to specify a discretized version of LSEM in which
values of the moderator are grouped and a multiple group SEM is specified.
The LSEM can be tested by employing a permutation test, see
<code><a href='lsem.permutationTest.html'>lsem.permutationTest</a></code>.</p>
<p>The function <code>lsem.MGM.stepfunctions</code> outputs stepwise functions
for a multiple group model evaluated at a grid of focal points of the
moderator, specified in <code>moderator.grid</code>.</p>
<p>The argument <code>pseudo_weights</code> provides an ad hoc solution to estimate
an LSEM for any model which can be fitted in <span class="pkg">lavaan</span>.</p>
<p>It is also possible to constrain some of the parameters along the values
of the moderator in a joint estimation approach (<code>est_joint=TRUE</code>). Parameter
names can be specified which are assumed to be invariant (in <code>par_invariant</code>).
In addition, linear or quadratic constraints can be imposed on
parameters (<code>par_linear</code> or <code>par_quadratic</code>).</p>
<p>Statistical inference in case of joint estimation (but also for separate estimation)
can be conducted via bootstrap using the function <code>lsem.bootstrap</code>.
Bootstrap at the level of a cluster identifier is allowed (argument <code>cluster</code>).</p>
    </div>

    <pre class="usage"><span class='fu'>lsem.estimate</span>(<span class='no'>data</span>, <span class='no'>moderator</span>, <span class='no'>moderator.grid</span>, <span class='no'>lavmodel</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"LSEM"</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>1.1</span>, <span class='kw'>bw</span><span class='kw'>=</span><span class='kw'>NULL</span>,
    <span class='kw'>residualize</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>fit_measures</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"rmsea"</span>, <span class='st'>"cfi"</span>, <span class='st'>"tli"</span>, <span class='st'>"gfi"</span>, <span class='st'>"srmr"</span>),
    <span class='kw'>standardized</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>standardized_type</span><span class='kw'>=</span><span class='st'>"std.all"</span>, <span class='kw'>lavaan_fct</span><span class='kw'>=</span><span class='st'>"sem"</span>,
    <span class='kw'>sufficient_statistics</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>use_lavaan_survey</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>pseudo_weights</span><span class='kw'>=</span><span class='fl'>0</span>,
    <span class='kw'>sampling_weights</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>loc_linear_smooth</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>est_joint</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>par_invariant</span><span class='kw'>=</span><span class='kw'>NULL</span>,
    <span class='kw'>par_linear</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>par_quadratic</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>partable_joint</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>se</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>kernel</span><span class='kw'>=</span><span class='st'>"gaussian"</span>,
    <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-08</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for lsem</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='kw'>file</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='no'>...</span>)

<span class='co'># S3 method for lsem</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>parindex</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>ask</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>ci</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>lintrend</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
       <span class='kw'>parsummary</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='kw'>NULL</span>,  <span class='kw'>ylab</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='kw'>NULL</span>,
       <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='no'>...</span>)

<span class='fu'>lsem.MGM.stepfunctions</span>( <span class='no'>object</span>, <span class='no'>moderator.grid</span> )

<span class='co'># compute local weights</span>
<span class='fu'>lsem_local_weights</span>(<span class='no'>data.mod</span>, <span class='no'>moderator.grid</span>, <span class='no'>h</span>, <span class='kw'>sampling_weights</span><span class='kw'>=</span><span class='kw'>NULL</span>,  <span class='kw'>bw</span><span class='kw'>=</span><span class='kw'>NULL</span>,
     <span class='kw'>kernel</span><span class='kw'>=</span><span class='st'>"gaussian"</span>)

<span class='fu'>lsem.bootstrap</span>(<span class='no'>object</span>, <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>cluster</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>1</span>,
     <span class='kw'>repl_design</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>repl_factor</span><span class='kw'>=</span><span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Data frame</p></td>
    </tr>
    <tr>
      <th>moderator</th>
      <td><p>Variable name of the moderator</p></td>
    </tr>
    <tr>
      <th>moderator.grid</th>
      <td><p>Focal points at which the LSEM should be evaluated. If <code>type="MGM"</code>,
breaks are defined in this vector.</p></td>
    </tr>
    <tr>
      <th>lavmodel</th>
      <td><p>Specified SEM in <span class="pkg">lavaan</span>.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of estimated model. The default is <code>type="LSEM"</code> which means
    that a local structural equation model is estimated.
    A multiple group model with a discretized moderator as the
    grouping variable can be estimated with <code>type="MGM"</code>. In this
    case, the breaks must be defined in <code>moderator.grid</code>.</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>Bandwidth factor</p></td>
    </tr>
    <tr>
      <th>bw</th>
      <td><p>Optional bandwidth parameter if <code>h</code> should not be used</p></td>
    </tr>
    <tr>
      <th>residualize</th>
      <td><p>Logical indicating whether a residualization
    should be applied.</p></td>
    </tr>
    <tr>
      <th>fit_measures</th>
      <td><p>Vector with names of fit measures following the labels in <span class="pkg">lavaan</span></p></td>
    </tr>
    <tr>
      <th>standardized</th>
      <td><p>Optional logical indicating whether
 standardized solution should be included as parameters in
 the output using the
<code><a href='https://rdrr.io/pkg/lavaan/man/standardizedSolution.html'>lavaan::standardizedSolution</a></code>
function. Standardized parameters are labeled as <code>std__</code>.</p></td>
    </tr>
    <tr>
      <th>standardized_type</th>
      <td><p>Type of standardization if <code>standardized=TRUE</code>.
The types are described in
<code><a href='https://rdrr.io/pkg/lavaan/man/standardizedSolution.html'>lavaan::standardizedSolution</a></code>.</p></td>
    </tr>
    <tr>
      <th>lavaan_fct</th>
      <td><p>String whether
<code><a href='https://rdrr.io/pkg/lavaan/man/lavaan.html'>lavaan::lavaan</a></code> (<code>lavaan_fct="lavaan"</code>),
<code><a href='https://rdrr.io/pkg/lavaan/man/sem.html'>lavaan::sem</a></code> (<code>lavaan_fct="sem"</code>),
<code><a href='https://rdrr.io/pkg/lavaan/man/cfa.html'>lavaan::cfa</a></code> (<code>lavaan_fct="cfa"</code>) or
<code><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>lavaan::growth</a></code> (<code>lavaan_fct="growth"</code>)
should be used.</p></td>
    </tr>
    <tr>
      <th>sufficient_statistics</th>
      <td><p>Logical whether sufficient statistics of weighted
means and covariances should be used for model fitting. This option
must be used if the data contain missing values. Note that this approach is
only valid for missing completely at random (MCAR) data.
The option can only be used for continuous data.</p></td>
    </tr>
    <tr>
      <th>use_lavaan_survey</th>
      <td><p>Logical indicating whether estimation should be
conducted with <span class="pkg">lavaan.survey</span> package.</p></td>
    </tr>
    <tr>
      <th>pseudo_weights</th>
      <td><p>Integer defining a target sample size. Local weights
are multiplied by a factor which is rounded to integers.
This approach is referred as a pseudo weighting approach.
For example, using <code>pseudo_weights=30000</code> implies
that the sum of local weights at each focal point is <code>30000</code>.</p></td>
    </tr>
    <tr>
      <th>sampling_weights</th>
      <td><p>Optional vector of sampling weights</p></td>
    </tr>
    <tr>
      <th>loc_linear_smooth</th>
      <td><p>Logical indicating whether local linear
smoothing should be used for computing sufficient statistics for
means and covariances. The default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>est_joint</th>
      <td><p>Logical indicating whether LSEM should be estimated in a
joint estimation approach. This options only works wih continuous data and
sufficient statistics.</p></td>
    </tr>
    <tr>
      <th>par_invariant</th>
      <td><p>Vector of invariant parameters</p></td>
    </tr>
    <tr>
      <th>par_linear</th>
      <td><p>Vector of parameters with linear function</p></td>
    </tr>
    <tr>
      <th>par_quadratic</th>
      <td><p>Vector of parameters with quadratic function</p></td>
    </tr>
    <tr>
      <th>partable_joint</th>
      <td><p>User-defined parameter table if joint estimation is
used (<code>est_joint=TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>se</th>
      <td><p>Type of standard error used in <code><a href='https://rdrr.io/pkg/lavaan/man/lavaan.html'>lavaan::lavaan</a></code>. If <code>NULL</code>,
the <span class="pkg">lavaan</span> default is used.</p></td>
    </tr>
    <tr>
      <th>kernel</th>
      <td><p>Type of kernel function. Can be <code>"gaussian"</code>,
<code>"uniform"</code> or <code>"epanechnikov"</code>.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>Minimum number for weights</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Optional logical printing information about computation progress.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Object of class <code>lsem</code></p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>A file name in which the summary output will be written.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>Number of digits.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Object of class <code>lsem</code>.</p></td>
    </tr>
    <tr>
      <th>parindex</th>
      <td><p>Vector of indices for parameters in plot function.</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>A logical which asks for changing the graphic for each parameter.</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>Logical indicating whether confidence intervals should be plotted.</p></td>
    </tr>
    <tr>
      <th>lintrend</th>
      <td><p>Logical indicating whether a linear trend should be plotted.</p></td>
    </tr>
    <tr>
      <th>parsummary</th>
      <td><p>Logical indicating whether a parameter summary
  should be displayed.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>Plot parameter <code>ylim</code>. Can be a list, see Examples.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>Plot parameter <code>xlab</code>. Can be a vector.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>Plot parameter <code>ylab</code>. Can be a vector.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>Plot parameter <code>main</code>. Can be a vector.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to <code><a href='https://rdrr.io/pkg/lavaan/man/sem.html'>lavaan::sem</a></code> or
<code><a href='https://rdrr.io/pkg/lavaan/man/lavaan.html'>lavaan::lavaan</a></code>.</p></td>
    </tr>
    <tr>
      <th>data.mod</th>
      <td><p>Observed values of the moderator</p></td>
    </tr>
    <tr>
      <th>R</th>
      <td><p>Number of bootstrap samples</p></td>
    </tr>
    <tr>
      <th>cluster</th>
      <td><p>Optional variable name for bootstrap at the level of a cluster identifier</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Used random seed in bootstrap. Note that the seed is only
defined locally in this function, it does not affect the seed in the global
R environment.</p></td>
    </tr>
    <tr>
      <th>repl_design</th>
      <td><p>Optional matrix containing replication weights for computation of
standard errors. Note that sampling weights have to be already included in
<code>repl_design</code>.</p></td>
    </tr>
    <tr>
      <th>repl_factor</th>
      <td><p>Replication factor in variance formula for statistical
inference, e.g., 0.05 in PISA.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List with following entries</p>
<dt>parameters</dt><dd><p>Data frame with all parameters estimated at focal points of
    moderator. Bias-corrected estimates under boostrap can be found in
    the column <code>est_bc</code>.</p></dd>
<dt>weights</dt><dd><p>Data frame with weights at each focal point</p></dd>
<dt>parameters_summary</dt><dd><p>Summary table for estimated parameters</p></dd>
<dt>parametersM</dt><dd><p>Estimated parameters in matrix form. Parameters are in
columns and values of the grid of the moderator are in rows.</p></dd>
<dt>bw</dt><dd><p>Used bandwidth</p></dd>
<dt>h</dt><dd><p>Used bandwidth factor</p></dd>
<dt>N</dt><dd><p>Sample size</p></dd>
<dt>moderator.density</dt><dd><p>Estimated frequencies and effective sample size for
    moderator at focal points</p></dd>
<dt>moderator.stat</dt><dd><p>Descriptive statistics for moderator</p></dd>
<dt>moderator</dt><dd><p>Variable name of moderator</p></dd>
<dt>moderator.grid</dt><dd><p>Used grid of focal points for moderator</p></dd>
<dt>moderator.grouped</dt><dd><p>Data frame with informations about grouping of
moderator if <code>type="MGM"</code>.</p></dd>
<dt>residualized.intercepts</dt><dd><p>Estimated intercept functions used for
residualization.</p></dd>
<dt>lavmodel</dt><dd><p>Used lavaan model</p></dd>
<dt>data</dt><dd><p>Used data frame, possibly residualized if <code>residualize=TRUE</code></p></dd>
<dt>model_parameters</dt><dd><p>Model parameters in LSEM</p></dd>
<dt>parameters_boot</dt><dd><p>Parameter values in each bootstrap sample
(for <code>lsem.bootstrap</code>)</p></dd>
<dt>fitstats_joint_boot</dt><dd><p>Fit statistics in each bootstrap sample
(for <code>lsem.bootstrap</code>)</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hildebrandt, A., Luedtke, O., Robitzsch, A., Sommer, C., &amp;
Wilhelm, O. (2016). Exploring factor model parameters across continuous variables
with local structural equation models.
<em>Multivariate Behavioral Research, 51</em>(2-3), 257-278.
doi: <a href='https://doi.org/10.1080/00273171.2016.1142856'>10.1080/00273171.2016.1142856</a></p>
<p>Hildebrandt, A., Wilhelm, O., &amp; Robitzsch, A. (2009). Complementary and
competing factor analytic approaches for the investigation of measurement invariance.
<em>Review of Psychology, 16</em>, 87-102.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='lsem.permutationTest.html'>lsem.permutationTest</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: data.lsem01 | Age differentiation</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.lsem01</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"sirt"</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.lsem01</span>

<span class='co'># specify lavaan model</span>
<span class='no'>lavmodel</span> <span class='kw'>&lt;-</span> <span class='st'>"
        F=~ v1+v2+v3+v4+v5
        F ~~ 1*F"</span>

<span class='co'># define grid of moderator variable age</span>
<span class='no'>moderator.grid</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>4</span>,<span class='fl'>23</span>,<span class='fl'>1</span>)

<span class='co'>#********************************</span>
<span class='co'>#*** Model 1: estimate LSEM with bandwidth 2</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
               <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>std.lv</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod1</span>, <span class='kw'>parindex</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>5</span>)

<span class='co'># perform permutation test for Model 1</span>
<span class='no'>pmod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='lsem.permutationTest.html'>lsem.permutationTest</a></span>( <span class='no'>mod1</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>10</span> )
          <span class='co'># only for illustrative purposes the number of permutations B is set</span>
          <span class='co'># to a low number of 10</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>pmod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>pmod1</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"global"</span>)

<span class='co'>#** estimate Model 1 based on pseudo weights</span>
<span class='no'>mod1b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
               <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>std.lv</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>pseudo_weights</span><span class='kw'>=</span><span class='fl'>50</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1b</span>)

<span class='co'>#** estimation with sampling weights</span>

<span class='co'># generate random sampling weights</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>987</span>)
<span class='no'>weights</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>dat</span>), <span class='kw'>min</span><span class='kw'>=</span><span class='fl'>.4</span>, <span class='kw'>max</span><span class='kw'>=</span><span class='fl'>3</span> )
<span class='no'>mod1c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
               <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>sampling_weights</span><span class='kw'>=</span><span class='no'>weights</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1c</span>)

<span class='co'>#********************************</span>
<span class='co'>#*** Model 2: estimate multiple group model with 4 age groups</span>

<span class='co'># define breaks for age groups</span>
<span class='no'>moderator.grid</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( <span class='fl'>3.5</span>, <span class='fl'>23.5</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>5</span>) <span class='co'># 4 groups</span>
<span class='co'># estimate model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
           <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"MGM"</span>, <span class='kw'>std.lv</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'># output step functions</span>
<span class='no'>smod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.MGM.stepfunctions</span>( <span class='kw'>object</span><span class='kw'>=</span><span class='no'>mod2</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>4</span>,<span class='fl'>23</span>,<span class='fl'>1</span>) )
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>smod2</span>)

<span class='co'>#********************************</span>
<span class='co'>#*** Model 3: define standardized loadings as derived variables</span>

<span class='co'># specify lavaan model</span>
<span class='no'>lavmodel</span> <span class='kw'>&lt;-</span> <span class='st'>"
        F=~ a1*v1+a2*v2+a3*v3+a4*v4
        v1 ~~ s1*v1
        v2 ~~ s2*v2
        v3 ~~ s3*v3
        v4 ~~ s4*v4
        F ~~ 1*F
        # standardized loadings
        l1 :=a1 / sqrt(a1^2 + s1 )
        l2 :=a2 / sqrt(a2^2 + s2 )
        l3 :=a3 / sqrt(a3^2 + s3 )
        l4 :=a4 / sqrt(a4^2 + s4 )
        "</span>
<span class='co'># estimate model</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
               <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>std.lv</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod3</span>)

<span class='co'>#********************************</span>
<span class='co'>#*** Model 4: estimate LSEM and automatically include standardized solutions</span>

<span class='no'>lavmodel</span> <span class='kw'>&lt;-</span> <span class='st'>"
        F=~ 1*v1+v2+v3+v4
        F ~~ F"</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
               <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>standardized</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)
<span class='co'># permutation test (use only few permutations for testing purposes)</span>
<span class='no'>pmod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='lsem.permutationTest.html'>lsem.permutationTest</a></span>( <span class='no'>mod4</span>, <span class='kw'>B</span><span class='kw'>=</span><span class='fl'>3</span> )

<span class='co'>#**** compute LSEM local weights</span>
<span class='no'>wgt</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem_local_weights</span>(<span class='kw'>data.mod</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>age</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
             <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>)$<span class='no'>weights</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>weights</span>))

<span class='co'>#********************************</span>
<span class='co'>#*** Model 5: invariance parameter constraints and other constraints</span>

<span class='no'>lavmodel</span> <span class='kw'>&lt;-</span> <span class='st'>"
        F=~ 1*v1+v2+v3+v4
        F ~~ F"</span>
<span class='no'>moderator.grid</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>4</span>,<span class='fl'>23</span>,<span class='fl'>4</span>)

<span class='co'>#- estimate model without constraints</span>
<span class='no'>mod5a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
               <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>standardized</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod5a</span>)
<span class='co'># extract parameter names</span>
<span class='no'>mod5a</span>$<span class='no'>model_parameters</span>

<span class='co'>#- invariance constraints on residual variances</span>
<span class='no'>par_invariant</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"F=~v2"</span>,<span class='st'>"v2~~v2"</span>)
<span class='no'>mod5b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
               <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>standardized</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>par_invariant</span><span class='kw'>=</span><span class='no'>par_invariant</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod5b</span>)

<span class='co'>#- bootstrap for statistical inference</span>
<span class='no'>bmod5b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.bootstrap</span>(<span class='no'>mod5b</span>, <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>100</span>)
<span class='co'># inspect parameter values and standard errors</span>
<span class='no'>bmod5b</span>$<span class='no'>parameters</span>

<span class='co'>#- user-defined replication design</span>
<span class='no'>R</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>    <span class='co'># bootstrap samples</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>dat</span>)
<span class='no'>repl_design</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>N</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>R</span>)
<span class='kw'>for</span> (<span class='no'>rr</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>R</span>){
    <span class='no'>indices</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='no'>N</span>, <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>) )
    <span class='no'>repl_design</span>[,<span class='no'>rr</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fl'>1</span>:<span class='no'>N</span>, <span class='kw'>FUN</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>ii</span>){ <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>indices</span><span class='kw'>==</span><span class='no'>ii</span>) } )
}
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>repl_design</span>)
<span class='no'>bmod5b1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.bootstrap</span>(<span class='no'>mod5a</span>, <span class='kw'>repl_design</span><span class='kw'>=</span><span class='no'>repl_design</span>, <span class='kw'>repl_factor</span><span class='kw'>=</span><span class='fl'>1</span>/<span class='no'>R</span>)

<span class='co'>#- compare model mod5b with joint estimation without constraints</span>
<span class='no'>mod5c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
               <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>standardized</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>est_joint</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod5c</span>)

<span class='co'>#- linear and quadratic functions</span>
<span class='no'>par_invariant</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"F=~v1"</span>,<span class='st'>"v2~~v2"</span>)
<span class='no'>par_linear</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"v1~~v1"</span>)
<span class='no'>par_quadratic</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"v4~~v4"</span>)

<span class='no'>mod5d</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat1</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
            <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>par_invariant</span><span class='kw'>=</span><span class='no'>par_invariant</span>, <span class='kw'>par_linear</span><span class='kw'>=</span><span class='no'>par_linear</span>,
            <span class='kw'>par_quadratic</span><span class='kw'>=</span><span class='no'>par_quadratic</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod5d</span>)

<span class='co'>#- user-defined constraints: step functions for parameters</span>

<span class='co'># inspect parameter table (from lavaan) of fitted model</span>
<span class='no'>pj</span> <span class='kw'>&lt;-</span> <span class='no'>mod5d</span>$<span class='no'>partable_joint</span>
<span class='co'>#* modify parameter table for user-defined constraints</span>
<span class='co'># define step function for F=~v1 which is constant on intervals 1:4 and 5:7</span>
<span class='no'>pj2</span> <span class='kw'>&lt;-</span> <span class='no'>pj</span>[ <span class='no'>pj</span>$<span class='no'>con</span><span class='kw'>==</span><span class='fl'>1</span>, ]
<span class='no'>pj2</span>[ <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>6</span>), <span class='st'>"lhs"</span> ] <span class='kw'>&lt;-</span> <span class='st'>"p1g5"</span>
<span class='no'>pj2</span> <span class='kw'>&lt;-</span> <span class='no'>pj2</span>[ -<span class='fl'>4</span>, ]
<span class='no'>partable_joint</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>pj1</span>, <span class='no'>pj2</span>)
<span class='co'># estimate model with constraints</span>
<span class='no'>mod5e</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>lsem</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat1</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
             <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>std.lv</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"ML"</span>,
             <span class='kw'>partable_joint</span><span class='kw'>=</span><span class='no'>partable_joint</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod5e</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 2: data.lsem01 | FIML with missing data</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.lsem01</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.lsem01</span>
<span class='co'># induce artifical missing values</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>98</span>)
<span class='no'>dat</span>[ <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>dat</span>)) <span class='kw'>&lt;</span> <span class='fl'>.5</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"v1"</span>)] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>dat</span>[ <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>dat</span>)) <span class='kw'>&lt;</span> <span class='fl'>.25</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"v2"</span>)] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'># specify lavaan model</span>
<span class='no'>lavmodel1</span> <span class='kw'>&lt;-</span> <span class='st'>"
        F=~ v1+v2+v3+v4+v5
        F ~~ 1*F"</span>

<span class='co'># define grid of moderator variable age</span>
<span class='no'>moderator.grid</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>4</span>,<span class='fl'>23</span>,<span class='fl'>2</span>)

<span class='co'>#*** estimate LSEM with FIML</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
                <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel1</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>std.lv</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"ML"</span>, <span class='kw'>missing</span><span class='kw'>=</span><span class='st'>"fiml"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 3: data.lsem01 | WLSMV estimation</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.lsem01</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.lsem01</span>

<span class='co'># create artificial dichotomous data</span>
<span class='kw'>for</span> (<span class='no'>vv</span> <span class='kw'>in</span> <span class='fl'>2</span>:<span class='fl'>6</span>){
<span class='no'>dat</span>[,<span class='no'>vv</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>*(<span class='no'>dat</span>[,<span class='no'>vv</span>] <span class='kw'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>dat</span>[,<span class='no'>vv</span>]))
}

<span class='co'># specify lavaan model</span>
<span class='no'>lavmodel1</span> <span class='kw'>&lt;-</span> <span class='st'>"
        F=~ v1+v2+v3+v4+v5
        F ~~ 1*F
        v1 | t1
        v2 | t1
        v3 | t1
        v4 | t1
        v5 | t1
        "</span>

<span class='co'># define grid of moderator variable age</span>
<span class='no'>moderator.grid</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>4</span>,<span class='fl'>23</span>,<span class='fl'>2</span>)

<span class='co'>#*** local WLSMV estimation</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>lsem.estimate</span>( <span class='no'>dat</span>, <span class='kw'>moderator</span><span class='kw'>=</span><span class='st'>"age"</span>, <span class='kw'>moderator.grid</span><span class='kw'>=</span><span class='no'>moderator.grid</span>,
          <span class='kw'>lavmodel</span><span class='kw'>=</span><span class='no'>lavmodel1</span>, <span class='kw'>h</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>std.lv</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>estimator</span><span class='kw'>=</span><span class='st'>"DWLS"</span>, <span class='kw'>ordered</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"v"</span>,<span class='fl'>1</span>:<span class='fl'>5</span>),
          <span class='kw'>residualize</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>pseudo_weights</span><span class='kw'>=</span><span class='fl'>10000</span>, <span class='kw'>parameterization</span><span class='kw'>=</span><span class='st'>"THETA"</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


