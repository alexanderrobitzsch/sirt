<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Local structural equation models (LSEM) are structural equation models (SEM)
which are evaluated for each value of a pre-defined moderator variable
(Hildebrandt et al., 2009, 2016).
As in nonparametric regression models, observations near a focal point - at
which the model is evaluated - obtain higher weights, far distant observations
obtain lower weights. The LSEM can be specified by making use of lavaan syntax.
It is also possible to specify a discretized version of LSEM in which
values of the moderator are grouped and a multiple group SEM is specified.
The LSEM can be tested by employing a permutation test, see
lsem.permutationTest.
The function lsem.MGM.stepfunctions outputs stepwise functions
for a multiple group model evaluated at a grid of focal points of the
moderator, specified in moderator.grid.
The argument pseudo_weights provides an ad hoc solution to estimate
an LSEM for any model which can be fitted in lavaan.
It is also possible to constrain some of the parameters along the values
of the moderator in a joint estimation approach (est_joint=TRUE). Parameter
names can be specified which are assumed to be invariant (in par_invariant).
In addition, linear or quadratic constraints can be imposed on
parameters (par_linear or par_quadratic).
Statistical inference in case of joint estimation (but also for separate estimation)
can be conducted via bootstrap using the function lsem.bootstrap.
Bootstrap at the level of a cluster identifier is allowed (argument cluster)."><title>Local Structural Equation Models (LSEM) — lsem.estimate • sirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Local Structural Equation Models (LSEM) — lsem.estimate"><meta property="og:description" content="Local structural equation models (LSEM) are structural equation models (SEM)
which are evaluated for each value of a pre-defined moderator variable
(Hildebrandt et al., 2009, 2016).
As in nonparametric regression models, observations near a focal point - at
which the model is evaluated - obtain higher weights, far distant observations
obtain lower weights. The LSEM can be specified by making use of lavaan syntax.
It is also possible to specify a discretized version of LSEM in which
values of the moderator are grouped and a multiple group SEM is specified.
The LSEM can be tested by employing a permutation test, see
lsem.permutationTest.
The function lsem.MGM.stepfunctions outputs stepwise functions
for a multiple group model evaluated at a grid of focal points of the
moderator, specified in moderator.grid.
The argument pseudo_weights provides an ad hoc solution to estimate
an LSEM for any model which can be fitted in lavaan.
It is also possible to constrain some of the parameters along the values
of the moderator in a joint estimation approach (est_joint=TRUE). Parameter
names can be specified which are assumed to be invariant (in par_invariant).
In addition, linear or quadratic constraints can be imposed on
parameters (par_linear or par_quadratic).
Statistical inference in case of joint estimation (but also for separate estimation)
can be conducted via bootstrap using the function lsem.bootstrap.
Bootstrap at the level of a cluster identifier is allowed (argument cluster)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3</small

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexanderrobitzsch/sirt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Local Structural Equation Models (LSEM)</h1>
      
      <div class="d-none name"><code>lsem.estimate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Local structural equation models (LSEM) are structural equation models (SEM)
which are evaluated for each value of a pre-defined moderator variable
(Hildebrandt et al., 2009, 2016).
As in nonparametric regression models, observations near a focal point - at
which the model is evaluated - obtain higher weights, far distant observations
obtain lower weights. The LSEM can be specified by making use of <span class="pkg">lavaan</span> syntax.
It is also possible to specify a discretized version of LSEM in which
values of the moderator are grouped and a multiple group SEM is specified.
The LSEM can be tested by employing a permutation test, see
<code><a href="lsem.permutationTest.html">lsem.permutationTest</a></code>.</p>
<p>The function <code>lsem.MGM.stepfunctions</code> outputs stepwise functions
for a multiple group model evaluated at a grid of focal points of the
moderator, specified in <code>moderator.grid</code>.</p>
<p>The argument <code>pseudo_weights</code> provides an ad hoc solution to estimate
an LSEM for any model which can be fitted in <span class="pkg">lavaan</span>.</p>
<p>It is also possible to constrain some of the parameters along the values
of the moderator in a joint estimation approach (<code>est_joint=TRUE</code>). Parameter
names can be specified which are assumed to be invariant (in <code>par_invariant</code>).
In addition, linear or quadratic constraints can be imposed on
parameters (<code>par_linear</code> or <code>par_quadratic</code>).</p>
<p>Statistical inference in case of joint estimation (but also for separate estimation)
can be conducted via bootstrap using the function <code>lsem.bootstrap</code>.
Bootstrap at the level of a cluster identifier is allowed (argument <code>cluster</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lsem.estimate</span><span class="op">(</span><span class="va">data</span>, <span class="va">moderator</span>, <span class="va">moderator.grid</span>, <span class="va">lavmodel</span>, type<span class="op">=</span><span class="st">"LSEM"</span>, h<span class="op">=</span><span class="fl">1.1</span>, bw<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    residualize<span class="op">=</span><span class="cn">TRUE</span>, fit_measures<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rmsea"</span>, <span class="st">"cfi"</span>, <span class="st">"tli"</span>, <span class="st">"gfi"</span>, <span class="st">"srmr"</span><span class="op">)</span>,</span>
<span>    standardized<span class="op">=</span><span class="cn">FALSE</span>, standardized_type<span class="op">=</span><span class="st">"std.all"</span>, lavaan_fct<span class="op">=</span><span class="st">"sem"</span>,</span>
<span>    sufficient_statistics<span class="op">=</span><span class="cn">TRUE</span>, pseudo_weights<span class="op">=</span><span class="fl">0</span>,</span>
<span>    sampling_weights<span class="op">=</span><span class="cn">NULL</span>, loc_linear_smooth<span class="op">=</span><span class="cn">TRUE</span>, est_joint<span class="op">=</span><span class="cn">FALSE</span>, par_invariant<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    par_linear<span class="op">=</span><span class="cn">NULL</span>, par_quadratic<span class="op">=</span><span class="cn">NULL</span>, partable_joint<span class="op">=</span><span class="cn">NULL</span>, pw_linear<span class="op">=</span><span class="fl">1</span>,</span>
<span>    pw_quadratic<span class="op">=</span><span class="fl">1</span>, pd<span class="op">=</span><span class="cn">TRUE</span>, est_DIF<span class="op">=</span><span class="cn">FALSE</span>, se<span class="op">=</span><span class="cn">NULL</span>, kernel<span class="op">=</span><span class="st">"gaussian"</span>,</span>
<span>    eps<span class="op">=</span><span class="fl">1e-08</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lsem</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, file<span class="op">=</span><span class="cn">NULL</span>, digits<span class="op">=</span><span class="fl">3</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lsem</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, parindex<span class="op">=</span><span class="cn">NULL</span>, ask<span class="op">=</span><span class="cn">TRUE</span>, ci<span class="op">=</span><span class="cn">TRUE</span>, lintrend<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>       parsummary<span class="op">=</span><span class="cn">TRUE</span>, ylim<span class="op">=</span><span class="cn">NULL</span>, xlab<span class="op">=</span><span class="cn">NULL</span>,  ylab<span class="op">=</span><span class="cn">NULL</span>, main<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>       digits<span class="op">=</span><span class="fl">3</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lsem.MGM.stepfunctions</span><span class="op">(</span> <span class="va">object</span>, <span class="va">moderator.grid</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># compute local weights</span></span>
<span><span class="fu">lsem_local_weights</span><span class="op">(</span><span class="va">data.mod</span>, <span class="va">moderator.grid</span>, <span class="va">h</span>, sampling_weights<span class="op">=</span><span class="cn">NULL</span>, bw<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     kernel<span class="op">=</span><span class="st">"gaussian"</span>, is_imputed<span class="op">=</span><span class="cn">FALSE</span>, Nimp<span class="op">=</span><span class="fl">0</span>, data<span class="op">=</span><span class="cn">NULL</span>, moderator<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lsem.bootstrap</span><span class="op">(</span><span class="va">object</span>, R<span class="op">=</span><span class="fl">100</span>, verbose<span class="op">=</span><span class="cn">TRUE</span>, cluster<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     repl_design<span class="op">=</span><span class="cn">NULL</span>, repl_factor<span class="op">=</span><span class="cn">NULL</span>, use_starting_values<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>     n.core<span class="op">=</span><span class="fl">1</span>, cl.type<span class="op">=</span><span class="st">"PSOCK"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>Data frame or a list of imputed datasets</p></dd>

  <dt>moderator</dt>
<dd><p>Variable name of the moderator</p></dd>

  <dt>moderator.grid</dt>
<dd><p>Focal points at which the LSEM should be evaluated. If <code>type="MGM"</code>,
breaks are defined in this vector.</p></dd>

  <dt>lavmodel</dt>
<dd><p>Specified SEM in <span class="pkg">lavaan</span>.</p></dd>

<dt>type</dt>
<dd><p>Type of estimated model. The default is <code>type="LSEM"</code> which means
    that a local structural equation model is estimated.
    A multiple group model with a discretized moderator as the
    grouping variable can be estimated with <code>type="MGM"</code>. In this
    case, the breaks must be defined in <code>moderator.grid</code>.</p></dd>

  <dt>h</dt>
<dd><p>Bandwidth factor</p></dd>

<dt>bw</dt>
<dd><p>Optional bandwidth parameter if <code>h</code> should not be used</p></dd>

<dt>residualize</dt>
<dd><p>Logical indicating whether a residualization
    should be applied.</p></dd>

  <dt>fit_measures</dt>
<dd><p>Vector with names of fit measures following the labels in <span class="pkg">lavaan</span></p></dd>

<dt>standardized</dt>
<dd><p>Optional logical indicating whether
 standardized solution should be included as parameters in
 the output using the
<code><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">lavaan::standardizedSolution</a></code>
function. Standardized parameters are labeled as <code>std__</code>.</p></dd>

<dt>standardized_type</dt>
<dd><p>Type of standardization if <code>standardized=TRUE</code>.
The types are described in
<code><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">lavaan::standardizedSolution</a></code>.</p></dd>

<dt>lavaan_fct</dt>
<dd><p>String whether
<code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan</a></code> (<code>lavaan_fct="lavaan"</code>),
<code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem</a></code> (<code>lavaan_fct="sem"</code>),
<code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa</a></code> (<code>lavaan_fct="cfa"</code>) or
<code><a href="https://rdrr.io/pkg/lavaan/man/growth.html" class="external-link">lavaan::growth</a></code> (<code>lavaan_fct="growth"</code>)
should be used.</p></dd>

<dt>sufficient_statistics</dt>
<dd><p>Logical whether sufficient statistics of weighted
means and covariances should be used for model fitting. This option
can be set to <code>sufficient_statistics=FALSE</code>
if the data contain missing values. Note that the option
<code>sufficient_statistics=TRUE</code> is
only valid for (approximate) missing completely at random (MCAR) data.
The option can only be used for continuous data.</p></dd>

<dt>pseudo_weights</dt>
<dd><p>Integer defining a target sample size. Local weights
are multiplied by a factor which is rounded to integers.
This approach is referred as a pseudo weighting approach.
For example, using <code>pseudo_weights=30000</code> implies
that the sum of local weights at each focal point is <code>30000</code>.</p></dd>

<dt>sampling_weights</dt>
<dd><p>Optional vector of sampling weights</p></dd>

<dt>loc_linear_smooth</dt>
<dd><p>Logical indicating whether local linear
smoothing should be used for computing sufficient statistics for
means and covariances. The default is <code>FALSE</code>.</p></dd>

<dt>est_joint</dt>
<dd><p>Logical indicating whether LSEM should be estimated in a
joint estimation approach. This options only works wih continuous data and
sufficient statistics.</p></dd>

<dt>par_invariant</dt>
<dd><p>Vector of invariant parameters</p></dd>

<dt>par_linear</dt>
<dd><p>Vector of parameters with linear function</p></dd>

<dt>par_quadratic</dt>
<dd><p>Vector of parameters with quadratic function</p></dd>

<dt>partable_joint</dt>
<dd><p>User-defined parameter table if joint estimation is
used (<code>est_joint=TRUE</code>).</p></dd>

<dt>pw_linear</dt>
<dd><p>Number of segments if piecewise linear estimation of parameters is used</p></dd>

<dt>pw_quadratic</dt>
<dd><p>Number of segments if piecewise quadratic estimation of parameters
is used</p></dd>

<dt>pd</dt>
<dd><p>Logical indicating whether nearest positive definite covariance matrix
should be computed if sufficient statistics are used</p></dd>

<dt>est_DIF</dt>
<dd><p>Logical indicating whether parameters under differential
item functioning (DIF) should be additionally
computed for invariant item parameters</p></dd>

<dt>se</dt>
<dd><p>Type of standard error used in <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan</a></code>. If <code>NULL</code>,
the <span class="pkg">lavaan</span> default is used.</p></dd>

<dt>kernel</dt>
<dd><p>Type of kernel function. Can be <code>"gaussian"</code>,
<code>"uniform"</code> or <code>"epanechnikov"</code>.</p></dd>

<dt>is_imputed</dt>
<dd><p>Logical indicating whether datasets are imputed</p></dd>

<dt>Nimp</dt>
<dd><p>Number of imputed datasets</p></dd>

<dt>eps</dt>
<dd><p>Minimum number for weights</p></dd>

<dt>verbose</dt>
<dd><p>Optional logical printing information about computation progress.</p></dd>

<dt>object</dt>
<dd><p>Object of class <code>lsem</code></p></dd>

<dt>file</dt>
<dd><p>A file name in which the summary output will be written.</p></dd>

<dt>digits</dt>
<dd><p>Number of digits.</p></dd>

<dt>x</dt>
<dd><p>Object of class <code>lsem</code>.</p></dd>

<dt>parindex</dt>
<dd><p>Vector of indices for parameters in plot function.</p></dd>

<dt>ask</dt>
<dd><p>A logical which asks for changing the graphic for each parameter.</p></dd>

<dt>ci</dt>
<dd><p>Logical indicating whether confidence intervals should be plotted.</p></dd>

<dt>lintrend</dt>
<dd><p>Logical indicating whether a linear trend should be plotted.</p></dd>

<dt>parsummary</dt>
<dd><p>Logical indicating whether a parameter summary
  should be displayed.</p></dd>

<dt>ylim</dt>
<dd><p>Plot parameter <code>ylim</code>. Can be a list, see Examples.</p></dd>

<dt>xlab</dt>
<dd><p>Plot parameter <code>xlab</code>. Can be a vector.</p></dd>

<dt>ylab</dt>
<dd><p>Plot parameter <code>ylab</code>. Can be a vector.</p></dd>

<dt>main</dt>
<dd><p>Plot parameter <code>main</code>. Can be a vector.</p></dd>

  <dt>...</dt>
<dd><p>Further arguments to be passed to <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem</a></code> or
<code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan</a></code>.</p></dd>

<dt>data.mod</dt>
<dd><p>Observed values of the moderator</p></dd>

<dt>R</dt>
<dd><p>Number of bootstrap samples</p></dd>

<dt>cluster</dt>
<dd><p>Optional variable name for bootstrap at the level of a cluster identifier</p></dd>

<dt>repl_design</dt>
<dd><p>Optional matrix containing replication weights for computation of
standard errors. Note that sampling weights have to be already included in
<code>repl_design</code>.</p></dd>

<dt>repl_factor</dt>
<dd><p>Replication factor in variance formula for statistical
inference, e.g., 0.05 in PISA.</p></dd>

<dt>use_starting_values</dt>
<dd><p>Logical indicating whether starting values should be
used from the original sample</p></dd>

<dt>n.core</dt>
<dd><p>A scalar indicating the number of cores that should be used.</p></dd>

<dt>cl.type</dt>
<dd><p>The cluster type.
Default value is <code>"PSOCK"</code>. Posix machines (Linux, Mac) generally benefit
from much faster cluster computation if type is set to <code>type="FORK"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>List with following entries</p>
<dl><dt>parameters</dt>
<dd><p>Data frame with all parameters estimated at focal points of
    moderator. Bias-corrected estimates under boostrap can be found in
    the column <code>est_bc</code>.</p></dd>

<dt>weights</dt>
<dd><p>Data frame with weights at each focal point</p></dd>

<dt>parameters_summary</dt>
<dd><p>Summary table for estimated parameters</p></dd>

<dt>parametersM</dt>
<dd><p>Estimated parameters in matrix form. Parameters are in
columns and values of the grid of the moderator are in rows.</p></dd>

<dt>bw</dt>
<dd><p>Used bandwidth</p></dd>

<dt>h</dt>
<dd><p>Used bandwidth factor</p></dd>

<dt>N</dt>
<dd><p>Sample size</p></dd>

<dt>moderator.density</dt>
<dd><p>Estimated frequencies and effective sample size for
    moderator at focal points</p></dd>

<dt>moderator.stat</dt>
<dd><p>Descriptive statistics for moderator</p></dd>

<dt>moderator</dt>
<dd><p>Variable name of moderator</p></dd>

<dt>moderator.grid</dt>
<dd><p>Used grid of focal points for moderator</p></dd>

<dt>moderator.grouped</dt>
<dd><p>Data frame with informations about grouping of
moderator if <code>type="MGM"</code>.</p></dd>

<dt>residualized.intercepts</dt>
<dd><p>Estimated intercept functions used for
residualization.</p></dd>

<dt>lavmodel</dt>
<dd><p>Used lavaan model</p></dd>

<dt>data</dt>
<dd><p>Used data frame, possibly residualized if <code>residualize=TRUE</code></p></dd>

<dt>model_parameters</dt>
<dd><p>Model parameters in LSEM</p></dd>

<dt>parameters_boot</dt>
<dd><p>Parameter values in each bootstrap sample
(for <code>lsem.bootstrap</code>)</p></dd>

<dt>fitstats_joint_boot</dt>
<dd><p>Fit statistics in each bootstrap sample
(for <code>lsem.bootstrap</code>)</p></dd>

<dt>dif_effects</dt>
<dd><p>Estimated item parameters under DIF</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hildebrandt, A., Luedtke, O., Robitzsch, A., Sommer, C., &amp;
Wilhelm, O. (2016). Exploring factor model parameters across continuous variables
with local structural equation models.
<em>Multivariate Behavioral Research, 51</em>(2-3), 257-278.
<a href="https://doi.org/10.1080/00273171.2016.1142856" class="external-link">doi:10.1080/00273171.2016.1142856</a></p>
<p>Hildebrandt, A., Wilhelm, O., &amp; Robitzsch, A. (2009). Complementary and
competing factor analytic approaches for the investigation of measurement invariance.
<em>Review of Psychology, 16</em>, 87-102.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Alexander Robitzsch, Oliver Luedtke, Andrea Hildebrandt</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="lsem.permutationTest.html">lsem.permutationTest</a></code> for conducting a permutation test
and <code><a href="lsem.test.html">lsem.test</a></code> for applying a Wald test to a bootstrapped LSEM model.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 1: data.lsem01 | Age differentiation</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.lsem01</span>, package<span class="op">=</span><span class="st">"sirt"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.lsem01</span></span>
<span></span>
<span><span class="co"># specify lavaan model</span></span>
<span><span class="va">lavmodel</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">        F=~ v1+v2+v3+v4+v5</span></span>
<span><span class="st">        F ~~ 1*F"</span></span>
<span></span>
<span><span class="co"># define grid of moderator variable age</span></span>
<span><span class="va">moderator.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">23</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#********************************</span></span>
<span><span class="co">#*** Model 1: estimate LSEM with bandwidth 2</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>               lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, std.lv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>, parindex<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># perform permutation test for Model 1</span></span>
<span><span class="va">pmod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="lsem.permutationTest.html">lsem.permutationTest</a></span><span class="op">(</span> <span class="va">mod1</span>, B<span class="op">=</span><span class="fl">10</span> <span class="op">)</span></span>
<span>          <span class="co"># only for illustrative purposes the number of permutations B is set</span></span>
<span>          <span class="co"># to a low number of 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pmod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pmod1</span>, type<span class="op">=</span><span class="st">"global"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#* perform permutation test with parallel computation</span></span>
<span><span class="va">pmod1a</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="lsem.permutationTest.html">lsem.permutationTest</a></span><span class="op">(</span> <span class="va">mod1</span>, B<span class="op">=</span><span class="fl">10</span>, n.core<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pmod1a</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#** estimate Model 1 based on pseudo weights</span></span>
<span><span class="va">mod1b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>               lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, std.lv<span class="op">=</span><span class="cn">TRUE</span>, pseudo_weights<span class="op">=</span><span class="fl">50</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1b</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#** estimation with sampling weights</span></span>
<span></span>
<span><span class="co"># generate random sampling weights</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">987</span><span class="op">)</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, min<span class="op">=</span><span class="fl">.4</span>, max<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span><span class="va">mod1c</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>               lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, sampling_weights<span class="op">=</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1c</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#********************************</span></span>
<span><span class="co">#*** Model 2: estimate multiple group model with 4 age groups</span></span>
<span></span>
<span><span class="co"># define breaks for age groups</span></span>
<span><span class="va">moderator.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="fl">3.5</span>, <span class="fl">23.5</span>, len<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co"># 4 groups</span></span>
<span><span class="co"># estimate model</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>           lavmodel<span class="op">=</span><span class="va">lavmodel</span>, type<span class="op">=</span><span class="st">"MGM"</span>, std.lv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># output step functions</span></span>
<span><span class="va">smod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.MGM.stepfunctions</span><span class="op">(</span> object<span class="op">=</span><span class="va">mod2</span>, moderator.grid<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">23</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">smod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#********************************</span></span>
<span><span class="co">#*** Model 3: define standardized loadings as derived variables</span></span>
<span></span>
<span><span class="co"># specify lavaan model</span></span>
<span><span class="va">lavmodel</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">        F=~ a1*v1+a2*v2+a3*v3+a4*v4</span></span>
<span><span class="st">        v1 ~~ s1*v1</span></span>
<span><span class="st">        v2 ~~ s2*v2</span></span>
<span><span class="st">        v3 ~~ s3*v3</span></span>
<span><span class="st">        v4 ~~ s4*v4</span></span>
<span><span class="st">        F ~~ 1*F</span></span>
<span><span class="st">        # standardized loadings</span></span>
<span><span class="st">        l1 :=a1 / sqrt(a1^2 + s1 )</span></span>
<span><span class="st">        l2 :=a2 / sqrt(a2^2 + s2 )</span></span>
<span><span class="st">        l3 :=a3 / sqrt(a3^2 + s3 )</span></span>
<span><span class="st">        l4 :=a4 / sqrt(a4^2 + s4 )</span></span>
<span><span class="st">        "</span></span>
<span><span class="co"># estimate model</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>               lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, std.lv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#********************************</span></span>
<span><span class="co">#*** Model 4: estimate LSEM and automatically include standardized solutions</span></span>
<span></span>
<span><span class="va">lavmodel</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">        F=~ 1*v1+v2+v3+v4</span></span>
<span><span class="st">        F ~~ F"</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>               lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, standardized<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span>
<span><span class="co"># permutation test (use only few permutations for testing purposes)</span></span>
<span><span class="va">pmod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="lsem.permutationTest.html">lsem.permutationTest</a></span><span class="op">(</span> <span class="va">mod4</span>, B<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#**** compute LSEM local weights</span></span>
<span><span class="va">wgt</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem_local_weights</span><span class="op">(</span>data.mod<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">age</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>             h<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">weights</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#********************************</span></span>
<span><span class="co">#*** Model 5: invariance parameter constraints and other constraints</span></span>
<span></span>
<span><span class="va">lavmodel</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">        F=~ 1*v1+v2+v3+v4</span></span>
<span><span class="st">        F ~~ F"</span></span>
<span><span class="va">moderator.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">23</span>,<span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- estimate model without constraints</span></span>
<span><span class="va">mod5a</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>               lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, standardized<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5a</span><span class="op">)</span></span>
<span><span class="co"># extract parameter names</span></span>
<span><span class="va">mod5a</span><span class="op">$</span><span class="va">model_parameters</span></span>
<span></span>
<span><span class="co">#- invariance constraints on residual variances</span></span>
<span><span class="va">par_invariant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F=~v2"</span>,<span class="st">"v2~~v2"</span><span class="op">)</span></span>
<span><span class="va">mod5b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>               lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, standardized<span class="op">=</span><span class="cn">TRUE</span>, par_invariant<span class="op">=</span><span class="va">par_invariant</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5b</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- bootstrap for statistical inference</span></span>
<span><span class="va">bmod5b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.bootstrap</span><span class="op">(</span><span class="va">mod5b</span>, R<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co"># inspect parameter values and standard errors</span></span>
<span><span class="va">bmod5b</span><span class="op">$</span><span class="va">parameters</span></span>
<span></span>
<span><span class="co">#- bootstrap using parallel computing (i.e., multiple cores)</span></span>
<span><span class="va">bmod5ba</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.bootstrap</span><span class="op">(</span><span class="va">mod5b</span>, R<span class="op">=</span><span class="fl">100</span>, n.core<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- user-defined replication design</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">100</span>    <span class="co"># bootstrap samples</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">repl_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="va">N</span>, ncol<span class="op">=</span><span class="va">R</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">rr</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span></span>
<span>    <span class="va">repl_design</span><span class="op">[</span>,<span class="va">rr</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">ii</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">indices</span><span class="op">==</span><span class="va">ii</span><span class="op">)</span> <span class="op">}</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">repl_design</span><span class="op">)</span></span>
<span><span class="va">bmod5b1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.bootstrap</span><span class="op">(</span><span class="va">mod5a</span>, repl_design<span class="op">=</span><span class="va">repl_design</span>, repl_factor<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">R</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- compare model mod5b with joint estimation without constraints</span></span>
<span><span class="va">mod5c</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>               lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, standardized<span class="op">=</span><span class="cn">TRUE</span>, est_joint<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5c</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- linear and quadratic functions</span></span>
<span><span class="va">par_invariant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F=~v1"</span>,<span class="st">"v2~~v2"</span><span class="op">)</span></span>
<span><span class="va">par_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"v1~~v1"</span><span class="op">)</span></span>
<span><span class="va">par_quadratic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"v4~~v4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod5d</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat1</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>            lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, par_invariant<span class="op">=</span><span class="va">par_invariant</span>, par_linear<span class="op">=</span><span class="va">par_linear</span>,</span>
<span>            par_quadratic<span class="op">=</span><span class="va">par_quadratic</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5d</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#- user-defined constraints: step functions for parameters</span></span>
<span></span>
<span><span class="co"># inspect parameter table (from lavaan) of fitted model</span></span>
<span><span class="va">pj</span> <span class="op">&lt;-</span> <span class="va">mod5d</span><span class="op">$</span><span class="va">partable_joint</span></span>
<span><span class="co">#* modify parameter table for user-defined constraints</span></span>
<span><span class="co"># define step function for F=~v1 which is constant on intervals 1:4 and 5:7</span></span>
<span><span class="va">pj2</span> <span class="op">&lt;-</span> <span class="va">pj</span><span class="op">[</span> <span class="va">pj</span><span class="op">$</span><span class="va">con</span><span class="op">==</span><span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">pj2</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, <span class="st">"lhs"</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"p1g5"</span></span>
<span><span class="va">pj2</span> <span class="op">&lt;-</span> <span class="va">pj2</span><span class="op">[</span> <span class="op">-</span><span class="fl">4</span>, <span class="op">]</span></span>
<span><span class="va">partable_joint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">pj1</span>, <span class="va">pj2</span><span class="op">)</span></span>
<span><span class="co"># estimate model with constraints</span></span>
<span><span class="va">mod5e</span> <span class="op">&lt;-</span> <span class="fu">lsem</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat1</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>             lavmodel<span class="op">=</span><span class="va">lavmodel</span>, h<span class="op">=</span><span class="fl">2</span>, std.lv<span class="op">=</span><span class="cn">TRUE</span>, estimator<span class="op">=</span><span class="st">"ML"</span>,</span>
<span>             partable_joint<span class="op">=</span><span class="va">partable_joint</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5e</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 2: data.lsem01 | FIML with missing data</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.lsem01</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.lsem01</span></span>
<span><span class="co"># induce artifical missing values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">98</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">[</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"v1"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">dat</span><span class="op">[</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.25</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"v2"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># specify lavaan model</span></span>
<span><span class="va">lavmodel1</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">        F=~ v1+v2+v3+v4+v5</span></span>
<span><span class="st">        F ~~ 1*F"</span></span>
<span></span>
<span><span class="co"># define grid of moderator variable age</span></span>
<span><span class="va">moderator.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">23</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** estimate LSEM with FIML</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>                lavmodel<span class="op">=</span><span class="va">lavmodel1</span>, h<span class="op">=</span><span class="fl">2</span>, std.lv<span class="op">=</span><span class="cn">TRUE</span>, estimator<span class="op">=</span><span class="st">"ML"</span>, missing<span class="op">=</span><span class="st">"fiml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 3: data.lsem01 | WLSMV estimation</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.lsem01</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.lsem01</span></span>
<span></span>
<span><span class="co"># create artificial dichotomous data</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">vv</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="va">dat</span><span class="op">[</span>,<span class="va">vv</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="va">vv</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="va">vv</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># specify lavaan model</span></span>
<span><span class="va">lavmodel1</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">        F=~ v1+v2+v3+v4+v5</span></span>
<span><span class="st">        F ~~ 1*F</span></span>
<span><span class="st">        v1 | t1</span></span>
<span><span class="st">        v2 | t1</span></span>
<span><span class="st">        v3 | t1</span></span>
<span><span class="st">        v4 | t1</span></span>
<span><span class="st">        v5 | t1</span></span>
<span><span class="st">        "</span></span>
<span></span>
<span><span class="co"># define grid of moderator variable age</span></span>
<span><span class="va">moderator.grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">23</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** local WLSMV estimation</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">lsem.estimate</span><span class="op">(</span> <span class="va">dat</span>, moderator<span class="op">=</span><span class="st">"age"</span>, moderator.grid<span class="op">=</span><span class="va">moderator.grid</span>,</span>
<span>          lavmodel<span class="op">=</span><span class="va">lavmodel1</span>, h<span class="op">=</span><span class="fl">2</span>, std.lv<span class="op">=</span><span class="cn">TRUE</span>, estimator<span class="op">=</span><span class="st">"DWLS"</span>, ordered<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"v"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>          residualize<span class="op">=</span><span class="cn">FALSE</span>, pseudo_weights<span class="op">=</span><span class="fl">10000</span>, parameterization<span class="op">=</span><span class="st">"THETA"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

