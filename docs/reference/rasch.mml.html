<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimation of the Generalized Logistic Item Response Model,
Ramsay's Quotient Model, Nonparametric Item Response Model,
Pseudo-Likelihood Estimation and a Missing Data Item Response Model — rasch.mml2 • sirt</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimation of the Generalized Logistic Item Response Model,
Ramsay's Quotient Model, Nonparametric Item Response Model,
Pseudo-Likelihood Estimation and a Missing Data Item Response Model — rasch.mml2" />
<meta property="og:description" content="This function employs marginal maximum likelihood estimation
of item response models for dichotomous data.
First, the Rasch type model (generalized
item response model) can be estimated. The generalized logistic
link function (Stukel, 1988) can be estimated or fixed for conducting
IRT with different link functions than the logistic one. The Four-Parameter
logistic item response model is a special case of this model
(Loken &amp;amp; Rulison, 2010). Second, Ramsay's quotient model (Ramsay, 1989)
can be estimated by specifying irtmodel=&quot;ramsay.qm&quot;.
Third, quite general item response functions can be estimated
in a nonparametric framework (Rossi, Wang &amp;amp; Ramsay, 2002).
Fourth, pseudo-likelihood estimation for fractional item responses can be
conducted for Rasch type models. Fifth, a simple two-dimensional
missing data item response model (irtmodel='missing1';
Mislevy &amp;amp; Wu, 1996) can be estimated.
See Details for more explanations." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sirt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.12-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/sirt/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimation of the Generalized Logistic Item Response Model,
Ramsay's Quotient Model, Nonparametric Item Response Model,
Pseudo-Likelihood Estimation and a Missing Data Item Response Model</h1>
    
    <div class="hidden name"><code>rasch.mml.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function employs marginal maximum likelihood estimation
of item response models for dichotomous data.
First, the Rasch type model (generalized
item response model) can be estimated. The generalized logistic
link function (Stukel, 1988) can be estimated or fixed for conducting
IRT with different link functions than the logistic one. The Four-Parameter
logistic item response model is a special case of this model
(Loken &amp; Rulison, 2010). Second, Ramsay's quotient model (Ramsay, 1989)
can be estimated by specifying <code>irtmodel="ramsay.qm"</code>.
Third, quite general item response functions can be estimated
in a nonparametric framework (Rossi, Wang &amp; Ramsay, 2002).
Fourth, pseudo-likelihood estimation for fractional item responses can be
conducted for Rasch type models. Fifth, a simple two-dimensional
missing data item response model (<code>irtmodel='missing1'</code>;
Mislevy &amp; Wu, 1996) can be estimated.</p>
<p>See Details for more explanations.</p>
    </div>

    <pre class="usage"><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>6</span>,<span class='fl'>6</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>21</span>), <span class='kw'>group</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>weights</span><span class='kw'>=</span><span class='kw'>NULL</span>,
   <span class='kw'>constraints</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>glob.conv</span><span class='kw'>=</span><span class='fl'>10</span>^(-<span class='fl'>5</span>), <span class='kw'>parm.conv</span><span class='kw'>=</span><span class='fl'>10</span>^(-<span class='fl'>4</span>), <span class='kw'>mitermax</span><span class='kw'>=</span><span class='fl'>4</span>,
   <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>progress</span><span class='kw'>=</span><span class='fl'>TRUE</span>,  <span class='kw'>fixed.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)),
   <span class='kw'>fixed.c</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)), <span class='kw'>fixed.d</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)),
   <span class='kw'>fixed.K</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>3</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)), <span class='kw'>b.init</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='kw'>NULL</span>,
   <span class='kw'>est.c</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>est.d</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>min.b</span><span class='kw'>=</span>-<span class='fl'>99</span>, <span class='kw'>max.b</span><span class='kw'>=</span><span class='fl'>99</span>, <span class='kw'>min.a</span><span class='kw'>=</span>-<span class='fl'>99</span>, <span class='kw'>max.a</span><span class='kw'>=</span><span class='fl'>99</span>,
   <span class='kw'>min.c</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>max.c</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>min.d</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>max.d</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>prior.b</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>prior.a</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>prior.c</span><span class='kw'>=</span><span class='kw'>NULL</span>,
   <span class='kw'>prior.d</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>est.K</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>min.K</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>max.K</span><span class='kw'>=</span><span class='fl'>20</span>, <span class='kw'>min.delta</span><span class='kw'>=</span>-<span class='fl'>20</span>, <span class='kw'>max.delta</span><span class='kw'>=</span><span class='fl'>20</span>,
   <span class='kw'>beta.init</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>min.beta</span><span class='kw'>=</span>-<span class='fl'>8</span>, <span class='kw'>pid</span><span class='kw'>=</span><span class='fl'>1</span>:(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>dat</span>)), <span class='kw'>trait.weights</span><span class='kw'>=</span><span class='kw'>NULL</span>,  <span class='kw'>center.trait</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
   <span class='kw'>center.b</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>alpha1</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>alpha2</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>est.alpha</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>equal.alpha</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
   <span class='kw'>designmatrix</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>alpha.conv</span><span class='kw'>=</span><span class='no'>parm.conv</span>, <span class='kw'>numdiff.parm</span><span class='kw'>=</span><span class='fl'>0.00001</span>,
   <span class='kw'>numdiff.alpha.parm</span><span class='kw'>=</span><span class='no'>numdiff.parm</span>, <span class='kw'>distribution.trait</span><span class='kw'>=</span><span class='st'>"normal"</span>, <span class='kw'>Qmatrix</span><span class='kw'>=</span><span class='kw'>NULL</span>,
   <span class='kw'>variance.fixed</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>variance.init</span><span class='kw'>=</span><span class='kw'>NULL</span>,
   <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>Qmatrix</span>)),<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>Qmatrix</span>))),
   <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"raschtype"</span>, <span class='kw'>npformula</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>npirt.monotone</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
   <span class='kw'>use.freqpatt</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>group</span>), <span class='kw'>delta.miss</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>est.delta</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>NA</span>,<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)),
   <span class='kw'>nimps</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='no'>...</span> )

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='kw'>file</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>items</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>xlim</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>object</span>,<span class='no'>...</span>)

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>object</span>,<span class='no'>...</span>)

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'>IRT.irfprob</span>(<span class='no'>object</span>,<span class='no'>...</span>)

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'>IRT.likelihood</span>(<span class='no'>object</span>,<span class='no'>...</span>)

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'>IRT.posterior</span>(<span class='no'>object</span>,<span class='no'>...</span>)

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'>IRT.modelfit</span>(<span class='no'>object</span>,<span class='no'>...</span>)

<span class='co'># S3 method for rasch.mml</span>
<span class='fu'>IRT.expectedCounts</span>(<span class='no'>object</span>,<span class='no'>...</span>)

<span class='co'># S3 method for IRT.modelfit.rasch.mml</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>,<span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>An \(N \times I\) data frame of dichotomous item responses. <br />
For the missing data item response model (<code>irtmodel='missing1'</code>),
code item responses by <code>9</code> which should be treated by the missing
  data model. Other missing responses can be coded by <code>NA</code>.</p></td>
    </tr>
    <tr>
      <th>theta.k</th>
      <td><p>Optional vector of discretized theta values. For multidimensional
IRT models with \(D\) dimensions, it is a matrix with \(D\) columns.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Vector of integers with group identifiers in multiple group estimation.
The multiple group does not work for <code>irtmodel="missing1"</code>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Optional vector of person weights (sample weights).</p></td>
    </tr>
    <tr>
      <th>constraints</th>
      <td><p>Constraints on <code>b</code> parameters (item difficulties). It must be
a matrix with two columns: the first column contains item names, the
second column fixed parameter values.</p></td>
    </tr>
    <tr>
      <th>glob.conv</th>
      <td><p>Convergence criterion for deviance</p></td>
    </tr>
    <tr>
      <th>parm.conv</th>
      <td><p>Convergence criterion for item parameters</p></td>
    </tr>
    <tr>
      <th>mitermax</th>
      <td><p>Maximum number of iterations in M step. This argument does only
apply for the estimation of the \(b\) parameters.</p></td>
    </tr>
    <tr>
      <th>mmliter</th>
      <td><p>Maximum number of iterations</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>Should progress be displayed at the console?</p></td>
    </tr>
    <tr>
      <th>fixed.a</th>
      <td><p>Fixed or initial \(a\) parameters</p></td>
    </tr>
    <tr>
      <th>fixed.c</th>
      <td><p>Fixed or initial \(c\) parameters</p></td>
    </tr>
    <tr>
      <th>fixed.d</th>
      <td><p>Fixed or initial \(d\) parameters</p></td>
    </tr>
    <tr>
      <th>fixed.K</th>
      <td><p>Fixed or initial \(K\) parameters in Ramsay's
quotient model.</p></td>
    </tr>
    <tr>
      <th>b.init</th>
      <td><p>Initial \(b\) parameters</p></td>
    </tr>
    <tr>
      <th>est.a</th>
      <td><p>Vector of integers which indicate which \(a\)
parameters should be estimated. Equal integers correspond
to the same estimated parameters.</p></td>
    </tr>
    <tr>
      <th>est.b</th>
      <td><p>Vector of integers which indicate which \(b\)
parameters should be estimated. Equal integers correspond
to the same estimated parameters.</p></td>
    </tr>
    <tr>
      <th>est.c</th>
      <td><p>Vector of integers which indicate which \(c\)
parameters should be estimated. Equal integers correspond
to the same estimated parameters.</p></td>
    </tr>
    <tr>
      <th>est.d</th>
      <td><p>Vector of integers which indicate which \(d\)
parameters should be estimated. Equal integers correspond
to the same estimated parameters.</p></td>
    </tr>
    <tr>
      <th>min.b</th>
      <td><p>Minimal \(b\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>max.b</th>
      <td><p>Maximal \(b\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>min.a</th>
      <td><p>Minimal \(a\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>max.a</th>
      <td><p>Maximal \(a\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>min.c</th>
      <td><p>Minimal \(c\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>max.c</th>
      <td><p>Maximal \(c\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>min.d</th>
      <td><p>Minimal \(d\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>max.d</th>
      <td><p>Maximal \(d\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>prior.b</th>
      <td><p>Optional prior distribution for \(b\) parameters:
\(N(\mu, \sigma)\). Input is a vector of length two with parameters
\(\mu\) and \(\sigma\).</p></td>
    </tr>
    <tr>
      <th>prior.a</th>
      <td><p>Optional prior distribution for \(a\) parameters:
\(N(\mu, \sigma)\). Input is a vector of length two with parameters
\(\mu\) and \(\sigma\).</p></td>
    </tr>
    <tr>
      <th>prior.c</th>
      <td><p>Optional prior distribution for \(c\) parameters:
\(Beta(a, b)\). Input is a vector of length two with parameters
\(a\) and \(b\).</p></td>
    </tr>
    <tr>
      <th>prior.d</th>
      <td><p>Optional prior distribution for \(d\) parameters:
\(Beta(a, b)\). Input is a vector of length two with parameters
\(a\) and \(b\).</p></td>
    </tr>
    <tr>
      <th>est.K</th>
      <td><p>Vector of integers which indicate which \(K\)
parameters should be estimated. Equal integers correspond
to the same estimated parameters.</p></td>
    </tr>
    <tr>
      <th>min.K</th>
      <td><p>Minimal \(K\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>max.K</th>
      <td><p>Maximal \(K\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>min.delta</th>
      <td><p>Minimal \(delta.miss\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>max.delta</th>
      <td><p>Maximal \(delta.miss\) parameter to be estimated</p></td>
    </tr>
    <tr>
      <th>beta.init</th>
      <td><p>Optional vector of initial \(\beta\) parameters</p></td>
    </tr>
    <tr>
      <th>min.beta</th>
      <td><p>Minimum \(\beta\) parameter to be estimated.</p></td>
    </tr>
    <tr>
      <th>pid</th>
      <td><p>Optional vector of person identifiers</p></td>
    </tr>
    <tr>
      <th>trait.weights</th>
      <td><p>Optional vector of trait weights for a fixing
the trait distribution.</p></td>
    </tr>
    <tr>
      <th>center.trait</th>
      <td><p>Should the trait distribution be centered</p></td>
    </tr>
    <tr>
      <th>center.b</th>
      <td><p>An optional logical indicating whether \(b\) parameters
should be centered at each dimension</p></td>
    </tr>
    <tr>
      <th>alpha1</th>
      <td><p>Fixed or initial \(\alpha_1\) parameter</p></td>
    </tr>
    <tr>
      <th>alpha2</th>
      <td><p>Fixed or initial \(\alpha_2\) parameter</p></td>
    </tr>
    <tr>
      <th>est.alpha</th>
      <td><p>Should \(\alpha\) parameters be estimated?</p></td>
    </tr>
    <tr>
      <th>equal.alpha</th>
      <td><p>Estimate \(\alpha\) parameters under the
assumption \(\alpha_1=\alpha_2\)?</p></td>
    </tr>
    <tr>
      <th>designmatrix</th>
      <td><p>Design matrix for item difficulties \(b\) to estimate
linear logistic test models</p></td>
    </tr>
    <tr>
      <th>alpha.conv</th>
      <td><p>Convergence criterion for \(\alpha\) parameter</p></td>
    </tr>
    <tr>
      <th>numdiff.parm</th>
      <td><p>Parameter for numerical differentiation</p></td>
    </tr>
    <tr>
      <th>numdiff.alpha.parm</th>
      <td><p>Parameter for numerical differentiation for \(\alpha\)
parameter</p></td>
    </tr>
    <tr>
      <th>distribution.trait</th>
      <td><p>Assumed trait distribution. The default is the normal
distribution (<code>"normal"</code>). Log-linear smoothing of the
trait distribution is also possible (<code>"smooth2"</code>,
<code>"smooth3"</code> or <code>"smooth4"</code> for smoothing up to
2, 3 or 4 moments, respectively).</p></td>
    </tr>
    <tr>
      <th>Qmatrix</th>
      <td><p>The Q-matrix</p></td>
    </tr>
    <tr>
      <th>variance.fixed</th>
      <td><p>Matrix for fixing covariance matrix (See Examples)</p></td>
    </tr>
    <tr>
      <th>variance.init</th>
      <td><p>Optional initial covariance matrix</p></td>
    </tr>
    <tr>
      <th>mu.fixed</th>
      <td><p>Matrix for fixing mean vector (See Examples)</p></td>
    </tr>
    <tr>
      <th>irtmodel</th>
      <td><p>Specify estimable IRT models: <code>raschtype</code> (Rasch type model),
<code>ramsay.qm</code> (Ramsay's quotient model), <code>npirt</code> (Nonparametric
item response model). If <code>npirt</code> is used as the argument
for <code>irtmodel</code>, the argument <code>npformula</code>
specifies different item response functions in the
<span style="R">R</span> formula framework (like <code>"y~I(theta^2)"</code>; see Examples).
For estimating the missing data item response model, use
<code>irtmodel='missing1'</code>.</p></td>
    </tr>
    <tr>
      <th>npformula</th>
      <td><p>A string or a vector which contains <span style="R">R</span> formula objects for specifying
the item response function. For example, <code>"y~theta"</code> is the specification
of the 2PL model (see Details). If <code>irtmodel="npirt"</code> and <code>npformula</code>
is not specified, then an unrestricted item response functions on the
grid of \(\theta\) values is estimated.</p></td>
    </tr>
    <tr>
      <th>npirt.monotone</th>
      <td><p>Should nonparametrically estimated item response functions
    be monotone? The default is <code>TRUE</code>. This function applies only
    to <code>irtmodel='npirt'</code> and <code>npformula=NULL</code>.</p></td>
    </tr>
    <tr>
      <th>use.freqpatt</th>
      <td><p>A logical if frequencies of pattern should be used or not.
    The default is <code><a href='https://rdrr.io/r/base/NULL.html'>is.null(group)</a></code>. This means that for single
    group analyses, frequency patterns are used but not for multiple
    groups. If data processing times are large, then <code>use.freqpatt=FALSE</code>
    is recommended.</p></td>
    </tr>
    <tr>
      <th>delta.miss</th>
      <td><p>Missingness parameter \(\delta\) quantifying the meaning
    of responding to an item between the two extremes of ignoring
     missing responses and setting all missing responses to incorrect</p></td>
    </tr>
    <tr>
      <th>est.delta</th>
      <td><p>Vector with indices indicating the \(\delta\) parameters
    to be estimated if <code>irtmodel="missing1"</code>.</p></td>
    </tr>
    <tr>
      <th>nimps</th>
      <td><p>Number of imputed datasets of item responses</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Object of class <code>rasch.mml</code></p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Object of class <code>rasch.mml</code></p></td>
    </tr>
    <tr>
      <th>items</th>
      <td><p>Vector of integer or item names which should be plotted</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>Specification for <code>xlim</code> in plot</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>Title of the plot</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>Optional file name for summary output</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The item response function of the generalized item response model
(<code>irtmodel="raschtype"</code>; Stukel, 1988) can be written as
$$P( X_{pi}=1 | \theta_{pd} )=c_i + (d_i - c_i ) g_{\alpha_1, \alpha_2}
[ a_i ( \theta_{pd} - b_i ) ] $$
where \(g\) is the generalized logistic link function depending
on parameters \(\alpha_1\) and \(\alpha_2\).</p>
<p>For the most important link functions the specifications are (Stukel, 1988):</p>
<p>logistic link function: \(\alpha_1=0\) and \(\alpha_2=0\) <br />
probit link function: \(\alpha_1=0.165\) and \(\alpha_2=0.165\) <br />
loglog link function: \(\alpha_1=-0.037\) and \(\alpha_2=0.62\) <br />
cloglog link function: \(\alpha_1=0.62\) and \(\alpha_2=-0.037\)</p>
<p>See <code><a href='pgenlogis.html'>pgenlogis</a></code> for exact transformation formulas of
the mentioned link functions. <br /></p>
<p>A \(D\)-dimensional model can also be specified
but only allows for between item dimensionality
(one item loads on one and only dimension).
Setting \(c_i=0\), \(d_i=1\) and  \(a_i=1\) for all items \(i\),
an additive item response model
$$P( X_{pi}=1 | \theta_p )=g_{\alpha_1, \alpha_2} ( \theta_p - b_i  ) $$
is estimated.</p>
<p>Ramsay's quotient model (<code>irtmodel="qm.ramsay"</code>) uses
the item response function
$$P( X_{pi}=1 | \theta_p )=\frac{ \exp(\theta_p / b_i)}
    { K_i + \exp (\theta_p / b_i )} $$</p>
<p>Quite general unidimensional item response models can be estimated
in a nonparametric framework (<code>irtmodel="npirt"</code>). The response
functions are a linear combination of transformed \(\theta\)
values
$$logit[ P( X_{pi}=1 | \theta_p ) ]=Y_\theta \beta $$
Where \(Y_\theta\) is a design matrix of \(\theta\) and
\(\beta\) are item parameters to be estimated.
The formula \(Y_\theta \beta\) can be specified in the <span style="R">R</span> formula
framework (see Example 3, Model 3c).</p>
<p>Pseudo-likelihood estimation can be conducted for fractional item response data
as input (i.e. some item response \(x_{pi}\) do have values
between 0 and 1). Then the pseudo-likelihood \(L_p\) for person \(p\) is defined as
$$ L_p=\prod_i P_i ( \theta_p )^{x_{pi}} [1-P_i ( \theta_p )]^{(1-x_{pi})}$$
Note that for dichotomous responses this term corresponds to the ordinary
likelihood. See Example 7.</p>
<p>A special two-dimensional missing data item response model (<code>irtmodel="missing1"</code>)
is implemented according to Mislevy and Wu (1996).
Besides an unidimensional ability \(\theta_p\),
an individual response propensity \(\xi_p\) is proposed. We define
item responses \(X_{pi}\) and response indicators \(R_{pi}\) indicating whether
item responses \(X_{pi}\) are observed or not. Denoting the logistic function
by \(\Psi\), the item response model for ability is defined as
$$ P( X_{pi}=1  | \theta_p, \xi_p )=P( X_{pi}=1 | \theta_p )
=\Psi( a_i (\theta_p - b_i ))$$
We also define a measurement model for response indicators \(R_{pi}\) which depends
on the item response \(X_{pi}\) itself:
$$P( R_{pi}=1 | X_{pi}=k, \theta_p, \xi_p )=
    P( R_{pi}=1 | X_{pi}=k, \xi_p )=
\Psi \left[  \xi_p -  \beta_i - k \delta _i  \right] \quad \mbox{ for }
\quad k=0,1$$
If \(\delta _i=0\), then the probability of responding to an item is independent
of the incompletely observed item \(X_{pi}\) which is an
item response model with nonignorable missings (Holman &amp; Glas, 2005;
see also Pohl, Graefe &amp; Rose, 2014).
If \(\delta _i\) is a large negative number (e.g. \(\delta=-100\)), then
it follows \(P( R_{pi}=1 | X_{pi}=1, \theta_p, \xi_p )=1\)
and as a consequence it holds that \(P(X_{pi}=1 | R_{pi}=0, \theta_p, \xi_p)=0\),
which is equivalent to treating
all missing item responses as incorrect. The missingness parameter
\(\delta\) can be specified
by the user and studied as a sensitivity analysis under different
missing not at random assumptions or can be estimated by choosing
<code>est.delta=TRUE</code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with following entries</p>
<dt>dat</dt><dd><p>Original data frame</p></dd>
<dt>item</dt><dd><p>Estimated item parameters in the generalized
    item response model</p></dd>
<dt>item2</dt><dd><p>Estimated item parameters for Ramsay's quotient model</p></dd>
<dt>trait.distr</dt><dd><p>Discretized ability distribution points and probabilities</p></dd>
<dt>mean.trait</dt><dd><p>Estimated mean vector</p></dd>
<dt>sd.trait</dt><dd><p>Estimated standard deviations</p></dd>
<dt>skewness.trait</dt><dd><p>Estimated skewnesses</p></dd>
<dt>deviance</dt><dd><p>Deviance</p></dd>
<dt>pjk</dt><dd><p>Estimated probabilities of item correct evaluated at <code>theta.k</code></p></dd>
<dt>rprobs</dt><dd><p>Item response probabilities like in <code>pjk</code>, but slightly
extended to accommodate all categories</p></dd>
<dt>person</dt><dd><p>Person parameter estimates: mode (<code>MAP</code>) and
    mean (<code>EAP</code>) of the posterior distribution</p></dd>
<dt>pid</dt><dd><p>Person identifier</p></dd>
<dt>ability.est.pattern</dt><dd><p>Response pattern estimates</p></dd>
<dt>f.qk.yi</dt><dd><p>Individual posterior distribution</p></dd>
<dt>f.yi.qk</dt><dd><p>Individual likelihood</p></dd>
<dt>fixed.a</dt><dd><p>Estimated \(a\) parameters</p></dd>
<dt>fixed.c</dt><dd><p>Estimated \(c\) parameters</p></dd>
<dt>G</dt><dd><p>Number of groups</p></dd>
<dt>alpha1</dt><dd><p>Estimated \(\alpha_1\) parameter in generalized logistic
    item response model</p></dd>
<dt>alpha2</dt><dd><p>Estimated \(\alpha_2\) parameter in generalized logistic
    item response model</p></dd>
<dt>se.b</dt><dd><p>Standard error of \(b\) parameter in generalized logistic model
    or Ramsay's quotient model</p></dd>
<dt>se.a</dt><dd><p>Standard error of \(a\) parameter in generalized logistic model</p></dd>
<dt>se.c</dt><dd><p>Standard error of \(c\) parameter in generalized logistic model</p></dd>
<dt>se.d</dt><dd><p>Standard error of \(d\) parameter in generalized logistic model</p></dd>
<dt>se.alpha</dt><dd><p>Standard error of \(\alpha\) parameter in generalized
    logistic model</p></dd>
<dt>se.K</dt><dd><p>Standard error of \(K\) parameter in Ramsay's quotient model</p></dd>
<dt>iter</dt><dd><p>Number of iterations</p></dd>
<dt>reliability</dt><dd><p>EAP reliability</p></dd>
<dt>irtmodel</dt><dd><p>Type of estimated item response model</p></dd>
<dt>D</dt><dd><p>Number of dimensions</p></dd>
<dt>mu</dt><dd><p>Mean vector (for multidimensional models)</p></dd>
<dt>Sigma.cov</dt><dd><p>Covariance matrix (for multdimensional models)</p></dd>
<dt>theta.k</dt><dd><p>Grid of discretized ability distributions</p></dd>
<dt>trait.weights</dt><dd><p>Fixed vector of probabilities for the ability distribution</p></dd>
<dt>pi.k</dt><dd><p>Trait distribution</p></dd>
<dt>ic</dt><dd><p>Information criteria</p></dd>
<dt>esttype</dt><dd><p>Estimation type: <code>ll</code> (Log-Likelihood),
    <code>pseudoll</code> (Pseudo-Log-Likelihood)</p></dd>
<dt>...</dt><dd><p></p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Holman, R., &amp; Glas, C. A. (2005). Modelling non-ignorable missing-data mechanisms
with item response theory models.
<em>British Journal of Mathematical and Statistical Psychology, 58</em>(1), 1-17.
doi: <a href='https://doi.org/10.1348/000711005X47168'>10.1348/000711005X47168</a></p>
<p>Loken, E., &amp; Rulison, K. L. (2010). Estimation of a four-parameter
item response theory model. <em>British Journal of Mathematical
and Statistical Psychology, 63</em>(3), 509-525.
doi: <a href='https://doi.org/10.1348/000711009X474502'>10.1348/000711009X474502</a></p>
<p>Mislevy, R. J., &amp; Wu, P. K. (1996). <em>Missing responses and IRT ability
estimation: Omits, choice, time Limits, and adaptive testing</em>.
ETS Research Report ETS RR-96-30. Princeton, ETS.
doi: <a href='https://doi.org/10.1002/j.2333-8504.1996.tb01708.x'>10.1002/j.2333-8504.1996.tb01708.x</a></p>
<p>Pohl, S., Graefe, L., &amp; Rose, N. (2014). Dealing with omitted and
not-reached items in competence tests evaluating approaches accounting for
missing responses in item response theory models.
<em>Educational and Psychological Measurement, 74</em>(3), 423-452.
doi: <a href='https://doi.org/10.1177/0013164413504926'>10.1177/0013164413504926</a></p>
<p>Ramsay, J. O. (1989). A comparison of three simple test theory models.
<em>Psychometrika, 54</em>, 487-499.
doi: <a href='https://doi.org/10.1007/BF02294631'>10.1007/BF02294631</a></p>
<p>Rossi, N., Wang, X., &amp; Ramsay, J. O. (2002). Nonparametric item response
function estimates with the EM algorithm.
<em>Journal of Educational and Behavioral Statistics, 27</em>(3), 291-317.
doi: <a href='https://doi.org/10.3102/10769986027003291'>10.3102/10769986027003291</a></p>
<p>Stukel, T. A. (1988). Generalized logistic models.
<em>Journal of the American Statistical Association, 83</em>(402), 426-431.
doi: <a href='https://doi.org/10.1080/01621459.1988.10478613'>10.1080/01621459.1988.10478613</a></p>
<p>van der Maas, H. J. L., Molenaar, D., Maris, G., Kievit, R. A., &amp;
Borsboom, D. (2011).
Cognitive psychology meets psychometric theory: On the relation between
process models for decision making and latent variable models for
individual differences.
<em>Psychological Review, 118</em>(2), 339-356.
doi: 10.1037/a0022749</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Multiple group estimation is not possible for
Ramsay's quotient model and multdimensional models.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Simulate the generalized logistic Rasch model with <code><a href='sim.raschtype.html'>sim.raschtype</a></code>.</p>
<p>Simulate Ramsay's quotient model with <code><a href='sim.qm.ramsay.html'>sim.qm.ramsay</a></code>.</p>
<p>Simulate locally dependent item response data using <code><a href='sim.rasch.dep.html'>sim.rasch.dep</a></code>.</p>
<p>For an assessment of global model fit see <code><a href='modelfit.sirt.html'>modelfit.sirt</a></code>.</p>
<p>See <code><a href='https://rdrr.io/pkg/CDM/man/itemfit.sx2.html'>CDM::itemfit.sx2</a></code> for item fit
statistics.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Reading dataset</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>CDM</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.read</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.read</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>) <span class='co'># number of items</span>

<span class='co'># Rasch model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>( <span class='no'>mod1</span> )    <span class='co'># plot all items</span>
<span class='co'># title 'Rasch model', display curves from -3 to 3 only for items 1, 5 and 8</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod1</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Rasch model Items 1, 5 and 8"</span>, <span class='kw'>xlim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>3</span>,<span class='fl'>3</span>), <span class='kw'>items</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='fl'>8</span>) )

<span class='co'># Rasch model with constraints on item difficulties</span>
<span class='co'># set item parameters of A1 and C3 equal to -2</span>
<span class='no'>constraints</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"A1"</span>,<span class='st'>"C3"</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2</span>,-<span class='fl'>2</span>) )
<span class='no'>mod1a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>constraints</span><span class='kw'>=</span><span class='no'>constraints</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1a</span>)

<span class='co'># estimate equal item parameters for 1st and 11th item</span>
<span class='no'>est.b</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='no'>I</span>
<span class='no'>est.b</span>[<span class='fl'>11</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>mod1b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>est.b</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1b</span>)

<span class='co'># estimate Rasch model with skew trait distribution</span>
<span class='no'>mod1c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>distribution.trait</span><span class='kw'>=</span><span class='st'>"smooth3"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1c</span>)

<span class='co'># 2PL model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod2</span>)    <span class='co'># plot 2PL item response curves</span>

<span class='co'># extract individual likelihood</span>
<span class='no'>llmod2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/CDM/man/IRT.likelihood.html'>IRT.likelihood</a></span>(<span class='no'>mod2</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>llmod2</span>)

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>CDM</span>)
<span class='co'># model comparisons</span>
<span class='kw pkg'>CDM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/CDM/man/IRT.compareModels.html'>IRT.compareModels</a></span>(<span class='no'>mod1</span>, <span class='no'>mod1c</span>, <span class='no'>mod2</span> )
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span>(<span class='no'>mod1</span>,<span class='no'>mod2</span>)

<span class='co'># assess model fit</span>
<span class='no'>smod1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/CDM/man/IRT.modelfit.html'>IRT.modelfit</a></span>(<span class='no'>mod1</span>)
<span class='no'>smod2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/CDM/man/IRT.modelfit.html'>IRT.modelfit</a></span>(<span class='no'>mod2</span>)
<span class='fu'><a href='https://rdrr.io/pkg/CDM/man/IRT.compareModels.html'>IRT.compareModels</a></span>(<span class='no'>smod1</span>, <span class='no'>smod2</span>)

<span class='co'># set some bounds for a and b parameters</span>
<span class='no'>mod2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>, <span class='kw'>min.a</span><span class='kw'>=</span><span class='fl'>.7</span>, <span class='kw'>max.a</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>min.b</span><span class='kw'>=</span>-<span class='fl'>2</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2a</span>)

<span class='co'># 3PL model</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>, <span class='kw'>est.c</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>,
              <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>400</span> <span class='co'># maximal 400 iterations</span>
                 )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'># 3PL model with fixed guessing paramters of .25 and equal slopes</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>fixed.c</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fl'>.25</span>, <span class='no'>I</span> )   )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)

<span class='co'># 3PL model with equal guessing paramters for all items</span>
<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.c</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='no'>I</span> )   )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod5</span>)

<span class='co'># difficulty + guessing model</span>
<span class='no'>mod6</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.c</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>   )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod6</span>)

<span class='co'># 4PL model</span>
<span class='no'>mod7</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>, <span class='kw'>est.c</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>, <span class='kw'>est.d</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>,
            <span class='kw'>min.d</span><span class='kw'>=</span><span class='fl'>.95</span>, <span class='kw'>max.c</span><span class='kw'>=</span><span class='fl'>.25</span>)
        <span class='co'># set minimal d and maximal c parameter to .95 and .25</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod7</span>)

<span class='co'># 4PL model with prior distributions</span>
<span class='no'>mod7b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>, <span class='kw'>est.c</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>, <span class='kw'>est.d</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>, <span class='kw'>prior.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>),
            <span class='kw'>prior.c</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>17</span>), <span class='kw'>prior.d</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20</span>,<span class='fl'>2</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod7b</span>)

<span class='co'># constrained 4PL model</span>
<span class='co'># equal slope, guessing and slipping parameters</span>
<span class='no'>mod8</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>,<span class='kw'>est.c</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>I</span>), <span class='kw'>est.d</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>I</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod8</span>)

<span class='co'># estimation of an item response model with an</span>
<span class='co'># uniform theta distribution</span>
<span class='no'>theta.k</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( <span class='fl'>0.01</span>, <span class='fl'>.99</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>20</span> )
<span class='no'>trait.weights</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fl'>1</span>/<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>theta.k</span>), <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>theta.k</span>) )
<span class='no'>mod9</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>theta.k</span><span class='kw'>=</span><span class='no'>theta.k</span>, <span class='kw'>trait.weights</span><span class='kw'>=</span><span class='no'>trait.weights</span>,
              <span class='kw'>normal.trait</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>12</span>  )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod9</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 2: Longitudinal data</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.long</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.long</span>[,-<span class='fl'>1</span>]

<span class='co'># define Q loading matrix</span>
<span class='no'>Qmatrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='fl'>12</span>, <span class='fl'>2</span> )
<span class='no'>Qmatrix</span>[<span class='fl'>1</span>:<span class='fl'>6</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span> <span class='co'># T1 items</span>
<span class='no'>Qmatrix</span>[<span class='fl'>7</span>:<span class='fl'>12</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>    <span class='co'># T2 items</span>

<span class='co'># define restrictions on item difficulties</span>
<span class='no'>est.b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span>,   <span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>8</span>)
<span class='no'>mu.fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fl'>1</span>,<span class='fl'>0</span>)
    <span class='co'># set first mean to 0 for identification reasons</span>

<span class='co'># Model 1: 2-dimensional Rasch model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>Qmatrix</span><span class='kw'>=</span><span class='no'>Qmatrix</span>, <span class='kw'>miterstep</span><span class='kw'>=</span><span class='fl'>4</span>,
            <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>est.b</span>,  <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='no'>mu.fixed</span>, <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>30</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod1</span>)
<span class='co'>##     Plot function is only applicable for unidimensional models</span>
}

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 3: One group, estimation of alpha parameter in the generalized logistic model</span>
<span class='co'>#############################################################################</span>

<span class='co'># simulate theta values</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>786</span>)
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>                  <span class='co'># number of persons</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1.5</span> ) <span class='co'># N persons with SD 1.5</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( -<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>15</span>)

<span class='co'># simulate data</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw'>theta</span><span class='kw'>=</span><span class='no'>theta</span>, <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span>, <span class='kw'>alpha1</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>alpha2</span><span class='kw'>=</span>-<span class='fl'>0.3</span> )

<span class='co'>#  estimating alpha parameters</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.alpha</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>30</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod1</span>)

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># fixed alpha parameters</span>
<span class='no'>mod1b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.alpha</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>alpha1</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>alpha2</span><span class='kw'>=</span>-<span class='fl'>.3</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1b</span>)

<span class='co'># estimation with equal alpha parameters</span>
<span class='no'>mod1c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.alpha</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>equal.alpha</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1c</span>)

<span class='co'># Ramsay QM</span>
<span class='no'>mod2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"ramsay.qm"</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2a</span>)
}

<span class='co'># Ramsay QM with estimated K parameters</span>
<span class='no'>mod2b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"ramsay.qm"</span>, <span class='kw'>est.K</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>15</span>, <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>30</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2b</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod2b</span>)

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># nonparametric estimation of monotone item response curves</span>
<span class='no'>mod3a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"npirt"</span>, <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>100</span>,
            <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( -<span class='fl'>3</span>, <span class='fl'>3</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>) ) <span class='co'># evaluations at 10 theta grid points</span>
<span class='co'># nonparametric ICC of first 4 items</span>
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>mod3a</span>$<span class='no'>pjk</span>)[<span class='fl'>1</span>:<span class='fl'>4</span>,], <span class='fl'>3</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3a</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod3a</span>)

<span class='co'># nonparametric IRT estimation without monotonicity assumption</span>
<span class='no'>mod3b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"npirt"</span>, <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>10</span>,
            <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( -<span class='fl'>3</span>, <span class='fl'>3</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>), <span class='kw'>npirt.monotone</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod3b</span>)

<span class='co'># B-Spline estimation of ICCs</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>splines</span>)
<span class='no'>mod3c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"npirt"</span>,
             <span class='kw'>npformula</span><span class='kw'>=</span><span class='st'>"y~bs(theta,df=3)"</span>, <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>15</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3c</span>)
<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>mod3c</span>$<span class='no'>pjk</span>)[<span class='fl'>1</span>:<span class='fl'>6</span>,], <span class='fl'>3</span> )
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod3c</span>)

<span class='co'># estimation of quadratic item response functions: ~ theta + I( theta^2)</span>
<span class='no'>mod3d</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"npirt"</span>,
             <span class='kw'>npformula</span><span class='kw'>=</span><span class='st'>"y~theta + I(theta^2)"</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3d</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod3d</span>)

<span class='co'># estimation of a stepwise ICC function</span>
<span class='co'># ICCs are constant on the theta domains: [-Inf,-1], [-1,1], [1,Inf]</span>
<span class='no'>mod3e</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"npirt"</span>,
             <span class='kw'>npformula</span><span class='kw'>=</span><span class='st'>"y~I(theta&gt;-1 )+I(theta&gt;1)"</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3e</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>mod3e</span>, <span class='kw'>xlim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2.5</span>,<span class='fl'>2.5</span>) )

<span class='co'># 2PL model</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>,  <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>15</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 4: Two groups, estimation of generalized logistic model</span>
<span class='co'>#############################################################################</span>

<span class='co'># simulate generalized logistic Rasch model in two groups</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>8765</span>)
<span class='no'>N1</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>     <span class='co'># N1=1000 persons in group 1</span>
<span class='no'>N2</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span>      <span class='co'># N2=500 persons in group 2</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw'>theta</span><span class='kw'>=</span><span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N1</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>1.5</span> ), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span>,
            <span class='kw'>alpha1</span><span class='kw'>=</span>-<span class='fl'>0.3</span>, <span class='kw'>alpha2</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw'>theta</span><span class='kw'>=</span><span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>N2</span>, <span class='kw'>mean</span><span class='kw'>=</span>-<span class='fl'>.5</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fl'>.75</span>),
            <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b</span>, <span class='kw'>alpha1</span><span class='kw'>=</span>-<span class='fl'>0.3</span>, <span class='kw'>alpha2</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>( <span class='no'>dat1</span>, <span class='no'>dat2</span> )
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>N1</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>,<span class='no'>N2</span>))

<span class='no'>mod1</span> <span class='kw'>&lt;-</span>  <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat1</span>, <span class='kw'>parm.conv</span><span class='kw'>=</span><span class='fl'>.0001</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>, <span class='kw'>est.alpha</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 5: Multidimensional model</span>
<span class='co'>#############################################################################</span>

<span class='co'>#***</span>
<span class='co'># (1) simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>785</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>mvtnorm</span>)
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mvtnorm</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span>( <span class='no'>N</span>,<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>), <span class='kw'>sigma</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1.45</span>,<span class='fl'>.5</span>,<span class='fl'>.5</span>,<span class='fl'>1.7</span>), <span class='fl'>2</span>, <span class='fl'>2</span> ))
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
<span class='co'># 10 items load on the first dimension</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>( <span class='no'>theta</span>[,<span class='fl'>1</span>], <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( -<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span> ), <span class='st'>"-"</span> ) )
<span class='no'>resp1</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> * ( <span class='no'>p1</span> <span class='kw'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>( <span class='no'>N</span>*<span class='no'>I</span> ), <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>N</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span> ) )
<span class='co'># 10 items load on the second dimension</span>
<span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>( <span class='no'>theta</span>[,<span class='fl'>2</span>], <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( -<span class='fl'>2</span>, <span class='fl'>2</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='no'>I</span> ), <span class='st'>"-"</span> ) )
<span class='no'>resp2</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> * ( <span class='no'>p1</span> <span class='kw'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>( <span class='no'>N</span>*<span class='no'>I</span> ), <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>N</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>I</span> ) )
<span class='co'>#Combine the two sets of items into one response matrix</span>
<span class='no'>resp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>resp1</span>,<span class='no'>resp2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>resp</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"I"</span>, <span class='fl'>1</span>:(<span class='fl'>2</span>*<span class='no'>I</span>), <span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>resp</span>

<span class='co'># define Q-matrix</span>
<span class='no'>Qmatrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='fl'>2</span>*<span class='no'>I</span>, <span class='fl'>2</span> )
<span class='no'>Qmatrix</span>[<span class='fl'>1</span>:<span class='no'>I</span>,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>Qmatrix</span>[<span class='fl'>1</span>:<span class='no'>I</span>+<span class='no'>I</span>,<span class='fl'>2</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>

<span class='co'>#***</span>
<span class='co'># (2) estimation of models</span>
<span class='co'># 2-dimensional Rasch model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>Qmatrix</span><span class='kw'>=</span><span class='no'>Qmatrix</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'># 2-dimensional 2PL model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>Qmatrix</span><span class='kw'>=</span><span class='no'>Qmatrix</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fl'>1</span>:(<span class='fl'>2</span>*<span class='no'>I</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'># estimation with some fixed variances and covariances</span>
<span class='co'># set variance of 1st dimension to 1 and</span>
<span class='co'>#  covariance to zero</span>
<span class='no'>variance.fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>0</span>)),
             <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>3</span> )
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>Qmatrix</span><span class='kw'>=</span><span class='no'>Qmatrix</span>, <span class='kw'>variance.fixed</span><span class='kw'>=</span><span class='no'>variance.fixed</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)

<span class='co'># constraints on item difficulties</span>
<span class='co'>#  useful for example in longitudinal linking</span>
<span class='no'>est.b</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fl'>1</span>:<span class='no'>I</span>, <span class='fl'>1</span>:<span class='no'>I</span> )
    <span class='co'># equal indices correspond to equally estimated item parameters</span>
<span class='no'>mu.fixed</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='fl'>1</span>, <span class='fl'>0</span> )
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>Qmatrix</span><span class='kw'>=</span><span class='no'>Qmatrix</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>est.b</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='no'>mu.fixed</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 6: Two booklets with same items but with item context effects.</span>
<span class='co'># Therefore, item slopes and item difficulties are assumed to be shifted in the</span>
<span class='co'># second design group.</span>
<span class='co'>#############################################################################</span>

<span class='co'>#***</span>
<span class='co'># simulate data</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>987</span>)
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>     <span class='co'># number of items</span>
<span class='co'># define person design groups 1 and 2</span>
<span class='no'>n1</span> <span class='kw'>&lt;-</span> <span class='fl'>700</span>
<span class='no'>n2</span> <span class='kw'>&lt;-</span> <span class='fl'>1500</span>
<span class='co'># item difficulties group 1</span>
<span class='no'>b1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>1.5</span>,<span class='fl'>1.5</span>,<span class='kw'>length</span><span class='kw'>=</span><span class='no'>I</span>)
<span class='co'># item slopes group 1</span>
<span class='no'>a1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='no'>I</span>)
<span class='co'># simulate data group 1</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n1</span>), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b1</span>, <span class='kw'>fixed.a</span><span class='kw'>=</span><span class='no'>a1</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat1</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"I"</span>, <span class='fl'>1</span>:<span class='no'>I</span>, <span class='st'>"des1"</span> )
<span class='co'># group 2</span>
<span class='no'>b2</span> <span class='kw'>&lt;-</span> <span class='no'>b1</span> - <span class='fl'>.15</span>
<span class='no'>a2</span> <span class='kw'>&lt;-</span> <span class='fl'>1.1</span>*<span class='no'>a1</span>
<span class='co'># Item parameters are slightly transformed in the second group</span>
<span class='co'># compared to the first group. This indicates possible item context effects.</span>

<span class='co'># simulate data group 2</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='sim.raschtype.html'>sim.raschtype</a></span>( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>n2</span>), <span class='kw'>b</span><span class='kw'>=</span><span class='no'>b2</span>, <span class='kw'>fixed.a</span><span class='kw'>=</span><span class='no'>a2</span> )
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat2</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"I"</span>, <span class='fl'>1</span>:<span class='no'>I</span>, <span class='st'>"des2"</span> )
<span class='co'># define joint dataset</span>
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>NA</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>n1</span>+<span class='no'>n2</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>2</span>*<span class='no'>I</span>)
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat1</span>), <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat2</span>) )
<span class='no'>dat</span>[ <span class='fl'>1</span>:<span class='no'>n1</span>, <span class='fl'>1</span>:<span class='no'>I</span> ] <span class='kw'>&lt;-</span> <span class='no'>dat1</span>
<span class='no'>dat</span>[ <span class='no'>n1</span> + <span class='fl'>1</span>:<span class='no'>n2</span>, <span class='no'>I</span> + <span class='fl'>1</span>:<span class='no'>I</span> ] <span class='kw'>&lt;-</span> <span class='no'>dat2</span>
<span class='co'># define group identifier</span>
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>n1</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>,<span class='no'>n2</span>) )

<span class='co'>#***</span>
<span class='co'># Model 1: Rasch model two groups</span>
<span class='no'>itemindex</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fl'>1</span>:<span class='no'>I</span>, <span class='fl'>2</span> )
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>group</span>, <span class='kw'>est.b</span><span class='kw'>=</span><span class='no'>itemindex</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)

<span class='co'>#***</span>
<span class='co'># Model 2: two item slope groups and designmatrix for intercepts</span>
<span class='no'>designmatrix</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='fl'>2</span>*<span class='no'>I</span>, <span class='no'>I</span>+<span class='fl'>1</span>)
<span class='no'>designmatrix</span>[ ( <span class='fl'>1</span>:<span class='no'>I</span> )+ <span class='no'>I</span>,<span class='fl'>1</span>:<span class='no'>I</span>] <span class='kw'>&lt;-</span> <span class='no'>designmatrix</span>[<span class='fl'>1</span>:<span class='no'>I</span>,<span class='fl'>1</span>:<span class='no'>I</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>I</span>)
<span class='no'>designmatrix</span>[ ( <span class='fl'>1</span>:<span class='no'>I</span> )+ <span class='no'>I</span>,<span class='no'>I</span>+<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>2</span>,<span class='kw'>each</span><span class='kw'>=</span><span class='no'>I</span>), <span class='kw'>designmatrix</span><span class='kw'>=</span><span class='no'>designmatrix</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 7: PIRLS dataset with missing responses</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.pirlsmissing</span>)
<span class='no'>items</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>( <span class='st'>"R31"</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>data.pirlsmissing</span>), <span class='kw'>value</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>items</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.pirlsmissing</span>

<span class='co'>#****</span>
<span class='co'># Model 1: recode missing responses as missing (missing are ignorable)</span>

<span class='co'># data recoding</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='no'>dat1</span>[ <span class='no'>dat1</span><span class='kw'>==</span><span class='fl'>9</span> ] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='co'># estimate Rasch model</span>
<span class='no'>mod1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat1</span>[,<span class='no'>items</span>], <span class='kw'>weights</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>studwgt</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>country</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1</span>)
<span class='co'>##   Mean=0 0.341 -0.134 0.219</span>
<span class='co'>##   SD=1.142 1.166 1.197 0.959</span>

<span class='co'>#****</span>
<span class='co'># Model 2: recode missing responses as wrong</span>

<span class='co'># data recoding</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='no'>dat2</span>[ <span class='no'>dat2</span><span class='kw'>==</span><span class='fl'>9</span> ] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='co'># estimate Rasch model</span>
<span class='no'>mod2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat2</span>[,<span class='no'>items</span>], <span class='kw'>weights</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>studwgt</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>country</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2</span>)
  <span class='co'>##   Mean=0 0.413 -0.172 0.446</span>
  <span class='co'>##   SD=1.199 1.263 1.32 0.996</span>

<span class='co'>#****</span>
<span class='co'># Model 3: recode missing responses as rho * P_i( theta ) and</span>
<span class='co'>#          apply pseudo-log-likelihood estimation</span>
<span class='co'># Missing item responses are predicted by the model implied probability</span>
<span class='co'># P_i( theta ) where theta is the ability estimate when ignoring missings (Model 1)</span>
<span class='co'># and rho is an adjustment parameter. rho=0 is equivalent to Model 2 (treating</span>
<span class='co'># missing as wrong) and rho=1 is equivalent to Model 1 (treating missing as ignorable).</span>

<span class='co'># data recoding</span>
<span class='no'>dat3</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='co'># simulate theta estimate from posterior distribution</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>dat3</span>), <span class='kw'>mean</span><span class='kw'>=</span><span class='no'>mod1</span>$<span class='no'>person</span>$<span class='no'>EAP</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='no'>mod1</span>$<span class='no'>person</span>$<span class='no'>SE.EAP</span> )
<span class='no'>rho</span> <span class='kw'>&lt;-</span> <span class='fl'>.3</span>   <span class='co'># define a rho parameter value of .3</span>
<span class='kw'>for</span> (<span class='no'>ii</span> <span class='kw'>in</span> <span class='no'>items</span>){
    <span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>dat</span>[,<span class='no'>ii</span>]<span class='kw'>==</span><span class='fl'>9</span> )
    <span class='no'>dat3</span>[<span class='no'>ind</span>,<span class='no'>ii</span>] <span class='kw'>&lt;-</span> <span class='no'>rho</span>*<span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>( <span class='no'>theta</span>[<span class='no'>ind</span>] - <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>b</span>[ <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>items</span><span class='kw'>==</span><span class='no'>ii</span> ) ] )
                }

<span class='co'># estimate Rasch model</span>
<span class='no'>mod3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat3</span>[,<span class='no'>items</span>], <span class='kw'>weights</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>studwgt</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>country</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3</span>)
  <span class='co'>##   Mean=0 0.392 -0.153 0.38</span>
  <span class='co'>##   SD=1.154 1.209 1.246 0.973</span>

<span class='co'>#****</span>
<span class='co'># Model 4: simulate missing responses as rho * P_i( theta )</span>
<span class='co'># The definition is the same as in Model 3. But it is now assumed</span>
<span class='co'># that the missing responses are 'latent responses'.</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>789</span>)

<span class='co'># data recoding</span>
<span class='no'>dat4</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='co'># simulate theta estimate from posterior distribution</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>dat4</span>), <span class='kw'>mean</span><span class='kw'>=</span><span class='no'>mod1</span>$<span class='no'>person</span>$<span class='no'>EAP</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='no'>mod1</span>$<span class='no'>person</span>$<span class='no'>SE.EAP</span> )
<span class='no'>rho</span> <span class='kw'>&lt;-</span> <span class='fl'>.3</span>   <span class='co'># define a rho parameter value of .3</span>
<span class='kw'>for</span> (<span class='no'>ii</span> <span class='kw'>in</span> <span class='no'>items</span>){
    <span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>dat</span>[,<span class='no'>ii</span>]<span class='kw'>==</span><span class='fl'>9</span> )
    <span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='no'>rho</span>*<span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>( <span class='no'>theta</span>[<span class='no'>ind</span>] - <span class='no'>mod1</span>$<span class='no'>item</span>$<span class='no'>b</span>[ <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>items</span><span class='kw'>==</span><span class='no'>ii</span> ) ] )
    <span class='no'>dat4</span>[ <span class='no'>ind</span>, <span class='no'>ii</span> ] <span class='kw'>&lt;-</span> <span class='fl'>1</span>*( <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>ind</span>), <span class='fl'>0</span>, <span class='fl'>1</span> ) <span class='kw'>&lt;</span> <span class='no'>p3</span>)
                }

<span class='co'># estimate Rasch model</span>
<span class='no'>mod4</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat4</span>[,<span class='no'>items</span>], <span class='kw'>weights</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>studwgt</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>country</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4</span>)
  <span class='co'>##   Mean=0 0.396 -0.156 0.382</span>
  <span class='co'>##   SD=1.16 1.216 1.253 0.979</span>

<span class='co'>#****</span>
<span class='co'># Model 5: recode missing responses for multiple choice items with four alternatives</span>
<span class='co'>#          to 1/4 and apply pseudo-log-likelihood estimation.</span>
<span class='co'>#          Missings for constructed response items are treated as incorrect.</span>

<span class='co'># data recoding</span>
<span class='no'>dat5</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='no'>items_mc</span> <span class='kw'>&lt;-</span> <span class='no'>items</span>[ <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>( <span class='no'>items</span>, <span class='fl'>7</span>,<span class='fl'>7</span>)<span class='kw'>==</span><span class='st'>"M"</span> ]
<span class='no'>items_cr</span> <span class='kw'>&lt;-</span> <span class='no'>items</span>[ <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>( <span class='no'>items</span>, <span class='fl'>7</span>,<span class='fl'>7</span>)<span class='kw'>==</span><span class='st'>"C"</span> ]
<span class='kw'>for</span> (<span class='no'>ii</span> <span class='kw'>in</span> <span class='no'>items_mc</span>){
    <span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>dat</span>[,<span class='no'>ii</span>]<span class='kw'>==</span><span class='fl'>9</span> )
    <span class='no'>dat5</span>[<span class='no'>ind</span>,<span class='no'>ii</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>/<span class='fl'>4</span>
                }
<span class='kw'>for</span> (<span class='no'>ii</span> <span class='kw'>in</span> <span class='no'>items_cr</span>){
    <span class='no'>ind</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span>( <span class='no'>dat</span>[,<span class='no'>ii</span>]<span class='kw'>==</span><span class='fl'>9</span> )
    <span class='no'>dat5</span>[<span class='no'>ind</span>,<span class='no'>ii</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>
                }

<span class='co'># estimate Rasch model</span>
<span class='no'>mod5</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat5</span>[,<span class='no'>items</span>], <span class='kw'>weights</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>studwgt</span>, <span class='kw'>group</span><span class='kw'>=</span><span class='no'>dat</span>$<span class='no'>country</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod5</span>)
  <span class='co'>##   Mean=0 0.411 -0.165 0.435</span>
  <span class='co'>##   SD=1.19 1.245 1.293 0.995</span>

<span class='co'>#*** For the following analyses, we ignore sample weights and the</span>
<span class='co'>#    country grouping.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.pirlsmissing</span>)
<span class='no'>items</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span>( <span class='st'>"R31"</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>data.pirlsmissing</span>), <span class='kw'>value</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.pirlsmissing</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='no'>dat1</span>[ <span class='no'>dat1</span><span class='kw'>==</span><span class='fl'>9</span> ] <span class='kw'>&lt;-</span> <span class='fl'>0</span>

<span class='co'>#*** Model 6: estimate item difficulties assuming incorrect missing data treatment</span>
<span class='no'>mod6</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat1</span>[,<span class='no'>items</span>], <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>50</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod6</span>)

<span class='co'>#*** Model 7: reestimate model with constrained item difficulties</span>
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>items</span>)
<span class='no'>constraints</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='fl'>1</span>:<span class='no'>I</span>, <span class='no'>mod6</span>$<span class='no'>item</span>$<span class='no'>b</span> )
<span class='no'>mod7</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat1</span>[,<span class='no'>items</span>], <span class='kw'>constraints</span><span class='kw'>=</span><span class='no'>constraints</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod7</span>)

<span class='co'>#*** Model 8: score all missings responses as missing items</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>[,<span class='no'>items</span>]
<span class='no'>dat2</span>[ <span class='no'>dat2</span><span class='kw'>==</span><span class='fl'>9</span> ] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>mod8</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat2</span>, <span class='kw'>constraints</span><span class='kw'>=</span><span class='no'>constraints</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='kw'>NULL</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod8</span>)

<span class='co'>#*** Model 9: estimate missing data model 'missing1' assuming a missingness</span>
<span class='co'>#       parameter delta.miss of zero</span>
<span class='no'>dat2</span> <span class='kw'>&lt;-</span>  <span class='no'>dat</span>[,<span class='no'>items</span>]    <span class='co'># note that missing item responses must be defined by 9</span>
<span class='no'>mod9</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat2</span>, <span class='kw'>constraints</span><span class='kw'>=</span><span class='no'>constraints</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"missing1"</span>,
            <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>), <span class='kw'>delta.miss</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>mitermax</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='kw'>NULL</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod9</span>)

<span class='co'>#*** Model 10: estimate missing data model with a large negative missing delta parameter</span>
<span class='co'>#=&gt; This model is equivalent to treating missing responses as wrong</span>
<span class='no'>mod10</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat2</span>, <span class='kw'>constraints</span><span class='kw'>=</span><span class='no'>constraints</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"missing1"</span>,
             <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>5</span>, <span class='fl'>5</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>), <span class='kw'>delta.miss</span><span class='kw'>=</span>-<span class='fl'>10</span>, <span class='kw'>mitermax</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>200</span>,
             <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='kw'>NULL</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod10</span>)

<span class='co'>#*** Model 11: choose a missingness delta parameter of -1</span>
<span class='no'>mod11</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat2</span>, <span class='kw'>constraints</span><span class='kw'>=</span><span class='no'>constraints</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"missing1"</span>,
             <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>5</span>, <span class='fl'>5</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>), <span class='kw'>delta.miss</span><span class='kw'>=</span>-<span class='fl'>1</span>, <span class='kw'>mitermax</span><span class='kw'>=</span><span class='fl'>4</span>,
             <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>200</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='kw'>NULL</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod11</span>)

<span class='co'>#*** Model 12: estimate joint delta parameter</span>
<span class='no'>mod12</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat2</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"missing1"</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fl'>0</span> ),
             <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>8</span>, <span class='fl'>8</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>), <span class='kw'>delta.miss</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>mitermax</span><span class='kw'>=</span><span class='fl'>4</span>,
             <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>est.delta</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>I</span>)  )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod12</span>)

<span class='co'>#*** Model 13: estimate delta parameter in item groups defined by item format</span>
<span class='no'>est.delta</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> + <span class='fl'>1</span> * ( <span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substring</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat2</span>),<span class='fl'>7</span>,<span class='fl'>7</span> )<span class='kw'>==</span><span class='st'>"M"</span> )
<span class='no'>mod13</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat2</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"missing1"</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fl'>0</span> ),
             <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>8</span>, <span class='fl'>8</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>), <span class='kw'>delta.miss</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>mitermax</span><span class='kw'>=</span><span class='fl'>4</span>,
             <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>est.delta</span><span class='kw'>=</span><span class='no'>est.delta</span>  )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod13</span>)

<span class='co'>#*** Model 14: estimate item specific delta parameter</span>
<span class='no'>mod14</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>dat2</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"missing1"</span>, <span class='kw'>mu.fixed</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fl'>0</span> ),
             <span class='kw'>theta.k</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>8</span>, <span class='fl'>8</span>, <span class='kw'>len</span><span class='kw'>=</span><span class='fl'>10</span>), <span class='kw'>delta.miss</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>mitermax</span><span class='kw'>=</span><span class='fl'>4</span>,
             <span class='kw'>mmliter</span><span class='kw'>=</span><span class='fl'>30</span>, <span class='kw'>est.delta</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='no'>I</span>  )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod14</span>)

<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 8: Comparison of different models for polytomous data</span>
<span class='co'>#############################################################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>data.Students</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"CDM"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>data.Students</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>data.Students</span>[, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"act"</span>,<span class='fl'>1</span>:<span class='fl'>5</span>) ]
<span class='no'>I</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>dat</span>)

<span class='co'>#**************************************************</span>
<span class='co'>#*** Model 1: Partial Credit Model (PCM)</span>

<span class='co'>#*** Model 1a: PCM in TAM</span>
<span class='no'>mod1a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.mml.html'>tam.mml</a></span>( <span class='no'>dat</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1a</span>)

<span class='co'>#*** Model 1b: PCM in sirt</span>
<span class='no'>mod1b</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'><a href='rm.facets.html'>rm.facets</a></span>( <span class='no'>dat</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod1b</span>)

<span class='co'>#*** Model 1c: PCM in mirt</span>
<span class='no'>mod1c</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.html'>mirt</a></span>( <span class='no'>dat</span>, <span class='fl'>1</span>, <span class='kw'>itemtype</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"Rasch"</span>,<span class='no'>I</span>), <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span> )
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>mod1c</span>)

<span class='co'>#**************************************************</span>
<span class='co'>#*** Model 2: Sequential Model (SM): Equal Loadings</span>

<span class='co'>#*** Model 2a: SM in sirt</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>CDM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/CDM/man/sequential.items.html'>sequential.items</a></span>(<span class='no'>dat</span>)
<span class='no'>resp</span> <span class='kw'>&lt;-</span> <span class='no'>dat1</span>$<span class='no'>dat.expand</span>
<span class='no'>iteminfo</span> <span class='kw'>&lt;-</span> <span class='no'>dat1</span>$<span class='no'>iteminfo</span>
<span class='co'># fit model</span>
<span class='no'>mod2a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>resp</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod2a</span>)

<span class='co'>#**************************************************</span>
<span class='co'>#*** Model 3: Sequential Model (SM): Different Loadings</span>

<span class='co'>#*** Model 3a: SM in sirt</span>
<span class='no'>mod3a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sirt</span><span class='kw ns'>::</span><span class='fu'>rasch.mml2</span>( <span class='no'>resp</span>, <span class='kw'>est.a</span><span class='kw'>=</span><span class='no'>iteminfo</span>$<span class='no'>itemindex</span> )
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod3a</span>)

<span class='co'>#**************************************************</span>
<span class='co'>#*** Model 4: Generalized partial credit model (GPCM)</span>

<span class='co'>#*** Model 4a: GPCM in TAM</span>
<span class='no'>mod4a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>TAM</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/TAM/man/tam.mml.html'>tam.mml.2pl</a></span>( <span class='no'>dat</span>, <span class='kw'>irtmodel</span><span class='kw'>=</span><span class='st'>"GPCM"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mod4a</span>)

<span class='co'>#**************************************************</span>
<span class='co'>#*** Model 5: Graded response model (GRM)</span>

<span class='co'>#*** Model 5a: GRM in mirt</span>
<span class='no'>mod5a</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mirt</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mirt/man/mirt.html'>mirt</a></span>( <span class='no'>dat</span>, <span class='fl'>1</span>, <span class='kw'>itemtype</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"graded"</span>,<span class='no'>I</span>), <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>mod5a</span>)

<span class='co'># model comparison</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod1a</span>);<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod1b</span>);<span class='no'>mod1c</span>@<span class='kw'>logLik</span>  <span class='co'># PCM</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod2a</span>)   <span class='co'># SM (Rasch)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod3a</span>)   <span class='co'># SM (GPCM)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/logLik.html'>logLik</a></span>(<span class='no'>mod4a</span>)   <span class='co'># GPCM</span>
<span class='no'>mod5a</span>@<span class='kw'>logLik</span>    <span class='co'># GRM</span>
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


