<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function computes several measures of absolute model fit and local
dependence indices for dichotomous item responses which are
based on comparing observed and expected frequencies of item pairs
(Chen, de la Torre &amp;amp; Zhang, 2013; see modelfit.cor
for more details)."><title>Assessing Model Fit and Local Dependence by Comparing Observed and Expected
Item Pair Correlations — modelfit.sirt • sirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assessing Model Fit and Local Dependence by Comparing Observed and Expected
Item Pair Correlations — modelfit.sirt"><meta property="og:description" content="This function computes several measures of absolute model fit and local
dependence indices for dichotomous item responses which are
based on comparing observed and expected frequencies of item pairs
(Chen, de la Torre &amp;amp; Zhang, 2013; see modelfit.cor
for more details)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.2</small

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexanderrobitzsch/sirt/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Assessing Model Fit and Local Dependence by Comparing Observed and Expected
Item Pair Correlations</h1>
      
      <div class="d-none name"><code>modelfit.sirt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes several measures of absolute model fit and local
dependence indices for dichotomous item responses which are
based on comparing observed and expected frequencies of item pairs
(Chen, de la Torre &amp; Zhang, 2013; see <code><a href="https://rdrr.io/pkg/CDM/man/modelfit.cor.html" class="external-link">modelfit.cor</a></code>
for more details).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modelfit.sirt</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">modelfit.cor.poly</span><span class="op">(</span> <span class="va">data</span>, <span class="va">probs</span>, <span class="va">theta.k</span>, <span class="va">f.qk.yi</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for sirt</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/CDM/man/IRT.modelfit.html" class="external-link">IRT.modelfit</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">mod</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An object generated by <code><a href="rasch.mml.html">rasch.mml2</a></code>,
<code><a href="rasch.mirtlc.html">rasch.mirtlc</a></code>, <code><a href="rasch.pml3.html">rasch.pml3</a></code> (<code><a href="sirt-defunct.html">rasch.pml2</a></code>),
<code><a href="smirt.html">smirt</a></code>, <code><a href="R2noharm.html">R2noharm</a></code>, <code><a href="noharm.sirt.html">noharm.sirt</a></code>,
<code><a href="gom.em.html">gom.em</a></code>, <code><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">TAM::tam.mml</a></code>,
<code><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">TAM::tam.mml.2pl</a></code>,
<code><a href="https://rdrr.io/pkg/TAM/man/tam.fa.html" class="external-link">TAM::tam.fa</a></code>,
  <code><a href="https://rdrr.io/pkg/mirt/man/mirt.html" class="external-link">mirt::mirt</a></code></p></dd>

<dt>data</dt>
<dd><p>Dataset with polytomous item responses</p></dd>

<dt>probs</dt>
<dd><p>Item response probabilities at grid <code>theta.k</code></p></dd>

<dt>theta.k</dt>
<dd><p>Grid of theta vector</p></dd>

<dt>f.qk.yi</dt>
<dd><p>Individual posterior</p></dd>

<dt>mod</dt>
<dd><p>Model name</p></dd>

<dt>...</dt>
<dd><p>Further arguments to be passed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with following entries:</p>
<dl><dt>modelfit</dt>
<dd><p>Model fit statistics:</p>
<p><code>MADcor</code>: mean of absolute deviations in observed and expected correlations
        (DiBello et al., 2007)</p>
<p><code>SRMSR</code>: standardized mean square root of squared residuals
        (Maydeu-Olivares, 2013; Maydeu-Olivares &amp; Joe, 2014)</p>
<p><code>MX2</code>: Mean of \(\chi^2\) statistics of all item pairs
            (Chen &amp; Thissen, 1997)</p>
<p><code>MADRESIDCOV</code>: Mean of absolute deviations of residual
            covariances (McDonald &amp; Mok, 1995)</p>
<p><code>MADQ3</code>: Mean of absolute values of \(Q_3\) statistic (Yen, 1984)</p>
<p><code>MADaQ3</code>: Mean of absolute values of centered \(Q_3\) statistic</p></dd>


  <dt>itempairs</dt>
<dd><p>Fit of every item pair</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Chen, W., &amp; Thissen, D. (1997). Local dependence indexes for item pairs
 using item response theory. <em>Journal of Educational and Behavioral Statistics,
 22</em>, 265-289.</p>
<p>DiBello, L. V., Roussos, L. A., &amp; Stout, W. F. (2007) Review of
  cognitively diagnostic assessment and a summary of psychometric models.
  In C. R. Rao and S. Sinharay (Eds.), <em>Handbook of Statistics</em>,
  Vol. 26 (pp. 979--1030). Amsterdam: Elsevier.</p>
<p>Maydeu-Olivares, A. (2013). Goodness-of-fit assessment of item response
theory models (with discussion).
<em>Measurement: Interdisciplinary Research and Perspectives,
11</em>, 71-137.</p>
<p>Maydeu-Olivares, A., &amp; Joe, H. (2014). Assessing approximate fit in categorical
data analysis. <em>Multivariate Behavioral Research, 49</em>, 305-328.</p>
<p>McDonald, R. P., &amp; Mok, M. M.-C. (1995). Goodness of fit in item response models.
  <em>Multivariate Behavioral Research, 30</em>, 23-40.</p>
<p>Yen, W. M. (1984). Effects of local item dependence on the fit and equating
performance of the three-parameter logistic model.
<em>Applied Psychological Measurement, 8</em>, 125-145.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The function <code>modelfit.cor.poly</code> is just a wrapper to
<code><a href="https://rdrr.io/pkg/TAM/man/tam.modelfit.html" class="external-link">TAM::tam.modelfit</a></code> in the <span class="pkg">TAM</span> package.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Supported classes: <code><a href="rasch.mml.html">rasch.mml2</a></code>,
<code><a href="rasch.mirtlc.html">rasch.mirtlc</a></code>, <code><a href="rasch.pml3.html">rasch.pml3</a></code> (<code><a href="sirt-defunct.html">rasch.pml2</a></code>),
<code><a href="smirt.html">smirt</a></code>, <code><a href="R2noharm.html">R2noharm</a></code>, <code><a href="noharm.sirt.html">noharm.sirt</a></code>,
<code><a href="gom.em.html">gom.em</a></code>,
<code><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">TAM::tam.mml</a></code>,
<code><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">TAM::tam.mml.2pl</a></code>,
<code><a href="https://rdrr.io/pkg/TAM/man/tam.fa.html" class="external-link">TAM::tam.fa</a></code>,
  <code><a href="https://rdrr.io/pkg/mirt/man/mirt.html" class="external-link">mirt::mirt</a></code></p>
<p>For more details on fit statistics of this function
see <code><a href="https://rdrr.io/pkg/CDM/man/modelfit.cor.html" class="external-link">CDM::modelfit.cor</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 1: Reading data</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.read</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.read</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 1: Rasch model</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">fmod1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod1</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 1b: Rasch model in TAM package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.edmeasurementsurveys.com/TAM/Tutorials/" class="external-link">TAM</a></span><span class="op">)</span></span>
<span><span class="va">mod1b</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">tam.mml</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">fmod1b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod1b</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod1b</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 2: Rasch model with smoothed distribution</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat</span>, distribution.trait<span class="op">=</span><span class="st">"smooth3"</span> <span class="op">)</span></span>
<span><span class="va">fmod2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod2</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod2</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 3: 2PL model</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mml.html">rasch.mml2</a></span><span class="op">(</span> <span class="va">dat</span>, distribution.trait<span class="op">=</span><span class="st">"normal"</span>, est.a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">I</span> <span class="op">)</span></span>
<span><span class="va">fmod3</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod3</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod3</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 3: 2PL model in TAM package</span></span>
<span><span class="va">mod3b</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.mml.html" class="external-link">tam.mml.2pl</a></span><span class="op">(</span> <span class="va">dat</span> <span class="op">)</span></span>
<span><span class="va">fmod3b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span><span class="va">mod3b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod3b</span><span class="op">)</span></span>
<span><span class="co"># model fit in TAM package</span></span>
<span><span class="va">tmod3b</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TAM/man/tam.modelfit.html" class="external-link">tam.modelfit</a></span><span class="op">(</span><span class="va">mod3b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tmod3b</span><span class="op">)</span></span>
<span><span class="co"># model fit in mirt package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/philchalmers/mirt" class="external-link">mirt</a></span><span class="op">)</span></span>
<span><span class="va">mmod3b</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="tam2mirt.html">tam2mirt</a></span><span class="op">(</span><span class="va">mod3b</span><span class="op">)</span>   <span class="co"># convert to mirt object</span></span>
<span><span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mirt/man/M2.html" class="external-link">M2</a></span><span class="op">(</span><span class="va">mmod3b</span><span class="op">$</span><span class="va">mirt</span><span class="op">)</span>         <span class="co"># global fit statistic</span></span>
<span><span class="fu">mirt</span><span class="fu">::</span><span class="fu">residuals</span><span class="op">(</span> <span class="va">mmod3b</span><span class="op">$</span><span class="va">mirt</span>, type<span class="op">=</span><span class="st">"LD"</span><span class="op">)</span>  <span class="co"># local dependence statistics</span></span>
<span></span>
<span><span class="co">#*** Model 4: 3PL model with equal guessing parameter</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">TAM</span><span class="fu">::</span><span class="fu">rasch.mml2</span><span class="op">(</span> <span class="va">dat</span>, distribution.trait<span class="op">=</span><span class="st">"smooth3"</span>, est.a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">I</span>, est.c<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">I</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">fmod4</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod4</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod4</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 5: Latent class model with 2 classes</span></span>
<span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mirtlc.html">rasch.mirtlc</a></span><span class="op">(</span> <span class="va">dat</span>, Nclasses<span class="op">=</span><span class="fl">2</span> <span class="op">)</span></span>
<span><span class="va">fmod5</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod5</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod5</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 6: Rasch latent class model with 3 classes</span></span>
<span><span class="va">mod6</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.mirtlc.html">rasch.mirtlc</a></span><span class="op">(</span> <span class="va">dat</span>, Nclasses<span class="op">=</span><span class="fl">3</span>, modeltype<span class="op">=</span><span class="st">"MLC1"</span>, mmliter<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">fmod6</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod6</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod6</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 7: PML estimation</span></span>
<span><span class="va">mod7</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.pml3.html">rasch.pml3</a></span><span class="op">(</span> <span class="va">dat</span> <span class="op">)</span></span>
<span><span class="va">fmod7</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod7</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod7</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 8: PML estimation</span></span>
<span><span class="co">#      Modelling error correlations:</span></span>
<span><span class="co">#          joint residual correlations for each item cluster</span></span>
<span><span class="va">error.corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">itemcluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,each<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">ind.ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span> <span class="va">itemcluster</span><span class="op">==</span><span class="va">ii</span> <span class="op">)</span></span>
<span>    <span class="va">error.corr</span><span class="op">[</span> <span class="va">ind.ii</span>, <span class="va">ind.ii</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ii</span></span>
<span>        <span class="op">}</span></span>
<span><span class="va">mod8</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="rasch.pml3.html">rasch.pml3</a></span><span class="op">(</span> <span class="va">dat</span>, error.corr<span class="op">=</span><span class="va">error.corr</span> <span class="op">)</span></span>
<span><span class="va">fmod8</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod8</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod8</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 9: 1PL in smirt</span></span>
<span><span class="va">Qmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">1</span>, nrow<span class="op">=</span><span class="va">I</span>, ncol<span class="op">=</span><span class="fl">1</span> <span class="op">)</span></span>
<span><span class="va">mod9</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="smirt.html">smirt</a></span><span class="op">(</span> <span class="va">dat</span>, Qmatrix<span class="op">=</span><span class="va">Qmatrix</span> <span class="op">)</span></span>
<span><span class="va">fmod9</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod9</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod9</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 10: 3-dimensional Rasch model in NOHARM</span></span>
<span><span class="va">noharm.path</span> <span class="op">&lt;-</span> <span class="st">"c:/NOHARM"</span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">12</span>, ncol<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span><span class="va">Q</span><span class="op">[</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,each<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">)</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span><span class="op">)</span></span>
<span><span class="co"># covariance matrix</span></span>
<span><span class="va">P.pattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">3</span>, nrow<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span><span class="va">P.init</span> <span class="op">&lt;-</span> <span class="fl">0.8</span><span class="op">+</span><span class="fl">0</span><span class="op">*</span><span class="va">P.pattern</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">P.init</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># loading matrix</span></span>
<span><span class="va">F.pattern</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">*</span><span class="va">Q</span></span>
<span><span class="va">F.init</span> <span class="op">&lt;-</span> <span class="va">Q</span></span>
<span><span class="co"># estimate model</span></span>
<span><span class="va">mod10</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="R2noharm.html">R2noharm</a></span><span class="op">(</span> dat<span class="op">=</span><span class="va">dat</span>, model.type<span class="op">=</span><span class="st">"CFA"</span>, F.pattern<span class="op">=</span><span class="va">F.pattern</span>,</span>
<span>            F.init<span class="op">=</span><span class="va">F.init</span>, P.pattern<span class="op">=</span><span class="va">P.pattern</span>, P.init<span class="op">=</span><span class="va">P.init</span>,</span>
<span>            writename<span class="op">=</span><span class="st">"ex4e"</span>, noharm.path<span class="op">=</span><span class="va">noharm.path</span>, dec<span class="op">=</span><span class="st">","</span> <span class="op">)</span></span>
<span><span class="va">fmod10</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod10</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod10</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#*** Model 11: Rasch model in mirt package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/philchalmers/mirt" class="external-link">mirt</a></span><span class="op">)</span></span>
<span><span class="va">mod11</span> <span class="op">&lt;-</span> <span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mirt/man/mirt.html" class="external-link">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="st">"Rasch"</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">fmod11</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu">modelfit.sirt</span><span class="op">(</span> <span class="va">mod11</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod11</span><span class="op">)</span></span>
<span><span class="co"># model fit in mirt package</span></span>
<span><span class="fu">mirt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mirt/man/M2.html" class="external-link">M2</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span></span>
<span><span class="fu">mirt</span><span class="fu">::</span><span class="fu">residuals</span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

